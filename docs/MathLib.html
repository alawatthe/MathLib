<!DOCTYPE html>  <html> <head>   <title>MathLib.ts</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               MathLib.ts             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>MathLib.js is a JavaScript library for mathematical computations.</p>

<h2>Version</h2>

<p>v0.3.5 - 2013-04-03 <br />
MathLib is currently in public beta testing.</p>

<h2>License</h2>

<p>Copyright (c) 2013 Alexander Zeilmann <br />
MathLib.js is <a href="http://MathLib.de/en/license">licensed under the MIT license</a></p>

<h2>Documentation</h2>

<p>The source code is annotated using <a href="https://github.com/jashkenas/docco" title="View Docco on GitHub">Docco</a>
(with a modified css-file).
The syntax is more or less the JSDoc syntax.
A more detailed documentation will be coming soon.</p>

<h2>Code structure</h2>

<p>The code is separated into several modules.
The first module contains some internal functions</p>

<p>Next is the <a href="#MathML" title="Jump to the MathML implementation">MathML</a> module 
and the <a href="#Functions" title="Jump to the function implementation">functions</a> module.</p>

<p>Then drawing modules:</p>

<ul>
<li><a href="#Screen" title="Jump to the screen implementation">screen</a></li>
<li><a href="#Screen2D" title="Jump to the implementation for 2D plotting">screen2D</a></li>
<li><a href="#Screen3D" title="Jump to the implementation for 3D plotting">screen3D</a></li>
</ul>

<p>The next module is the <a href="#Vector" title="Jump to the vector implementation">vector</a> module, because the Point and the Line module depend on it.</p>

<p>And at last the other modules in alphabetic order:</p>

<ul>
<li><a href="#Circle" title="Jump to the circle implementation">circle</a></li>
<li><a href="#Complex" title="Jump to the complex number implementation">complex</a></li>
<li><a href="#Line" title="Jump to the line implementation">line</a></li>
<li><a href="#Matrix" title="Jump to the matrix implementation">matrix</a></li>
<li><a href="#Permutation" title="Jump to the permutation implementation">permutation</a></li>
<li><a href="#Point" title="Jump to the point implementation">point</a></li>
<li><a href="#Polynomial" title="Jump to the polynomial implementation">polynomial</a></li>
<li><a href="#Rational" title="Jump to the rational number implementation">rational</a></li>
<li><a href="#Set" title="Jump to the set implementation">set</a>
The MathLib module which wraps everything</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">module</span> <span class="nx">MathLib</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Typescript is throwing the following error otherwise:
The property 'methodname' does not exist on value of type 'MathLib'
see http://typescript.codeplex.com/discussions/397908</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">declare</span> <span class="kd">var</span> <span class="nx">MathLib</span> <span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">declare</span> <span class="kd">var</span> <span class="nx">MathJax</span> <span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">declare</span> <span class="kd">var</span> <span class="nx">THREE</span> <span class="o">:</span> <span class="nx">any</span><span class="p">;</span>



  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="s1">&#39;0.3.5&#39;</span><span class="p">;</span>
  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">apery</span> <span class="o">=</span> <span class="mf">1.2020569031595942</span><span class="p">;</span>
  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">e</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">E</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Number.EPSILON is probably coming in ES6
(see section 15.7.3.7 in the current draft)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">epsilon</span> <span class="o">=</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">Number</span><span class="p">).</span><span class="nx">EPSILON</span> <span class="o">||</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">next</span><span class="p">,</span> <span class="nx">result</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">next</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">next</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">next</span> <span class="o">=</span> <span class="nx">next</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span> <span class="o">=</span> <span class="nx">next</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}());</span>
  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">eulerMascheroni</span> <span class="o">=</span> <span class="mf">0.5772156649015329</span><span class="p">;</span>
  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">goldenRatio</span> <span class="o">=</span> <span class="mf">1.618033988749895</span><span class="p">;</span>
  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">pi</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span>
  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isArrayLike</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;length&#39;</span> <span class="k">in</span> <span class="nx">x</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="kd">var</span> <span class="nx">prototypes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">array</span><span class="o">:</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">([]),</span>
        <span class="nx">func</span><span class="o">:</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="kd">function</span> <span class="p">(){}),</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">({}),</span>
        <span class="nx">functn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){}</span>
      <span class="p">},</span>
      <span class="nx">flatten</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">a</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">res</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">flatten</span><span class="p">(</span><span class="nx">x</span><span class="p">));</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="nx">extendObject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dest</span><span class="p">,</span> <span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">dest</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">src</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">dest</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">extendObject</span><span class="p">(</span><span class="nx">dest</span><span class="p">[</span><span class="nx">prop</span><span class="p">],</span> <span class="nx">src</span><span class="p">[</span><span class="nx">prop</span><span class="p">]);</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="nx">dest</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">src</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">dest</span><span class="p">;</span>
      <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>A little function converting arrays to THREE.js vectors</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">to3js</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector2</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
        <span class="p">}</span>
      <span class="p">},</span>

      <span class="nx">colorConvert</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">n</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">n</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">n</span><span class="p">),</span> <span class="mh">0xffffff</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
          <span class="k">return</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;00000&#39;</span><span class="o">+</span><span class="nx">n</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">);</span> 
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">n</span><span class="p">;</span>
      <span class="p">};</span>




  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">prototypes</span> <span class="o">=</span> <span class="nx">prototypes</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h3>MathLib.extend</h3>

<p>Extends a MathLib object with custom properties or methods</p>

<p><em>@param {string}</em> obj The name of the object be extended <br />
<em>@param {string}</em> name The name of the new property of function <br />
<em>@param {function|...}</em> prop The new function or property <br />
<em>@param {object}</em> [options] <br />
TODO: allow get &amp; set</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{</span><span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">};</span>
    <span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">[</span><span class="nx">obj</span><span class="p">]</span> <span class="o">||</span> <span class="nx">MathLib</span><span class="p">;</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="nx">prop</span><span class="p">,</span>
      <span class="nx">writable</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">writable</span><span class="p">,</span>
      <span class="nx">enumerable</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">enumerable</span><span class="p">,</span>
      <span class="nx">configurable</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">configurable</span>
    <span class="p">});</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <h3>MathLib.extendPrototype</h3>

<p>Extends the prototype of a MathLib object with custom properties or methods</p>

<p><em>@param {string}</em> obj The name of the object be extended <br />
<em>@param {string}</em> name The name of the new property of function <br />
<em>@param {function|...}</em> prop The new function or property <br />
<em>@param {object}</em> [options] <br />
TODO: allow get &amp; set</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">MathLib</span><span class="p">.</span><span class="nx">extendPrototype</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{</span><span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">};</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">prototypes</span><span class="p">[</span><span class="nx">obj</span><span class="p">],</span> <span class="nx">name</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="nx">prop</span><span class="p">,</span>
      <span class="nx">writable</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">writable</span><span class="p">,</span>
      <span class="nx">enumerable</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">enumerable</span><span class="p">,</span>
      <span class="nx">configurable</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">configurable</span>
    <span class="p">});</span>

  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <h2><a id="MathML"></a>MathML</h2>

<p>The MathML implementation of MathLib parses and creates content MathML.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">MathML</span> <span class="p">{</span>

  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;MathML&#39;</span><span class="p">;</span>

  <span class="nx">attributes</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">childNodes</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">innerMathML</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">outerMathML</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">nodeName</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">nextNode</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">parentNode</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">prevNode</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">MathMLString</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">tokenizer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DOMParser</span><span class="p">(),</span>
      <span class="nx">MathMLdoc</span><span class="p">,</span>
      <span class="nx">token</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">MathMLString</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">MathMLString</span> <span class="o">=</span> <span class="nx">MathMLString</span><span class="p">.</span><span class="nx">toContentMathML</span><span class="p">();</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Remove the Linebreaks ...</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">MathMLString</span> <span class="o">=</span> <span class="nx">MathMLString</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>... and the unnecessary whitespace</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">MathMLString</span> <span class="o">=</span> <span class="nx">MathMLString</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/((?!cs)[^&gt;]{2})&gt;(\s)*&lt;/g</span><span class="p">,</span> <span class="s1">&#39;$1&gt;&lt;&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Replace &InvisibleTimes; etc. before parsing</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">MathMLString</span> <span class="o">=</span> <span class="nx">MathMLString</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;(\w*);/g</span><span class="p">,</span> <span class="s1">&#39;#$1;&#39;</span><span class="p">);</span>
      </pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Gives an error in Firefox
* MathML = tokenizer.parseFromString(MathMLString, 'application/mathml+xml'); *</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">MathMLdoc</span> <span class="o">=</span> <span class="nx">tokenizer</span><span class="p">.</span><span class="nx">parseFromString</span><span class="p">(</span><span class="nx">MathMLString</span><span class="p">,</span> <span class="s1">&#39;application/xml&#39;</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">createToken</span><span class="p">,</span>
        <span class="nx">curToken</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">tokenStack</span> <span class="o">=</span> <span class="p">[];</span>


    <span class="nx">createToken</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">attributes</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">attributes</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">attributes</span><span class="p">[</span><span class="nx">t</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span>  <span class="nx">t</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      </pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>var newToken = Object.create(tokenPrototype, {</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">newToken</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">({},</span> <span class="p">{</span>
        <span class="nx">attributes</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="nx">attributes</span><span class="p">},</span>
        <span class="nx">nodeName</span><span class="o">:</span>   <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="nx">t</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">},</span>
        <span class="nx">parentNode</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="nx">tokenStack</span><span class="p">[</span><span class="nx">tokenStack</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]},</span>
        <span class="nx">prevNode</span><span class="o">:</span>   <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="nx">curToken</span><span class="p">}</span>
      <span class="p">});</span>


      <span class="k">if</span><span class="p">(</span><span class="nx">curToken</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">curToken</span><span class="p">.</span><span class="nx">nextNode</span> <span class="o">=</span> <span class="nx">newToken</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">curToken</span> <span class="o">=</span> <span class="nx">newToken</span><span class="p">;</span>

      <span class="nx">tokenStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">newToken</span><span class="p">);</span>
      <span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">createToken</span><span class="p">);</span>
      <span class="nx">tokenStack</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>

      <span class="kd">var</span> <span class="nx">attributesString</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">attr</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">attr</span> <span class="k">in</span> <span class="nx">x</span><span class="p">.</span><span class="nx">attributes</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">attr</span><span class="p">)){</span>
            <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">attr</span> <span class="o">+</span> <span class="s1">&#39;=&quot;&#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">attr</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
      <span class="p">};</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">newToken</span><span class="p">.</span><span class="nx">innerMathML</span> <span class="o">=</span> <span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">cur</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">array</span><span class="p">){</span><span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">outerMathML</span><span class="p">;},</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">newToken</span><span class="p">.</span><span class="nx">innerMathML</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">newToken</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;#text&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Restore &InvisibleTimes; etc.</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">newToken</span><span class="p">.</span><span class="nx">outerMathML</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">textContent</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/#(\w*);/g</span><span class="p">,</span> <span class="s1">&#39;&amp;$1;&#39;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nx">newToken</span><span class="p">.</span><span class="nx">outerMathML</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">newToken</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">+</span> <span class="nx">attributesString</span><span class="p">(</span><span class="nx">newToken</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">newToken</span><span class="p">.</span><span class="nx">outerMathML</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">newToken</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">+</span> <span class="nx">attributesString</span><span class="p">(</span><span class="nx">newToken</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span> <span class="o">+</span> <span class="nx">newToken</span><span class="p">.</span><span class="nx">innerMathML</span> <span class="o">+</span> <span class="s1">&#39;&lt;/&#39;</span> <span class="o">+</span> <span class="nx">newToken</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">newToken</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;lambda&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">newToken</span><span class="p">.</span><span class="nx">bvars</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;bvar&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">newToken</span><span class="p">.</span><span class="nx">bvars</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerMathML</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;domainofapplication&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">newToken</span><span class="p">.</span><span class="nx">domainofapplication</span> <span class="o">=</span> <span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;apply&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">newToken</span><span class="p">.</span><span class="nx">apply</span> <span class="o">=</span> <span class="nx">newToken</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">newToken</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="nx">token</span> <span class="o">=</span> <span class="nx">createToken</span><span class="p">(</span><span class="nx">MathMLdoc</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>



    <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">attributes</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">childNodes</span> <span class="o">=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">innerMathML</span> <span class="o">=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outerMathML</span> <span class="o">=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">outerMathML</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">nextNode</span> <span class="o">=</span> <span class="nx">token</span><span class="p">.</span><span class="nx">nextNode</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">prevNode</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
   
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h3>MathML.isSupported()</h3>

<p>Checks if MathML is supported by the browser. <br />
Code stolen from <a href="http://www.modernizr.com/">Modernizr</a></p>

<p><em>@return {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">isSupported</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">hasMathML</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nx">ns</span><span class="p">,</span> <span class="nx">div</span><span class="p">,</span> <span class="nx">mfrac</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">ns</span> <span class="o">=</span> <span class="s1">&#39;http://www.w3.org/1998/Math/MathML&#39;</span><span class="p">;</span>
    <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
    <span class="nx">div</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="s1">&#39;absolute&#39;</span><span class="p">;</span>
    <span class="nx">mfrac</span> <span class="o">=</span> <span class="nx">div</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="nx">ns</span><span class="p">,</span><span class="s1">&#39;math&#39;</span><span class="p">))</span>
                <span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="nx">ns</span><span class="p">,</span><span class="s1">&#39;mfrac&#39;</span><span class="p">));</span>
    <span class="nx">mfrac</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="nx">ns</span><span class="p">,</span><span class="s1">&#39;mi&#39;</span><span class="p">))</span>
         <span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">));</span>
    <span class="nx">mfrac</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="nx">ns</span><span class="p">,</span><span class="s1">&#39;mi&#39;</span><span class="p">))</span>
         <span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="s1">&#39;yy&#39;</span><span class="p">));</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
    <span class="nx">hasMathML</span> <span class="o">=</span> <span class="nx">div</span><span class="p">.</span><span class="nx">offsetHeight</span> <span class="o">&gt;</span> <span class="nx">div</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">hasMathML</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <h3>MathML.loadMathJax()</h3>

<p>Loads MathJax dynamically.</p>

<p><em>@param{string}</em> [config] Optional config options</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">loadMathJax</span><span class="p">(</span><span class="nx">config</span> <span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">HTMLScriptElement</span><span class="o">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
  <span class="nx">script</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span>
  <span class="nx">script</span><span class="p">.</span><span class="nx">src</span>  <span class="o">=</span> <span class="s1">&#39;http://cdn.mathjax.org/mathjax/latest/MathJax.js&#39;</span><span class="p">;</span>

  <span class="nx">config</span> <span class="o">=</span> <span class="nx">config</span> <span class="o">||</span>  <span class="s1">&#39;MathJax.Hub.Config({&#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;config: [&quot;MMLorHTML.js&quot;],&#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;jax: [&quot;input/TeX&quot;,&quot;input/MathML&quot;,&quot;output/HTML-CSS&quot;,&quot;output/NativeMML&quot;],&#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;extensions: [&quot;tex2jax.js&quot;,&quot;mml2jax.js&quot;,&quot;MathMenu.js&quot;,&quot;MathZoom.js&quot;],&#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;TeX: {&#39;</span> <span class="o">+</span>
                          <span class="s1">&#39;extensions: [&quot;AMSmath.js&quot;,&quot;AMSsymbols.js&quot;,&quot;noErrors.js&quot;,&quot;noUndefined.js&quot;]&#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;}&#39;</span> <span class="o">+</span>
                      <span class="s1">&#39;});&#39;</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">window</span><span class="p">).</span><span class="nx">opera</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">script</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">config</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">script</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">config</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <h3>MathML.prototype.parse()</h3>

<p>Parses the MathML.</p>

<p><em>@return{number|a MathLib object}</em>  The result of the parsing</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">parse</span><span class="p">()</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">handlers</span><span class="p">,</span> <span class="nx">apply</span><span class="p">,</span> <span class="nx">ci</span><span class="p">,</span> <span class="nx">cn</span><span class="p">,</span> <span class="nx">math</span><span class="p">,</span> <span class="nx">matrixrow</span><span class="p">,</span> <span class="nx">matrix</span><span class="p">,</span> <span class="nx">parser</span><span class="p">,</span> <span class="nx">set</span><span class="p">,</span> <span class="nx">vector</span><span class="p">,</span>
      <span class="nx">construct</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nx">bvars</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="nx">handlers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">apply</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">children</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">,</span>
          <span class="nx">func</span> <span class="o">=</span> <span class="nx">children</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span>
          <span class="nx">funcName</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">,</span>
          <span class="nx">names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">ident</span><span class="o">:</span> <span class="s1">&#39;identity&#39;</span><span class="p">,</span>
            <span class="nx">power</span><span class="o">:</span> <span class="s1">&#39;pow&#39;</span><span class="p">,</span>
            <span class="nx">rem</span><span class="o">:</span> <span class="s1">&#39;mod&#39;</span><span class="p">,</span>
            <span class="nx">setdifference</span><span class="o">:</span> <span class="s1">&#39;without&#39;</span> 
          <span class="p">};</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">funcName</span> <span class="k">in</span> <span class="nx">names</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">funcName</span> <span class="o">=</span> <span class="nx">names</span><span class="p">[</span><span class="nx">funcName</span><span class="p">];</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">construct</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">innerFunc</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>func = node.childNodes[2];
funcName = func.childNodes[0].nodeName;</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">innerFunc</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">(</span><span class="nx">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

        
        <span class="k">if</span> <span class="p">(</span><span class="nx">innerFunc</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">MathLib</span><span class="p">[</span><span class="nx">funcName</span><span class="p">](</span><span class="nx">x</span><span class="p">);},</span> <span class="p">{</span>
            <span class="nx">contentMathMLString</span><span class="o">:</span> <span class="s1">&#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;reals/&gt;&lt;/domainofapplication&gt;&#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">outerMathML</span> <span class="o">+</span> <span class="s1">&#39;&lt;/lambda&gt;&lt;/math&gt;&#39;</span>
          <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">MathLib</span><span class="p">[</span><span class="nx">funcName</span><span class="p">](</span><span class="nx">innerFunc</span><span class="p">(</span><span class="nx">x</span><span class="p">));},</span> <span class="p">{</span>
            <span class="nx">contentMathMLString</span><span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">outerMathML</span>
          <span class="p">});</span>
        <span class="p">}</span>
        
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">funcName</span> <span class="k">in</span> <span class="nx">MathLib</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">MathLib</span><span class="p">[</span><span class="nx">funcName</span><span class="p">](</span><span class="nx">parser</span><span class="p">(</span><span class="nx">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">MathLib</span><span class="p">[</span><span class="nx">funcName</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">children</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">parser</span><span class="p">));</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">(</span><span class="nx">children</span><span class="p">.</span><span class="nx">shift</span><span class="p">());</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">child</span><span class="p">[</span><span class="nx">funcName</span><span class="p">](</span><span class="nx">parser</span><span class="p">(</span><span class="nx">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">child</span><span class="p">[</span><span class="nx">funcName</span><span class="p">](</span><span class="nx">children</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">parser</span><span class="p">));</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">ci</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">bvars</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">MathML</span><span class="p">.</span><span class="nx">variables</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">x</span><span class="p">;},</span> <span class="p">{</span><span class="nx">contentMathMLString</span><span class="o">:</span> <span class="s1">&#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;reals/&gt;&lt;/domainofapplication&gt;&lt;apply&gt;&lt;ident/&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/apply&gt;&lt;/lambda&gt;&lt;/math&gt;&#39;</span><span class="p">});</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">cn</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">type</span> <span class="o">?</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">type</span> <span class="o">:</span> <span class="s1">&#39;number&#39;</span><span class="p">;</span>

      <span class="k">if</span><span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/* TODO: base conversions</span>
<span class="cm">        var base = node.getAttribute(&#39;base&#39;) !== null ? node.getAttributes(&#39;base&#39;) : &#39;10&#39;; */</span>
        <span class="k">return</span> <span class="o">+</span><span class="nx">node</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;complex-cartesian&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="o">+</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">outerMathML</span><span class="p">,</span> <span class="o">+</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">outerMathML</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;complex-polar&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">.</span><span class="nx">polar</span><span class="p">(</span><span class="o">+</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">outerMathML</span><span class="p">,</span> <span class="o">+</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">outerMathML</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">cs</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">lambda</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">domain</span><span class="p">,</span> <span class="nx">lambda</span><span class="p">,</span> <span class="nx">funcName</span><span class="p">,</span> <span class="nx">innerFunc</span><span class="p">,</span> <span class="nx">names</span><span class="p">;</span>

      <span class="nx">bvars</span> <span class="o">=</span> <span class="nx">bvars</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">bvars</span><span class="p">);</span>
      <span class="nx">domain</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">domainofapplication</span><span class="p">;</span>
      <span class="nx">apply</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">apply</span><span class="p">;</span>
      <span class="nx">funcName</span> <span class="o">=</span> <span class="nx">apply</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">;</span>
      <span class="nx">construct</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

      <span class="nx">names</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">ident</span><span class="o">:</span> <span class="s1">&#39;identity&#39;</span><span class="p">,</span>
        <span class="nx">power</span><span class="o">:</span> <span class="s1">&#39;pow&#39;</span><span class="p">,</span>
        <span class="nx">rem</span><span class="o">:</span> <span class="s1">&#39;mod&#39;</span><span class="p">,</span>
        <span class="nx">setdifference</span><span class="o">:</span> <span class="s1">&#39;without&#39;</span> 
      <span class="p">};</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">funcName</span> <span class="k">in</span> <span class="nx">names</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">funcName</span> <span class="o">=</span> <span class="nx">names</span><span class="p">[</span><span class="nx">funcName</span><span class="p">];</span>
      <span class="p">}</span>
     
      <span class="nx">innerFunc</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">(</span><span class="nx">apply</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">innerFunc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">MathLib</span><span class="p">[</span><span class="nx">funcName</span><span class="p">](</span><span class="nx">x</span><span class="p">);},</span> <span class="p">{</span>
          <span class="nx">contentMathMLString</span><span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">outerMathML</span><span class="p">,</span>
          <span class="nx">domain</span><span class="o">:</span> <span class="nx">domain</span>
        <span class="p">});</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">MathLib</span><span class="p">[</span><span class="nx">funcName</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">innerFunc</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">f</span><span class="p">){</span>
          <span class="k">return</span> <span class="k">typeof</span> <span class="nx">f</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">?</span> <span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">:</span> <span class="nx">f</span><span class="p">;</span>
        <span class="p">}));},</span> <span class="p">{</span>
          <span class="nx">contentMathMLString</span><span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">outerMathML</span><span class="p">,</span>
          <span class="nx">domain</span><span class="o">:</span> <span class="nx">domain</span>
        <span class="p">});</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">math</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">parser</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">},</span>

    <span class="nx">matrix</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">matrixrow</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="nx">matrixrow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">parser</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">type</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;multiset&#39;</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">parser</span><span class="p">),</span> <span class="nx">type</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="s1">&#39;false&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="s1">&#39;true&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">exponentiale</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">e</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">imaginaryi</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">notanumber</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">NaN</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">pi</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">pi</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">eulergamma</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">eulerMascheroni</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">infinity</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">Infinity</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">vector</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Vector</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">parser</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">};</span>


  <span class="nx">parser</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">node</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">parser</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">handlers</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">](</span><span class="nx">node</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="nx">parser</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <h3>MathML.prototype.toMathMLString()</h3>

<p>Converts the content MathMl to a presentation MathML string</p>

<p><em>@return{string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">handlers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">apply</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
          <span class="nx">args</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">handlers</span><span class="p">[</span><span class="nx">x</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">](</span><span class="nx">x</span><span class="p">);</span>
          <span class="p">}),</span>
          <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;plus&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;mrow&gt;&#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&lt;mo&gt;+&lt;/mo&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mrow&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;times&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;mrow&gt;&#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&lt;mo&gt;*&lt;/mo&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mrow&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;power&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;msup&gt;&#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&lt;/msup&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;mrow&gt;&lt;mi&gt;&#39;</span> <span class="o">+</span> <span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mi&gt;&lt;mo&gt;&amp;af;&lt;/mo&gt;&lt;mfenced&gt;&#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mfenced&gt;&lt;/mrow&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">bvar</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;},</span>
    <span class="nx">ci</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;&lt;mi&gt;&#39;</span> <span class="o">+</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mi&gt;&#39;</span><span class="p">;},</span>
    <span class="nx">cn</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;&lt;mn&gt;&#39;</span> <span class="o">+</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mn&gt;&#39;</span><span class="p">;},</span>
    <span class="nx">cs</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;&lt;ms&gt;&#39;</span> <span class="o">+</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span> <span class="o">+</span> <span class="s1">&#39;&lt;/ms&gt;&#39;</span><span class="p">;},</span>
    <span class="nx">domainofapplication</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;},</span>
    <span class="nx">lambda</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="nx">handlers</span><span class="p">[</span><span class="nx">cur</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">](</span><span class="nx">cur</span><span class="p">);</span>
      <span class="p">},</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="p">},</span> 
    <span class="s1">&#39;#text&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;}</span>
  <span class="p">};</span>

  <span class="k">return</span><span class="s1">&#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">handlers</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">](</span><span class="k">this</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&lt;/math&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <h3>MathML.prototype.toString()</h3>

<p>Custom toString method</p>

<p><em>@return{string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">outerMathML</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <h3>MathML.variables</h3>

<p>Object for variable storage.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">variables</span> <span class="o">=</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <h3>MathML.write()</h3>

<p>Writes MathML to an element.</p>

<p><em>@param{string}</em> The id of the element in which the MathML should be inserted. <br />
<em>@param{string}</em> The MathML to be inserted.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">write</span><span class="p">(</span><span class="nx">id</span> <span class="o">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">math</span> <span class="o">:</span> <span class="nx">string</span><span class="p">)</span> <span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">formula</span><span class="p">;</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;&lt;math&gt;&#39;</span> <span class="o">+</span> <span class="nx">math</span> <span class="o">+</span> <span class="s1">&#39;&lt;/math&gt;&#39;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">MathJax</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">formula</span> <span class="o">=</span> <span class="nx">MathJax</span><span class="p">.</span><span class="nx">Hub</span><span class="p">.</span><span class="nx">getAllJax</span><span class="p">(</span><span class="nx">id</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nx">MathJax</span><span class="p">.</span><span class="nx">Hub</span><span class="p">.</span><span class="nx">Queue</span><span class="p">([</span><span class="s1">&#39;Typeset&#39;</span><span class="p">,</span> <span class="nx">MathJax</span><span class="p">.</span><span class="nx">Hub</span><span class="p">,</span> <span class="nx">id</span><span class="p">]);</span>
  <span class="p">}</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <h2><a id="Functions"></a>Functions</h2>

<p>Because 'Function' is a reserved word in JavaScript the module is called 
'Functn'. <br />
More improvements to the module coming soon.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">functnPrototype</span><span class="o">:</span><span class="nx">any</span> <span class="o">=</span> <span class="p">{};</span>

<span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>

  <span class="kd">var</span> <span class="nx">functn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;functn&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">outerVar</span> <span class="o">=</span> <span class="nx">functn</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">outerMathML</span><span class="p">,</span>
          <span class="nx">innerVar</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">outerMathML</span><span class="p">,</span>
          <span class="nx">innerStr</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">outerMathML</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;&lt;bvar&gt;&#39;</span> <span class="o">+</span> <span class="nx">innerVar</span> <span class="o">+</span> <span class="s1">&#39;&lt;/bvar&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> 
          <span class="nx">outerStr</span> <span class="o">=</span> <span class="nx">functn</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">outerMathML</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">outerVar</span><span class="p">,</span> <span class="nx">innerStr</span><span class="p">),</span>
          <span class="nx">res</span> <span class="o">=</span> <span class="s1">&#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;lambda&gt;&lt;bvar&gt;&#39;</span> <span class="o">+</span> <span class="nx">innerVar</span> <span class="o">+</span> <span class="s1">&#39;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;reals/&gt;&lt;/domainofapplication&gt;&#39;</span> <span class="o">+</span> <span class="nx">outerStr</span> <span class="o">+</span> <span class="s1">&#39;&lt;/lambda&gt;&lt;/math&gt;&#39;</span><span class="p">;</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="p">(</span><span class="nx">y</span><span class="p">));},</span> <span class="p">{</span><span class="nx">contentMathMLString</span><span class="o">:</span> <span class="nx">res</span><span class="p">});</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="p">(</span><span class="nx">y</span><span class="p">));};</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span><span class="p">[</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span><span class="p">[</span><span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">]();</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>functn[proto] = prototypes.functn;</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">name</span> <span class="k">in</span> <span class="nx">functnPrototype</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">functnPrototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">functn</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">functnPrototype</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">functn</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;functn&#39;</span><span class="p">;</span>
  <span class="nx">functn</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">;</span>


  <span class="kd">var</span> <span class="nx">contentMathML</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">contentMathMLString</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
  
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperties</span><span class="p">(</span><span class="nx">functn</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">name</span><span class="p">},</span>
    <span class="nx">contentMathML</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">MathML</span><span class="p">(</span><span class="nx">contentMathML</span><span class="p">)</span> <span class="p">}</span>
  <span class="p">});</span>

  <span class="k">return</span> <span class="nx">functn</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Functn/draw">Functn.prototype.draw()</a></h3>

<p>Draws the function on the screen</p>

<p><em>@param {screen}</em> The screen to draw the function onto. <br />
<em>@param {object}</em> [options] Optional drawing options. <br />
<em>@returns {functn}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">functnPrototype</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">screen</span><span class="p">,</span> <span class="nx">options</span><span class="o">:</span><span class="nx">any</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">functn</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">screen</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">screen</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="nx">functn</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">screen</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="nx">functn</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Functn/diff">Functn.prototype.diff()</a></h3>

<p>Numeric derivative at a given point</p>

<p><em>@param {number}</em> The point <br />
<em>@param {number}</em> Optional step size <br />
<em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">functnPrototype</span><span class="p">.</span><span class="nx">diff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">(</span><span class="nx">x</span><span class="o">+</span><span class="nx">h</span><span class="p">)</span> <span class="o">-</span> <span class="k">this</span><span class="p">(</span><span class="nx">x</span><span class="o">-</span><span class="nx">h</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nx">h</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Functn/quad">Functn.prototype.quad()</a></h3>

<p>Numeric evaluation of an integral using an adative simpson approach.</p>

<p>Inspired by "adaptsim.m" by Walter Gander
and MatLab's "quad.m"</p>

<p><em>@param {number}</em> The starting point <br />
<em>@param {number}</em> The end point <br />
<em>@param {number}</em> The tolerance <br />
<em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">functnPrototype</span><span class="p">.</span><span class="nx">quad</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">options</span><span class="o">:</span><span class="nx">any</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  
  <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
      <span class="nx">warnMessage</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Calculation succeded&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Minimum step size reached&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Maximum function count exceeded&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Infinite or NaN function value encountered&#39;</span>
      <span class="p">],</span>
      <span class="nx">Q</span><span class="p">;</span>

  <span class="nx">options</span><span class="p">.</span><span class="nx">calls</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="nx">options</span><span class="p">.</span><span class="nx">warn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">a</span> <span class="o">=</span> <span class="o">-</span><span class="nb">Number</span><span class="p">.</span><span class="nx">MAX_VALUE</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">b</span> <span class="o">===</span>   <span class="kc">Infinity</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">b</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">.</span><span class="nx">MAX_VALUE</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;minStep&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">minStep</span> <span class="o">=</span> <span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">15</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;maxCalls&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">maxCalls</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;tolerance&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">tolerance</span> <span class="o">=</span> <span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">5</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">Q</span> <span class="o">=</span> <span class="nx">quadstep</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span> <span class="nx">f</span><span class="p">((</span><span class="nx">a</span><span class="o">+</span><span class="nx">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nx">f</span><span class="p">(</span><span class="nx">b</span><span class="p">),</span> <span class="nx">options</span><span class="p">);</span>

  <span class="nx">options</span><span class="p">.</span><span class="nx">warnMessage</span> <span class="o">=</span> <span class="nx">warnMessage</span><span class="p">[</span><span class="nx">options</span><span class="p">.</span><span class="nx">warn</span><span class="p">];</span>

  <span class="k">return</span> <span class="nx">Q</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Recursive function for the quad method</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">quadstep</span> <span class="o">=</span> <span class="kd">function</span>  <span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">fa</span><span class="p">,</span> <span class="nx">fc</span><span class="p">,</span> <span class="nx">fb</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="nx">b</span> <span class="o">-</span> <span class="nx">a</span><span class="p">,</span>
      <span class="nx">c</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
      <span class="nx">fd</span> <span class="o">=</span> <span class="nx">f</span><span class="p">((</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
      <span class="nx">fe</span> <span class="o">=</span> <span class="nx">f</span><span class="p">((</span><span class="nx">c</span> <span class="o">+</span> <span class="nx">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Three point Simpson's rule</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">Q1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">h</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nx">fa</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="nx">fc</span> <span class="o">+</span> <span class="nx">fb</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Five point double Simpson's rule</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">Q2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">h</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nx">fa</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="nx">fd</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="nx">fc</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="nx">fe</span> <span class="o">+</span> <span class="nx">fb</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Romberg extrapolation</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">Q</span> <span class="o">=</span> <span class="nx">Q2</span> <span class="o">+</span> <span class="p">(</span><span class="nx">Q2</span> <span class="o">-</span> <span class="nx">Q1</span><span class="p">)</span><span class="o">/</span><span class="mi">15</span><span class="p">;</span>

      <span class="nx">options</span><span class="p">.</span><span class="nx">calls</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">calls</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>

  </pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Infinite or Not-a-Number function value encountered</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nb">isFinite</span><span class="p">(</span><span class="nx">Q</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">warn</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">warn</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">Q</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Maximum function count exceeded; singularity likely</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">calls</span> <span class="o">&gt;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">maxCalls</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">warn</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">warn</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">Q</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Accuracy over this subinterval is acceptable</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">Q2</span> <span class="o">-</span> <span class="nx">Q</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">tolerance</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Q</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>Minimum step size reached; singularity possible</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">minStep</span> <span class="o">||</span> <span class="nx">c</span> <span class="o">===</span> <span class="nx">a</span> <span class="o">||</span> <span class="nx">c</span> <span class="o">===</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">warn</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">warn</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">Q</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Otherwise, divide the interval into two subintervals</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="nx">quadstep</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">fa</span><span class="p">,</span> <span class="nx">fd</span><span class="p">,</span> <span class="nx">fc</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span>
        <span class="o">+</span> <span class="nx">quadstep</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">fc</span><span class="p">,</span> <span class="nx">fe</span><span class="p">,</span> <span class="nx">fb</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <h3>Functn.prototype.toContentMathML()</h3>

<p>Returns a content MathML representation of the function</p>

<p><em>@returns {MathML}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">functnPrototype</span><span class="p">.</span><span class="nx">toContentMathML</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Functn/toContentMathMLString">Functn.prototype.toContentMathMLString()</a></h3>

<p>Returns a content MathML representation of the function</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">functnPrototype</span><span class="p">.</span><span class="nx">toContentMathMLString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">bvar</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">outerMathML</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Functn/toLaTeX">Functn.prototype.toLaTeX()</a></h3>

<p>Returns a LaTeX representation of the function</p>

<p><em>@param {string}</em> Optional: custom name for the bound variable (default: x) <br />
<em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">functnPrototype</span><span class="p">.</span><span class="nx">toLaTeX</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">bvar</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>List of functions to be executed on the specified node type</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">handlers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">apply</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
          <span class="nx">args</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">handlers</span><span class="p">[</span><span class="nx">x</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">](</span><span class="nx">x</span><span class="p">);</span>
          <span class="p">}),</span>
          <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;plus&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;times&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;power&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;^{&#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>TODO: not all functions can be written like \sin some have to be written like \operatorname{argmax}</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;\\&#39;</span> <span class="o">+</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">bvar</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;},</span>
    <span class="nx">ci</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">bvar</span> <span class="o">||</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;},</span>
    <span class="nx">cn</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;},</span>
    <span class="nx">cs</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;},</span>
    <span class="nx">domainofapplication</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;},</span>
    <span class="nx">lambda</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="nx">handlers</span><span class="p">[</span><span class="nx">cur</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">](</span><span class="nx">cur</span><span class="p">);</span>
      <span class="p">},</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="s1">&#39;#text&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;}</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Start the node handling with the first real element (not the <math> element)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="nx">handlers</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">](</span><span class="k">this</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <h3>Functn.prototype.toMathML()</h3>

<p>Returns a MathML representation of the function</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*functnPrototype.toMathML = function() {</span>

<span class="cm">//DIVIDER</span>
<span class="cm">  return this.contentMathML.toMathML();</span>
<span class="cm">};*/</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>Get the content MathML and convert it to presentation MathML</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">functnPrototype</span><span class="p">.</span><span class="nx">toMathMLString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">();</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Functn/toMathMLString">Functn.prototype.toMathMLString()</a></h3>

<p>Returns a MathML representation of the function</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">functnPrototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">bvar</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Functn/toString">Functn.prototype.toString()</a></h3>

<p>Returns a string representation of the function</p>

<p><em>@param {string}</em> Optional: custom name for the bound variable (default: x) <br />
<em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">handlers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">apply</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
          <span class="nx">args</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">handlers</span><span class="p">[</span><span class="nx">x</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">](</span><span class="nx">x</span><span class="p">);</span>
          <span class="p">}),</span>
          <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;plus&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;times&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;power&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">bvar</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;},</span>
    <span class="nx">ci</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">bvar</span> <span class="o">||</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;},</span>
    <span class="nx">cn</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;},</span>
    <span class="nx">cs</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;},</span>
    <span class="nx">domainofapplication</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;},</span>
    <span class="nx">lambda</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="nx">handlers</span><span class="p">[</span><span class="nx">cur</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">](</span><span class="nx">cur</span><span class="p">);</span>
      <span class="p">},</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="p">},</span> 
    <span class="s1">&#39;#text&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">innerMathML</span><span class="p">;}</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>List of functions to be executed on the specified node type</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="nx">handlers</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">](</span><span class="k">this</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">}</span>


<span class="kd">var</span> <span class="nx">mathStart</span> <span class="o">=</span> <span class="s1">&#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;reals/&gt;&lt;/domainofapplication&gt;&lt;apply&gt;&lt;&#39;</span><span class="p">,</span>
    <span class="nx">mathEnd</span>   <span class="o">=</span> <span class="s1">&#39;/&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/apply&gt;&lt;/lambda&gt;&lt;/math&gt;&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>Start the node handling with the first real element (not the <math> element)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">unaryFunctions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">abs</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">,</span>
  <span class="nx">arccos</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">acos</span><span class="p">,</span>
  <span class="nx">arccot</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mf">1.5707963267948966</span> <span class="o">-</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">atan</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">arccsc</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">asin</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nx">x</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">arcosh</span><span class="o">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">Math</span><span class="p">).</span><span class="nx">acosh</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">){</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
  <span class="p">},</span>  
  <span class="nx">arcoth</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <h2>unary functions</h2>

<p>Some functions for the functn prototype</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nb">isFinite</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="nx">x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="nx">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">arcsch</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Handle </p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nb">isFinite</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="nx">x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nx">x</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="nx">x</span><span class="o">*</span><span class="nx">x</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">arcsec</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">acos</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nx">x</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">arcsin</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">asin</span><span class="p">,</span>
  <span class="nx">arctan</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">atan</span><span class="p">,</span>
  <span class="nx">arsech</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nx">x</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">arsinh</span><span class="o">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">Math</span><span class="p">).</span><span class="nx">asinh</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>Handle 0 and  separately</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nb">isFinite</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">x</span> <span class="o">*</span> <span class="nx">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">artanh</span><span class="o">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">Math</span><span class="p">).</span><span class="nx">atanh</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>Handle 0 and  separately</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">x</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">ceil</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>Handle 0</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">floor</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">,</span>
  <span class="nx">cos</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">,</span>
  <span class="nx">cosh</span><span class="o">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">Math</span><span class="p">).</span><span class="nx">cosh</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="nx">x</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">cot</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>Some implementations have a bug where Math.ceil(-0) = +0 (instead of -0)</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="nx">x</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>Handle 0 separate, because tan(pi/2  0) is not </p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">tan</span><span class="p">(</span><span class="mf">1.5707963267948966</span> <span class="o">-</span> <span class="nx">x</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">coth</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>cot(x) = tan(pi/2 - x) is better than 1/tan(x)</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="nx">x</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>Handle 0</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nb">isFinite</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="nx">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="nx">x</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">csc</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">csch</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>Handle </p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="nx">x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="nx">x</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">exp</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">inverse</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="nx">x</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">sec</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">sech</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="nx">x</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">sin</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">,</span>
  <span class="nx">sinh</span><span class="o">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">Math</span><span class="p">).</span><span class="nx">sinh</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>csch(-0) should be - not </p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="nx">x</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">tan</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">tan</span><span class="p">,</span>
  <span class="nx">tanh</span><span class="o">:</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">Math</span><span class="p">).</span><span class="nx">tanh</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">p</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>sinh(-0) should be -0</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nb">isFinite</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">p</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">p</span><span class="o">*</span><span class="nx">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">p</span><span class="o">*</span><span class="nx">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>

  </pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>Handle 0 and  separately
Their values happen to coincide with sign</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">elemfn</span> <span class="k">in</span> <span class="nx">unaryFunctions</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">unaryFunctions</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">elemfn</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">MathLib</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">elemfn</span><span class="p">,</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="nx">unaryFunctions</span><span class="p">[</span><span class="nx">elemfn</span><span class="p">],</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nx">elemfn</span><span class="p">,</span> <span class="nx">contentMathMLString</span><span class="o">:</span> <span class="nx">mathStart</span> <span class="o">+</span> <span class="nx">elemfn</span> <span class="o">+</span> <span class="nx">mathEnd</span><span class="p">}));</span>
  <span class="p">}</span>
<span class="p">}</span>


<span class="nx">MathLib</span><span class="p">.</span><span class="nx">identity</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="kd">function</span> <span class="nx">identity</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
  <span class="p">},</span> <span class="p">{</span><span class="nx">contentMathMLString</span><span class="o">:</span> <span class="nx">mathStart</span> <span class="o">+</span> <span class="s1">&#39;ident&#39;</span> <span class="o">+</span> <span class="nx">mathEnd</span><span class="p">}</span>
<span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>Create the elementary functions</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">functionList1</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">arctan2</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">atan2</span><span class="p">,</span>
  <span class="nx">binomial</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>These functions will be added to the functn prototype soon.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">k</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">k</span> <span class="o">&gt;</span> <span class="nx">n</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>or k > n > 0</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">if</span> <span class="p">(</span><span class="nx">n</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">res</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">k</span><span class="p">);</span>
            <span class="nx">n</span> <span class="o">=</span> <span class="nx">k</span> <span class="o">-</span> <span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">k</span> <span class="o">&gt;</span> <span class="nx">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">k</span> <span class="o">=</span> <span class="nx">n</span><span class="o">-</span><span class="nx">k</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;=</span><span class="nx">k</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">res</span> <span class="o">*=</span> <span class="p">(</span><span class="nx">n</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="nx">i</span><span class="p">)</span><span class="o">/</span><span class="nx">i</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">cbrt</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">a3</span><span class="p">,</span> <span class="nx">a3x</span><span class="p">,</span> <span class="nx">an</span><span class="p">,</span> <span class="nx">a</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p>Optimizing n and k are integers
if (n % 1 === 0 &amp;&amp; k % 1 === 0) {
TODO: is this formula working if n is not an integer?</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">!==</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">===</span> <span class="kc">Infinity</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">===</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
          <span class="p">}</span>
          </pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p>Handle &plusmn;0, NaN, &plusmn;&infin;</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">a</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p>Get an approximation</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">a3</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
            <span class="nx">a3x</span> <span class="o">=</span> <span class="nx">a3</span> <span class="o">+</span> <span class="nx">x</span><span class="p">;</span>
            <span class="nx">an</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">*</span> <span class="p">(</span><span class="nx">a3x</span> <span class="o">+</span> <span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">a3x</span> <span class="o">+</span> <span class="nx">a3</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">an</span> <span class="o">-</span> <span class="nx">a</span><span class="p">))</span> <span class="p">{</span>
              <span class="k">break</span><span class="p">;</span> 
            <span class="p">}</span>
            <span class="nx">a</span> <span class="o">=</span> <span class="nx">an</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="nx">an</span><span class="p">;</span>
        <span class="p">},</span>
  <span class="nx">conjugate</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">copy</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">degToRad</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p>Halley's method</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">return</span> <span class="nx">x</span> <span class="o">*</span> <span class="mf">0.017453292519943295</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">digitsum</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">out</span> <span class="o">+=</span> <span class="nx">x</span> <span class="o">%</span> <span class="mi">10</span><span class="p">;</span>
          <span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">x</span> <span class="o">/</span> <span class="mi">10</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">out</span> <span class="o">+</span> <span class="nx">x</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">divide</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">inverse</span><span class="p">(</span><span class="nx">b</span><span class="p">));</span>
      <span class="p">},</span>
  <span class="nx">divisors</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">x</span><span class="o">===</span><span class="mi">1</span> <span class="o">?</span> <span class="p">[]</span> <span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="nx">x</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;=</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="o">%</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
      <span class="p">},</span>
  <span class="nx">factor</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span>
            <span class="nx">i</span><span class="p">;</span>
        <span class="nx">n</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">n</span><span class="o">%</span><span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">n</span> <span class="o">=</span> <span class="nx">n</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="nx">n</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">while</span> <span class="p">(</span><span class="nx">n</span><span class="o">%</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">n</span> <span class="o">=</span> <span class="nx">n</span><span class="o">/</span><span class="nx">i</span><span class="p">;</span>
            <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="nx">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">res</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">},</span>
  <span class="nx">factorial</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">((</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">170</span> <span class="o">&amp;&amp;</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isInt</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">===</span> <span class="kc">Infinity</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">Infinity</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isInt</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">||</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">NaN</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">x</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">out</span> <span class="o">*=</span> <span class="nx">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">out</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">fallingFactorial</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">j</span><span class="p">;</span>
        <span class="nx">s</span> <span class="o">=</span> <span class="nx">s</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">m</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">res</span>  <span class="o">*=</span> <span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="nx">j</span> <span class="o">*</span> <span class="nx">s</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">fibonacci</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">goldenRatio</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>
      <span class="p">},</span>
  <span class="nx">hypot</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
          <span class="nx">args</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
          <span class="nx">b</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">hypot</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">a</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
        <span class="nx">b</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>Math.PI / 180 = 57.29577951308232</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="kc">Infinity</span> <span class="o">||</span> <span class="nx">b</span> <span class="o">===</span> <span class="kc">Infinity</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">Infinity</span><span class="p">;</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p>Return Infinity if one value is infinite</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">b</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>

        <span class="k">return</span> <span class="nx">x</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">y</span><span class="o">/</span><span class="nx">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
      <span class="p">},</span>
  <span class="nx">hypot2</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p>Return +0 if both values are 0 (see IEEE 754-2008, 9.2.1)</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">x</span> <span class="o">===</span> <span class="kc">Infinity</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">===</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">;</span>
        <span class="p">}))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">Infinity</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">args</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="nx">cur</span><span class="o">*</span><span class="nx">cur</span><span class="p">;</span>
        <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">},</span>
  <span class="nb">isFinite</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="kc">Infinity</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">isInt</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">x</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nb">isNaN</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">x</span> <span class="o">!==</span> <span class="nx">x</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">isNegZero</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="nx">x</span> <span class="o">===</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">isOne</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span>    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">epsilon</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">isPosZero</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="nx">x</span> <span class="o">===</span> <span class="kc">Infinity</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">isPrime</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">sqrt</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">x</span><span class="p">),</span> <span class="nx">i</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">sqrt</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">%</span> <span class="nx">i</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">isReal</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span>    <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">isZero</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">epsilon</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">lg</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">LN10</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">ln</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">,</span>
  <span class="nx">log</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">x</span> <span class="o">=</span> <span class="nx">base</span><span class="p">;</span>
          <span class="nx">base</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">base</span><span class="p">);</span>
      <span class="p">},</span>
  <span class="nx">minus</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">(</span><span class="nx">b</span><span class="p">));</span>
      <span class="p">},</span>
  <span class="nx">mod</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">nm</span> <span class="o">=</span> <span class="nx">n</span><span class="o">%</span><span class="nx">m</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">nm</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">nm</span> <span class="o">:</span> <span class="nx">nm</span> <span class="o">+</span> <span class="nx">m</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">negative</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="nx">x</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">pow</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">1</span> <span class="o">||</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">y</span> <span class="o">===</span> <span class="kc">Infinity</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">===</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">)))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>
      <span class="p">},</span>
  <span class="nx">radToDeg</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <p>Return Infinity if one value is infinite</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">return</span> <span class="nx">x</span><span class="o">*</span><span class="mf">57.29577951308232</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">random</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">,</span>
  <span class="nx">risingFactorial</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">j</span><span class="p">;</span>
        <span class="nx">s</span> <span class="o">=</span> <span class="nx">s</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">m</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">res</span>  <span class="o">*=</span> <span class="p">(</span><span class="nx">n</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">*</span> <span class="nx">s</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
      <span class="p">},</span>
  <span class="nx">round</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p>180 / Math.PI = 57.29577951308232</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
      <span class="p">},</span>
  <span class="nx">root</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">root</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">root</span><span class="p">);</span>
      <span class="p">},</span>
  <span class="nx">sign</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">x</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">x</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">);</span>
      <span class="p">},</span>
  <span class="nx">sqrt</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">,</span>
  <span class="nx">trunc</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="nx">n</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">},</span>
  <span class="nx">toLaTeX</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">plus</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">plus</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">x</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="s1">&#39;-&#39;</span> <span class="o">:</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">x</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="s1">&#39;-&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">},</span>
  <span class="nx">toMathMLString</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">plus</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">plus</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="s1">&#39;&lt;mo&gt;&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">x</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="s1">&#39;-&#39;</span> <span class="o">:</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mo&gt;&lt;mn&gt;&#39;</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mn&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">x</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="s1">&#39;&lt;mo&gt;-&lt;/mo&gt;&#39;</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;mn&gt;&#39;</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mn&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">},</span>
  <span class="nx">toString</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">plus</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">plus</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">x</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="s1">&#39;-&#39;</span> <span class="o">:</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">x</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="s1">&#39;-&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
<span class="p">};</span>

<span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">){</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;cn&gt;&#39;</span> <span class="o">+</span> <span class="nx">x</span> <span class="o">+</span> <span class="s1">&#39;&lt;/cn&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">toContentMathML</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <p>Some implementations have a bug where Math.round(-0) = +0 (instead of -0).</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">MathLib</span><span class="p">.</span><span class="nx">not</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">!</span><span class="nx">x</span><span class="p">;</span>
<span class="p">};</span>



<span class="nx">MathLib</span><span class="p">.</span><span class="nx">compare</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">!==</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">b</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">localeCompare</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">b</span><span class="p">)));</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">a</span><span class="o">-</span><span class="nx">b</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">localeCompare</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">MathLib</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;null&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;undefined&#39;</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <h3>MathLib.not()</h3>

<p>Negates the argument.</p>

<p><em>@param {boolean}</em> Expects one boolean argument <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">?</span> <span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">:</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">name</span> <span class="o">||</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">x</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)).</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="p">};</span>

<span class="nx">MathLib</span><span class="p">.</span><span class="nx">is</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p>The name property for DOM objects is undefined in Firefox.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">do</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">obj</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nb">Object</span><span class="p">(</span><span class="nx">obj</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="p">(</span><span class="nx">obj</span><span class="p">);</span>

  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p>if (MathLib.type(obj) === type) {
  return true;
}
return prototypes[type] ? prototypes[type].isPrototypeOf(obj) : typeof obj === type;</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">nAryFunctions</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p>Functions that act on set-like structures and return one single number/matrix...</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">and</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="o">!!</span><span class="nx">x</span><span class="p">;});</span>
  <span class="p">},</span>
  <span class="nx">arithMean</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="o">/</span> <span class="nx">n</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">gcd</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">min</span><span class="p">,</span>
        <span class="nx">reduction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">x</span> <span class="o">!==</span> <span class="nx">min</span> <span class="o">?</span> <span class="nx">x</span><span class="o">%</span><span class="nx">min</span> <span class="o">:</span> <span class="nx">x</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">isntZero</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">x</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <h3>MathLib.and()</h3>

<p>Returns true iff all arguments are true.</p>

<p><em>@param {boolean}</em> Expects an arbitrary number of boolean arguments <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">isntZero</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">while</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">min</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
      <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">reduction</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">isntZero</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="nx">min</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">geoMean</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">root</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">n</span><span class="p">),</span> <span class="nx">n</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">harmonicMean</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">length</span> <span class="o">/</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">inverse</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">lcm</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="o">/</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">gcd</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">max</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*if (n) {</span>
<span class="cm">      return this.sort(MathLib.compare)[this.length-n];</span>
<span class="cm">    }*/</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">n</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">min</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/*if (n) {</span>
<span class="cm">      return this.sort(MathLib.compare)[n-1];</span>
<span class="cm">    }*/</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">n</span><span class="p">);</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>remove zeros and make negative values positive</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">or</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="o">!!</span><span class="nx">x</span><span class="p">;});</span>
  <span class="p">},</span>
  <span class="nx">plus</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">f1</span><span class="p">,</span> <span class="nx">f2</span><span class="p">,</span> <span class="nx">astr</span><span class="p">,</span> <span class="nx">bstr</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">b</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;functn&#39;</span> <span class="o">||</span> <span class="nx">b</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;functn&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">astr</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;functn&#39;</span> <span class="o">?</span> <span class="nx">a</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">apply</span><span class="p">.</span><span class="nx">outerMathML</span> <span class="o">:</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
        <span class="nx">bstr</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;functn&#39;</span> <span class="o">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">apply</span><span class="p">.</span><span class="nx">outerMathML</span> <span class="o">:</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
        <span class="nx">f1</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span>
        <span class="nx">f2</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">!==</span> <span class="s1">&#39;functn&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">f1</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
          <span class="p">};</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">type</span> <span class="o">!==</span> <span class="s1">&#39;functn&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">f2</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">b</span><span class="p">;</span>
          <span class="p">};</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">MathML</span> <span class="o">=</span> <span class="s1">&#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;reals/&gt;&lt;/domainofapplication&gt;&lt;apply&gt;&lt;plus/&gt;&#39;</span> <span class="o">+</span> <span class="nx">astr</span> <span class="o">+</span> <span class="nx">bstr</span> <span class="o">+</span> <span class="s1">&#39;&lt;/apply&gt;&lt;/lambda&gt;&lt;/math&gt;&#39;</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">f1</span><span class="p">(</span><span class="nx">x</span><span class="p">),</span> <span class="nx">f2</span><span class="p">(</span><span class="nx">x</span><span class="p">));</span>
        <span class="p">},</span> <span class="p">{</span>
          <span class="nx">contentMathMLString</span><span class="o">:</span> <span class="nx">MathML</span>
        <span class="p">});</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <h3>MathLib.or()</h3>

<p>Returns true iff at least one argument is true.</p>

<p><em>@param {boolean}</em> Expects an arbitrary number of boolean arguments <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="nx">times</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">f1</span><span class="p">,</span> <span class="nx">f2</span><span class="p">,</span> <span class="nx">astr</span><span class="p">,</span> <span class="nx">bstr</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">b</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">a</span> <span class="o">*</span> <span class="nx">b</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;functn&#39;</span> <span class="o">||</span> <span class="nx">b</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;functn&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">astr</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;functn&#39;</span> <span class="o">?</span> <span class="nx">a</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">apply</span><span class="p">.</span><span class="nx">outerMathML</span> <span class="o">:</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
        <span class="nx">bstr</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;functn&#39;</span> <span class="o">?</span> <span class="nx">b</span><span class="p">.</span><span class="nx">contentMathML</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">apply</span><span class="p">.</span><span class="nx">outerMathML</span> <span class="o">:</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
        <span class="nx">f1</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span>
        <span class="nx">f2</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">!==</span> <span class="s1">&#39;functn&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">f1</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
          <span class="p">};</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">type</span> <span class="o">!==</span> <span class="s1">&#39;functn&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">f2</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">b</span><span class="p">;</span>
          <span class="p">};</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">MathML</span> <span class="o">=</span> <span class="s1">&#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;reals/&gt;&lt;/domainofapplication&gt;&lt;apply&gt;&lt;times/&gt;&#39;</span> <span class="o">+</span> <span class="nx">astr</span> <span class="o">+</span> <span class="nx">bstr</span> <span class="o">+</span> <span class="s1">&#39;&lt;/apply&gt;&lt;/lambda&gt;&lt;/math&gt;&#39;</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">f1</span><span class="p">(</span><span class="nx">x</span><span class="p">),</span> <span class="nx">f2</span><span class="p">(</span><span class="nx">x</span><span class="p">));</span>
        <span class="p">},</span> <span class="p">{</span>
          <span class="nx">contentMathMLString</span><span class="o">:</span> <span class="nx">MathML</span>
        <span class="p">});</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <p>We're assuming that the operations are commutative</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p>We're assuming that the operations are commutative</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">xor</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">n</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="o">!!</span><span class="nx">y</span><span class="p">;},</span> <span class="mi">0</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span> 
<span class="p">};</span>
 </pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <h3>MathLib.xor()</h3>

<p>Returns true iff an odd number of the arguments is true.</p>

<p><em>@param {boolean}</em> Expects an arbitrary number of boolean arguments <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*MathLib.plus = function (n) {</span>
<span class="cm">  return n.reduce(function (a, b) {</span>
<span class="cm">    var f1, f2, astr, bstr;</span>
<span class="cm">    if (typeof a === &#39;number&#39; &amp;&amp; typeof b === &#39;number&#39;) {</span>
<span class="cm">      return a + b;</span>
<span class="cm">    }</span>
<span class="cm">    else if (a.type === &#39;functn&#39; || b.type === &#39;functn&#39;) {</span>
<span class="cm">      astr = a.type === &#39;functn&#39; ? a.contentMathML.childNodes[0].apply.outerMathML : MathLib.toContentMathMLString(a);</span>
<span class="cm">      bstr = b.type === &#39;functn&#39; ? b.contentMathML.childNodes[0].apply.outerMathML : MathLib.toContentMathMLString(b);</span>
<span class="cm">      f1 = a;</span>
<span class="cm">      f2 = b;</span>
<span class="cm">      if (a.type !== &#39;functn&#39;) {</span>
<span class="cm">        f1 = function () {</span>
<span class="cm">          return a;</span>
<span class="cm">        };</span>
<span class="cm">      }</span>
<span class="cm">      else if(b.type !== &#39;functn&#39;) {</span>
<span class="cm">        f2 = function () {</span>
<span class="cm">          return b;</span>
<span class="cm">        };</span>
<span class="cm">      }</span>
<span class="cm">      var MathML = &#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;complexes/&gt;&lt;/domainofapplication&gt;&lt;apply&gt;&lt;plus/&gt;&#39; + astr + bstr + &#39;&lt;/apply&gt;&lt;/lambda&gt;&lt;/math&gt;&#39;;</span>
<span class="cm">      return MathLib.functn(function (x) {</span>
<span class="cm">        return MathLib.plus(f1(x), f2(x));</span>
<span class="cm">      }, {</span>
<span class="cm">        contentMathMLString: MathML</span>
<span class="cm">      });</span>
<span class="cm">    }</span>
<span class="cm">    else if (typeof a === &#39;object&#39;) {</span>
<span class="cm">      return a.plus(b);</span>
<span class="cm">    }</span>
<span class="cm">    / / We&#39;re assuming that the operations are commutative</span>
<span class="cm">    else if (typeof b === &#39;object&#39;) {</span>
<span class="cm">      return b.plus(a);</span>
<span class="cm">    }</span>
<span class="cm">  });</span>
<span class="cm">};</span>
<span class="cm">*/</span></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <h3>MathLib.plus()</h3>

<p>Returns the sum of all arguments.</p>

<p><em>@param {number, MathLib object}</em> Expects an arbitrary number of numbers or MathLib objects <br />
<em>@returns {number, MathLib object}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">flatten</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)).</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">a</span> <span class="o">-</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="nx">e</span><span class="o">-</span><span class="mi">15</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <h3>MathLib.isEqual()</h3>

<p>Determines if all arguments are equal.</p>

<p><em>@param {number, MathLib object}</em> Expects an arbitrary number of numbers or MathLib objects <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*MathLib.times = function () {</span>
<span class="cm">  return Array.prototype.slice.apply(arguments).reduce(function (a, b) {</span>
<span class="cm">    var f1, f2, astr, bstr;</span>
<span class="cm">    if (typeof a === &#39;number&#39; &amp;&amp; typeof b === &#39;number&#39;) {</span>
<span class="cm">      return a * b;</span>
<span class="cm">    }</span>
<span class="cm">    else if (a.type === &#39;functn&#39; || b.type === &#39;functn&#39;) {</span>
<span class="cm">      astr = a.type === &#39;functn&#39; ? a.contentMathML.childNodes[0].apply.outerMathML : MathLib.toContentMathMLString(a);</span>
<span class="cm">      bstr = b.type === &#39;functn&#39; ? b.contentMathML.childNodes[0].apply.outerMathML : MathLib.toContentMathMLString(b);</span>
<span class="cm">      f1 = a;</span>
<span class="cm">      f2 = b;</span>
<span class="cm">      if (a.type !== &#39;functn&#39;) {</span>
<span class="cm">        f1 = function () {</span>
<span class="cm">          return a;</span>
<span class="cm">        };</span>
<span class="cm">      }</span>
<span class="cm">      else if(b.type !== &#39;functn&#39;) {</span>
<span class="cm">        f2 = function () {</span>
<span class="cm">          return b;</span>
<span class="cm">        };</span>
<span class="cm">      }</span>
<span class="cm">      var MathML = &#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;complexes/&gt;&lt;/domainofapplication&gt;&lt;apply&gt;&lt;times/&gt;&#39; + astr + bstr + &#39;&lt;/apply&gt;&lt;/lambda&gt;&lt;/math&gt;&#39;;</span>
<span class="cm">      return MathLib.functn(function (x) {</span>
<span class="cm">        return MathLib.times(f1(x), f2(x));</span>
<span class="cm">      }, {</span>
<span class="cm">        contentMathMLString: MathML</span>
<span class="cm">      });</span>
<span class="cm">    }</span>
<span class="cm">    else if (typeof a === &#39;object&#39;) {</span>
<span class="cm">      return a.times(b);</span>
<span class="cm">    }</span>
<span class="cm">    / / We&#39;re assuming that the operations are commutative </span>
<span class="cm">    else if (typeof b === &#39;object&#39;) {</span>
<span class="cm">      return b.times(a);</span>
<span class="cm">    }</span>
<span class="cm">  });</span>
<span class="cm">};</span>
<span class="cm">*/</span>


<span class="kd">var</span> <span class="nx">createFunction1</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="p">(</span><span class="nx">y</span><span class="p">));};</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;set&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span> <span class="nx">x</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span><span class="p">[</span><span class="nx">name</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span><span class="p">[</span><span class="nx">name</span><span class="p">]();</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">};</span>


<span class="kd">var</span> <span class="nx">createFunction3</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;set&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">slice</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;array&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">n</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">};</span>
 </pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <h3>MathLib.times()</h3>

<p>Returns the product of all arguments.</p>

<p><em>@param {number, MathLib object}</em> Expects an arbitrary number of numbers or MathLib objects <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">func</span><span class="p">,</span> <span class="nx">cur</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">func</span> <span class="k">in</span> <span class="nx">functionList1</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">functionList1</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">func</span><span class="p">))</span> <span class="p">{</span>

    <span class="nx">cur</span> <span class="o">=</span> <span class="nx">functionList1</span><span class="p">[</span><span class="nx">func</span><span class="p">];</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="nx">createFunction1</span><span class="p">(</span><span class="nx">functionList1</span><span class="p">[</span><span class="nx">func</span><span class="p">],</span> <span class="nx">func</span><span class="p">)</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>



<span class="k">for</span> <span class="p">(</span><span class="nx">func</span> <span class="k">in</span> <span class="nx">nAryFunctions</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">nAryFunctions</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">func</span><span class="p">))</span> <span class="p">{</span>

    <span class="nx">cur</span> <span class="o">=</span> <span class="nx">nAryFunctions</span><span class="p">[</span><span class="nx">func</span><span class="p">];</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="nx">createFunction3</span><span class="p">(</span><span class="nx">nAryFunctions</span><span class="p">[</span><span class="nx">func</span><span class="p">],</span> <span class="nx">func</span><span class="p">)</span>
    <span class="p">});</span>

  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <p>Add the functions to the MathLib object</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Screen</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;screen&#39;</span><span class="p">;</span>

  <span class="nx">container</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">figure</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">wrapper</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">contextMenu</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">contextMenuOverlay</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">height</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">width</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">origHeight</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">origWidth</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">options</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">renderer</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">element</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">innerHTMLContextMenu</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <h2><a id="Screen"></a>Screen</h2>

<p>This module contains the common methods of all drawing modules.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">camera</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>


  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">id</span><span class="o">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
        <span class="nx">defaults</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">height</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
          <span class="nx">width</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
          <span class="nx">contextMenu</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">screenshot</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">fullscreen</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">grid</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="p">},</span>
          <span class="nx">figcaption</span><span class="o">:</span> <span class="s1">&#39;&#39;</span>
        <span class="p">},</span>
        <span class="nx">opts</span> <span class="o">=</span> <span class="nx">extendObject</span><span class="p">(</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">),</span>
        <span class="nx">container</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span>
        <span class="nx">innerHTMLContextMenu</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="nx">id</span> <span class="o">=</span> <span class="o">+</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
        <span class="nx">fullscreenchange</span><span class="p">,</span>
        <span class="nx">innerHTML</span><span class="p">,</span>
        <span class="nx">screen</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <p>3D</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">opts</span><span class="p">).</span><span class="nx">contextMenu</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">opts</span><span class="p">).</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">screenshot</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">innerHTMLContextMenu</span> <span class="o">+=</span> <span class="s1">&#39;&lt;div class=&quot;MathLib_screenshot MathLib_menuItem&quot;&gt;Save Screenshot&lt;/div&gt;&#39;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">opts</span><span class="p">).</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">fullscreen</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">innerHTMLContextMenu</span> <span class="o">+=</span> <span class="s1">&#39;&lt;div class=&quot;MathLib_fullscreen MathLib_menuItem&quot;&gt;&lt;span class=&quot;needs-nofullscreen&quot;&gt;Enter Fullscreen&lt;/span&gt;&lt;span class=&quot;needs-fullscreen&quot;&gt;Exit Fullscreen&lt;/span&gt;&lt;/div&gt;&#39;</span><span class="p">;</span>
          <span class="p">}</span>

          <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">opts</span><span class="p">).</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">grid</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">innerHTMLContextMenu</span> <span class="o">+=</span> <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem MathLib_hasSubmenu&quot;&gt;Grid&#39;</span><span class="p">;</span>
            <span class="nx">innerHTMLContextMenu</span> <span class="o">+=</span> <span class="s1">&#39;&lt;menu class=&quot;MathLib_menu MathLib_submenu&quot;&gt;&#39;</span><span class="p">;</span>

            <span class="nx">innerHTMLContextMenu</span> <span class="o">+=</span> <span class="p">[</span>
                <span class="s1">&#39;&lt;div class=&quot;MathLib_needs2D&quot;&gt;&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_&#39;</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span> <span class="s1">&#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;cartesian&quot;&gt;cartesian&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;&lt;/label&gt;&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_&#39;</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span> <span class="s1">&#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;polar&quot;&gt;polar&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;&lt;/label&gt;&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_&#39;</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span> <span class="s1">&#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;none&quot;&gt;none&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;&lt;/label&gt;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;&lt;/div&gt;&#39;</span>
            <span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
            <span class="nx">innerHTMLContextMenu</span> <span class="o">+=</span> <span class="s1">&#39;&lt;div class=&quot;MathLib_needs3D MathLib_menuItem MathLib_is_disabled&quot; style=&quot;font-size: 0.7em&quot;&gt;Gridoptions for 3D are coming soon.&lt;/div&gt;&#39;</span><span class="p">;</span>
            <span class="cm">/*</span>
<span class="cm">            innerHTMLContextMenu += [</span>
<span class="cm">                &#39;&lt;div class=&quot;MathLib_needs3D&quot;&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;div class=&quot;MathLib_menuItem MathLib_is_disabled&quot;&gt;xy-plane&lt;/div&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;,</span>
<span class="cm">                    &#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_xy&#39; + id + &#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;cartesian&quot;&gt;cartesian&#39;,</span>
<span class="cm">                  &#39;&lt;/label&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;,</span>
<span class="cm">                    &#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_xy&#39; + id + &#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;polar&quot;&gt;polar&#39;,</span>
<span class="cm">                  &#39;&lt;/label&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;,</span>
<span class="cm">                    &#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_xy&#39; + id + &#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;none&quot;&gt;none&#39;,</span>
<span class="cm">                  &#39;&lt;/label&gt;&#39;</span>
<span class="cm">            ].join(&#39;&#39;);</span>
<span class="cm">            innerHTMLContextMenu += [</span>
<span class="cm">                  &#39;&lt;div class=&quot;MathLib_menuItem MathLib_is_disabled&quot;&gt;xz-plane&lt;/div&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;,</span>
<span class="cm">                    &#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_xz&#39; + id + &#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;cartesian&quot;&gt;cartesian&#39;,</span>
<span class="cm">                  &#39;&lt;/label&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;,</span>
<span class="cm">                    &#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_xz&#39; + id + &#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;polar&quot;&gt;polar&#39;,</span>
<span class="cm">                  &#39;&lt;/label&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;,</span>
<span class="cm">                    &#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_xz&#39; + id + &#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;none&quot;&gt;none&#39;,</span>
<span class="cm">                  &#39;&lt;/label&gt;&#39;</span>
<span class="cm">            ].join(&#39;&#39;);</span>
<span class="cm">            innerHTMLContextMenu += [</span>
<span class="cm">                  &#39;&lt;div class=&quot;MathLib_menuItem MathLib_is_disabled&quot;&gt;yz-plane&lt;/div&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;,</span>
<span class="cm">                    &#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_yz&#39; + id + &#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;cartesian&quot;&gt;cartesian&#39;,</span>
<span class="cm">                  &#39;&lt;/label&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;,</span>
<span class="cm">                    &#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_yz&#39; + id + &#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;polar&quot;&gt;polar&#39;,</span>
<span class="cm">                  &#39;&lt;/label&gt;&#39;,</span>
<span class="cm">                  &#39;&lt;label class=&quot;MathLib_menuItem&quot;&gt;&#39;,</span>
<span class="cm">                    &#39;&lt;input type=&quot;radio&quot; name=&quot;MathLib_grid_type_yz&#39; + id + &#39;&quot; class=&quot;MathLib_radio MathLib_grid_type&quot; value=&quot;none&quot;&gt;none&#39;,</span>
<span class="cm">                  &#39;&lt;/label&gt;&#39;,</span>
<span class="cm">                &#39;&lt;/div&gt;&#39;</span>
<span class="cm">            ].join(&#39;&#39;);</span>
<span class="cm">            */</span>
            <span class="nx">innerHTMLContextMenu</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/menu&gt;&lt;/div&gt;&#39;</span><span class="p">;</span>
          <span class="p">}</span>

          <span class="nx">innerHTMLContextMenu</span> <span class="o">+=</span> <span class="s1">&#39;&lt;hr class=&quot;MathLib_separator&quot;&gt;&lt;div class=&quot;MathLib_is_disabled MathLib_menuItem MathLib_is_centered&quot; style=&quot;font-size:0.83em&quot;&gt;Plot generated by MathLib.js&lt;/div&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span> 



        <span class="nx">innerHTML</span> <span class="o">=</span> <span class="p">[</span></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <p>Generate the context menu</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="s1">&#39;&lt;figure class=&quot;MathLib_figure&quot;&gt;&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <p>The figure contains the plot and the caption</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="s1">&#39;&lt;div class=&quot;MathLib_wrapper&quot; style=&quot;width: &#39;</span><span class="o">+</span><span class="nx">opts</span><span class="p">.</span><span class="nx">width</span><span class="o">+</span><span class="s1">&#39;px; height: &#39;</span><span class="o">+</span><span class="nx">opts</span><span class="p">.</span><span class="nx">height</span><span class="o">+</span><span class="s1">&#39;px&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-92">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-92">&#182;</a>               </div>               <p>The canvas or SVG element will be inserted here</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">opts</span><span class="p">).</span><span class="nx">figcaption</span> <span class="o">?</span> <span class="s1">&#39;&lt;figcaption class=&quot;MathLib_figcaption&quot;&gt;&#39;</span><span class="o">+</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">opts</span><span class="p">).</span><span class="nx">figcaption</span><span class="o">+</span><span class="s1">&#39;&lt;/figcaption&gt;&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>

          <span class="s1">&#39;&lt;/figure&gt;&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-93">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-93">&#182;</a>               </div>               <p>Add the optional figcaption</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="s1">&#39;&lt;div class=&quot;MathLib_contextMenuOverlay&quot;&gt;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;&lt;menu class=&quot;MathLib_menu MathLib_mainmenu&quot;&gt;&#39;</span><span class="p">,</span>
              <span class="nx">innerHTMLContextMenu</span><span class="p">,</span>
            <span class="s1">&#39;&lt;/menu&gt;&#39;</span><span class="p">,</span>
          <span class="s1">&#39;&lt;/div&gt;&#39;</span>
        <span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>


    <span class="nx">container</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">innerHTML</span><span class="p">;</span>
    <span class="nx">container</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;MathLib_container&#39;</span><span class="p">);</span>


    <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">container</span> <span class="o">=</span> <span class="nx">container</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">figure</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_figure&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_wrapper&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_mainmenu&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">contextMenuOverlay</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_contextMenuOverlay&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">innerHTMLContextMenu</span> <span class="o">=</span> <span class="nx">innerHTMLContextMenu</span><span class="p">;</span>


    <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">contextMenu</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">oncontextmenu</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_this</span><span class="p">.</span><span class="nx">oncontextmenu</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
      <span class="p">};</span>
    
      <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">opts</span><span class="p">).</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">screenshot</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_screenshot&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">dataURI</span><span class="p">,</span>
              <span class="nx">a</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span>

          <span class="k">if</span> <span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;Canvas&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;screen2D&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;canvas&#39;</span><span class="p">),</span>
                <span class="nx">ctx</span> <span class="o">=</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">canvas</span><span class="p">).</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">&#39;2d&#39;</span><span class="p">);</span>

            <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">canvas</span><span class="p">).</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
            <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">canvas</span><span class="p">).</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>

            <span class="nx">ctx</span><span class="p">.</span><span class="nx">drawImage</span><span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">layer</span><span class="p">.</span><span class="nx">back</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
            <span class="nx">ctx</span><span class="p">.</span><span class="nx">drawImage</span><span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">layer</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
            <span class="nx">ctx</span><span class="p">.</span><span class="nx">drawImage</span><span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">layer</span><span class="p">.</span><span class="nx">axis</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
            <span class="nx">ctx</span><span class="p">.</span><span class="nx">drawImage</span><span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">element</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>


            <span class="nx">dataURI</span> <span class="o">=</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">canvas</span><span class="p">).</span><span class="nx">toDataURL</span><span class="p">(</span><span class="s2">&quot;image/png&quot;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;download&#39;</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
              <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">).</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">dataURI</span><span class="p">;</span>
              <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">).</span><span class="nx">download</span> <span class="o">=</span> <span class="s1">&#39;plot.png&#39;</span><span class="p">;</span>
              <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
              <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">dataURI</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;image/png&quot;</span><span class="p">,</span> <span class="s2">&quot;image/octet-stream&quot;</span><span class="p">);</span>
            <span class="p">}</span>
          <span class="p">}</span>

          <span class="k">if</span> <span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;WebGL&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;screen3D&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">dataURI</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">toDataURL</span><span class="p">(</span><span class="s2">&quot;image/png&quot;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;download&#39;</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
              <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">).</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">dataURI</span><span class="p">;</span>
              <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">).</span><span class="nx">download</span> <span class="o">=</span> <span class="s1">&#39;plot.png&#39;</span><span class="p">;</span>
              <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
              <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">dataURI</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;image/png&quot;</span><span class="p">,</span> <span class="s2">&quot;image/octet-stream&quot;</span><span class="p">);</span>
            <span class="p">}</span>
          <span class="p">}</span>

          <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;SVG&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">dataURI</span> <span class="o">=</span> <span class="s1">&#39;data:image/svg+xml,&#39;</span> <span class="o">+</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;download&#39;</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
              <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">).</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">dataURI</span><span class="p">;</span>
              <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">).</span><span class="nx">download</span> <span class="o">=</span> <span class="s1">&#39;plot.svg&#39;</span><span class="p">;</span>
              <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">a</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
              <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">dataURI</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;image/svg+xml&quot;</span><span class="p">,</span> <span class="s2">&quot;image/octet-stream&quot;</span><span class="p">);</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>


      <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">opts</span><span class="p">).</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">fullscreen</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_fullscreen&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">document</span><span class="p">).</span><span class="nx">fullscreenElement</span><span class="p">)</span> <span class="p">{</span>
            <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">document</span><span class="p">).</span><span class="nx">exitFullScreen</span><span class="p">();</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="nx">_this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">requestFullScreen</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">};</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">opts</span><span class="p">).</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">grid</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_grid_type&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">onchange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">grid</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;cartesian&#39;</span><span class="p">;</span>
          <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">draw</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_grid_type&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="nx">onchange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">grid</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;polar&#39;</span><span class="p">;</span>
          <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">draw</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_grid_type&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">].</span><span class="nx">onchange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">grid</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">draw</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">}</span>


    <span class="p">}</span>



    <span class="nx">fullscreenchange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">document</span><span class="p">).</span><span class="nx">fullscreenElement</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_this</span><span class="p">.</span><span class="nx">origWidth</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
        <span class="nx">_this</span><span class="p">.</span><span class="nx">origHeight</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
        <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">resize</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">_this</span><span class="p">).</span><span class="nx">resize</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">origWidth</span><span class="p">,</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">origHeight</span><span class="p">);</span>
        <span class="k">delete</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">origWidth</span><span class="p">;</span>
        <span class="k">delete</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">origHeight</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;onfullscreenchange&#39;</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;fullscreenchange&#39;</span><span class="p">,</span> <span class="nx">fullscreenchange</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;onmozfullscreenchange&#39;</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;mozfullscreenchange&#39;</span><span class="p">,</span> <span class="nx">fullscreenchange</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;onwebkitfullscreenchange&#39;</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;webkitfullscreenchange&#39;</span><span class="p">,</span> <span class="nx">fullscreenchange</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-94">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-94">&#182;</a>               </div>               <p>The context menu</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">oncontextmenu</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">listener</span><span class="p">,</span>
      <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
      <span class="nx">menu</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">,</span>
      <span class="nx">overlay</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">contextMenuOverlay</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="nx">evt</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>


  <span class="nx">menu</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">setProperty</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">clientY</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">);</span>
  <span class="nx">menu</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">setProperty</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">clientX</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">);</span>
  <span class="nx">overlay</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">setProperty</span><span class="p">(</span><span class="s1">&#39;display&#39;</span><span class="p">,</span> <span class="s1">&#39;block&#39;</span><span class="p">);</span>
  


  <span class="nx">listener</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">overlay</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">setProperty</span><span class="p">(</span><span class="s1">&#39;display&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">);</span>
    
    <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;MathLib_temporaryMenuItem&#39;</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">_this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">overlay</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">overlay</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-95">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-95">&#182;</a>               </div>               <h3>Screen.prototype.contextmenu()</h3>

<p>Handles the contextmenu event</p>

<p><em>@param {event}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Layer</span> <span class="p">{</span>


  <span class="nx">ctx</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">element</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">id</span><span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nx">screen</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">zIndex</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">stack</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">transformation</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">applyTransformation</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-96">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-96">&#182;</a>               </div>               <h2><a id="Layers"></a>Layers</h2>

<p>Layers for two dimensional plotting</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">draw</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">circle</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">line</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">path</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">pixel</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">point</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">text</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>


  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">screen</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">zIndex</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">screen</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">zIndex</span> <span class="o">=</span> <span class="nx">zIndex</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">stack</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">transformation</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">element</span><span class="p">;</span>


    <span class="k">if</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;Canvas&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-97">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-97">&#182;</a>               </div>               <p>Drawing functions</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;canvas&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;MathLib_screen&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
      <span class="nx">screen</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">element</span> <span class="o">=</span> <span class="nx">element</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-98">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-98">&#182;</a>               </div>               <p>Create the canvas</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">&#39;2d&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">applyTransformation</span> <span class="o">=</span>  <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">;</span>
        <span class="nx">_this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">setTransform</span><span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]);</span>
      <span class="p">};</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-99">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-99">&#182;</a>               </div>               <p>Get the context and apply the transformations</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;back&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">top</span>     <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
              <span class="nx">bottom</span>  <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
              <span class="nx">left</span>    <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
              <span class="nx">right</span>   <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-100">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-100">&#182;</a>               </div>               <p>Set the drawing functions      </p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">background</span><span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">bottom</span><span class="p">,</span> <span class="nx">right</span><span class="o">-</span><span class="nx">left</span><span class="p">,</span> <span class="nx">top</span><span class="o">-</span><span class="nx">bottom</span><span class="p">);</span>

          <span class="nx">canvas</span><span class="p">.</span><span class="nx">draw</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_this</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;grid&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeStyle</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">color</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;#cccccc&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s1">&#39;rgba(255,255,255,0)&#39;</span><span class="p">;</span>

        
        <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
          <span class="nx">_this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">lineWidth</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
          <span class="nx">drawGrid</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_this</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeStyle</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">axis</span><span class="p">.</span><span class="nx">color</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;#000000&#39;</span><span class="p">;</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
          <span class="nx">_this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">lineWidth</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
          <span class="nx">drawAxis</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_this</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeStyle</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s1">&#39;rgba(255,255,255,0)&#39;</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
          <span class="nx">_this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">lineWidth</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
          <span class="nx">canvas</span><span class="p">.</span><span class="nx">draw</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_this</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>


      <span class="k">this</span><span class="p">.</span><span class="nx">circle</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">circle</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">line</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">path</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">pixel</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">pixel</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">point</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">point</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>

    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;SVG&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">),</span>
          <span class="nx">m</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">;</span>
      <span class="nx">ctx</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span>
        <span class="s1">&#39;matrix(&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="p">);</span>
      <span class="nx">screen</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-101">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-101">&#182;</a>               </div>               <p>Draw the background</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;back&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">top</span>     <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
              <span class="nx">bottom</span>  <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
              <span class="nx">left</span>    <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
              <span class="nx">right</span>   <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>

          <span class="nx">svg</span><span class="p">.</span><span class="nx">draw</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_this</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;grid&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke&#39;</span><span class="p">,</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">color</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;#cccccc&#39;</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
          <span class="nx">ctx</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke-width&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
          <span class="nx">drawGrid</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_this</span><span class="p">);</span>
        <span class="p">};</span>

      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke&#39;</span><span class="p">,</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">axis</span><span class="p">.</span><span class="nx">color</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;#000000&#39;</span><span class="p">);</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
          <span class="nx">ctx</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke-width&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
          <span class="nx">drawAxis</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_this</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">draw</span><span class="p">;</span>
      <span class="p">}</span>


      <span class="k">this</span><span class="p">.</span><span class="nx">circle</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">circle</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">line</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">path</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">pixel</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">pixel</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">point</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">point</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-102">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-102">&#182;</a>               </div>               <p>Set the drawing functions      </p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">screen</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">zIndex</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-103">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-103">&#182;</a>               </div>               <p>Insert the layer into the layer array of the screen object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">drawAxis</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
      <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">stroke</span><span class="o">:</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">axis</span><span class="p">.</span><span class="nx">color</span><span class="p">),</span>
        <span class="s1">&#39;stroke-width&#39;</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
      <span class="p">},</span>
      <span class="nx">textOptions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">strokeStyle</span><span class="o">:</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">axis</span><span class="p">.</span><span class="nx">textColor</span><span class="p">),</span>
        <span class="nx">fillStyle</span><span class="o">:</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">axis</span><span class="p">.</span><span class="nx">textColor</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="nx">top</span>     <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
      <span class="nx">bottom</span>  <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
      <span class="nx">left</span>    <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
      <span class="nx">right</span>   <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
      <span class="nx">lengthX</span> <span class="o">=</span> <span class="o">+</span><span class="mi">10</span><span class="o">/</span><span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
      <span class="nx">lengthY</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="o">/</span><span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>

      <span class="nx">yExp</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">-</span><span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">Math</span><span class="p">.</span><span class="nx">LN10</span><span class="o">-</span><span class="mf">0.3</span><span class="p">),</span>
      <span class="nx">xExp</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+</span><span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="nb">Math</span><span class="p">.</span><span class="nx">LN10</span><span class="o">-</span><span class="mf">0.3</span><span class="p">),</span>
      <span class="nx">yTick</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nx">yExp</span><span class="p">),</span>
      <span class="nx">xTick</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nx">xExp</span><span class="p">),</span>
      <span class="nx">i</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">axis</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-104">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-104">&#182;</a>               </div>               <h3>Screen.prototype.drawAxis</h3>

<p>Draws the axis.</p>

<p><em>@returns {screen}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="nx">left</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="nx">right</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="nx">bottom</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nx">top</span><span class="p">]],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-105">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-105">&#182;</a>               </div>               <p>The axes</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">tick</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="nx">yTick</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">left</span><span class="p">;</span> <span class="nx">i</span> <span class="o">-=</span> <span class="nx">yTick</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="nx">i</span><span class="p">,</span> <span class="o">-</span><span class="nx">lengthY</span><span class="p">],</span> <span class="p">[</span><span class="nx">i</span><span class="p">,</span> <span class="nx">lengthY</span><span class="p">]],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">yTick</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">right</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">yTick</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="nx">i</span><span class="p">,</span> <span class="o">-</span><span class="nx">lengthY</span><span class="p">],</span> <span class="p">[</span><span class="nx">i</span><span class="p">,</span> <span class="nx">lengthY</span><span class="p">]],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-106">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-106">&#182;</a>               </div>               <p>The ticks on the axes
The x axis</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="nx">xTick</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">bottom</span><span class="p">;</span> <span class="nx">i</span> <span class="o">-=</span> <span class="nx">xTick</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="o">-</span><span class="nx">lengthX</span><span class="p">,</span> <span class="nx">i</span><span class="p">],</span> <span class="p">[</span><span class="nx">lengthX</span><span class="p">,</span> <span class="nx">i</span><span class="p">]],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">xTick</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">top</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">xTick</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="o">-</span><span class="nx">lengthX</span><span class="p">,</span> <span class="nx">i</span><span class="p">],</span> <span class="p">[</span><span class="nx">lengthX</span><span class="p">,</span> <span class="nx">i</span><span class="p">]],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-107">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-107">&#182;</a>               </div>               <p>The y axis</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">xLen</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="nx">xExp</span><span class="p">)),</span>
      <span class="nx">yLen</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="nx">yExp</span><span class="p">));</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="nx">yTick</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">left</span><span class="p">;</span> <span class="nx">i</span> <span class="o">-=</span> <span class="nx">yTick</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="nx">yLen</span><span class="p">),</span> <span class="nx">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nx">lengthY</span><span class="p">,</span> <span class="nx">textOptions</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">yTick</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">right</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">yTick</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="nx">yLen</span><span class="p">),</span> <span class="nx">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nx">lengthY</span><span class="p">,</span> <span class="nx">textOptions</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-108">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-108">&#182;</a>               </div>               <p>The labels
The x axis
.toFixed() is necessary to display 0.3 as "0.3" and not as "0.30000000000000004".
.toFixed expects arguments between 0 and 20.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="nx">xTick</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">bottom</span><span class="p">;</span> <span class="nx">i</span> <span class="o">-=</span> <span class="nx">xTick</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="nx">xLen</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nx">lengthX</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">textOptions</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">xTick</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">top</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">xTick</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="nx">xLen</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nx">lengthX</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">textOptions</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-109">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-109">&#182;</a>               </div>               <p>The y axis</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">drawGrid</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">grid</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
      <span class="nx">top</span>     <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
      <span class="nx">bottom</span>  <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
      <span class="nx">left</span>    <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
      <span class="nx">right</span>   <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
      <span class="nx">yTick</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">-</span><span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">Math</span><span class="p">.</span><span class="nx">LN10</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)),</span>
      <span class="nx">xTick</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+</span><span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="nb">Math</span><span class="p">.</span><span class="nx">LN10</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)),</span>
      <span class="nx">i</span><span class="p">;</span>


  <span class="k">if</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;cartesian&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-110">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-110">&#182;</a>               </div>               <h3>Screen2D.prototype.drawGrid</h3>

<p>Draws the grid.</p>

<p><em>@returns {Screen2D}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">bottom</span><span class="o">-</span><span class="p">(</span><span class="nx">bottom</span><span class="o">%</span><span class="nx">yTick</span><span class="p">);</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">top</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">yTick</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="nx">left</span><span class="p">,</span> <span class="nx">i</span><span class="p">],</span> <span class="p">[</span><span class="nx">right</span><span class="p">,</span> <span class="nx">i</span><span class="p">]],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-111">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-111">&#182;</a>               </div>               <p>The horizontal lines</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">left</span><span class="o">-</span><span class="p">(</span><span class="nx">left</span><span class="o">%</span><span class="nx">xTick</span><span class="p">);</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">right</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">xTick</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="nx">i</span><span class="p">,</span> <span class="nx">bottom</span><span class="p">],</span> <span class="p">[</span><span class="nx">i</span><span class="p">,</span> <span class="nx">top</span><span class="p">]],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-112">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-112">&#182;</a>               </div>               <p>The vertical lines</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="cm">/*for (i = left-(left%this.axis.tick.x); i &lt;= right; i += this.axis.tick.x) {</span>
<span class="cm">      for (var j = 1 ; j &lt;=10; j++ ) {</span>
<span class="cm">        this.line([[i*Math.log(10)+ Math.log(j), bottom], [i*Math.log(10)+Math.log(j), top]], options);</span>
<span class="cm">      }</span>
<span class="cm">    }*/</span>


  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;polar&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">max</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">top</span><span class="o">*</span><span class="nx">top</span><span class="p">,</span> <span class="nx">bottom</span><span class="o">*</span><span class="nx">bottom</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">left</span><span class="o">*</span><span class="nx">left</span><span class="p">,</span> <span class="nx">right</span><span class="o">*</span><span class="nx">right</span><span class="p">)),</span>
        <span class="nx">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// improve this estimate</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">angle</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="nx">max</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span> <span class="nx">max</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">i</span><span class="p">)]],</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">min</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">max</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">xTick</span><span class="p">,</span> <span class="nx">yTick</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">circle</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Circle</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nx">i</span><span class="p">),</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>






<span class="kd">var</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">normalizeOptions</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">res</span><span class="o">:</span><span class="nx">any</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;fillColor&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">fillColor</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;color&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;font&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">[</span><span class="s1">&#39;font-family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">font</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;fontSize&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">[</span><span class="s1">&#39;font-size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">fontSize</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;lineColor&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">strokeStyle</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">lineColor</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;color&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">strokeStyle</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
  <span class="p">},</span>


  <span class="nx">applyTransformation</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">l</span><span class="p">){</span><span class="nx">l</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">setTransform</span><span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])});</span>
  <span class="p">},</span>




  <span class="nx">draw</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="o">?</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;text&#39;</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">_this</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;pixel&#39;</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">_this</span><span class="p">.</span><span class="nx">pixel</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">t</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">r</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">b</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">l</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nx">_this</span><span class="p">[</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span><span class="p">](</span><span class="nx">x</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">}</span>


    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;circle&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">circle</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">x</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span><span class="nx">_this</span><span class="p">[</span><span class="nx">y</span><span class="p">.</span><span class="nx">type</span><span class="p">](</span><span class="nx">y</span><span class="p">,</span> <span class="nx">options</span><span class="p">);});</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-113">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-113">&#182;</a>               </div>               <p>Test for logarithmic plots</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">circle</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">circle</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">ctx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span>
        <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">;</span>

    <span class="nx">ctx</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineWidth</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-114">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-114">&#182;</a>               </div>               <h3>Canvas circle</h3>

<p>Draws a circle on the screen.</p>

<p><em>@param {circle}</em> The circle to be drawn <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">ctx</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">if</span><span class="p">(</span><span class="s1">&#39;setLineDash&#39;</span> <span class="k">in</span> <span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">setLineDash</span><span class="p">((</span><span class="s1">&#39;dash&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">dash</span> <span class="o">:</span> <span class="p">[]));</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;lineDashOffset&#39;</span> <span class="k">in</span> <span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineDashOffset</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;dashOffset&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">dashOffset</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-115">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-115">&#182;</a>               </div>               <p>Set the drawing options</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">circle</span><span class="p">.</span><span class="nx">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">radius</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">);</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">closePath</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">fill</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">circle</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>

  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-116">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-116">&#182;</a>               </div>               <p>Draw the circle</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">line</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">line</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">points</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">getLineEndPoints</span><span class="p">(</span><span class="nx">line</span><span class="p">),</span>
        <span class="nx">ctx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span>
        <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">;</span>

    <span class="nx">ctx</span><span class="p">.</span><span class="nx">save</span><span class="p">()</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineWidth</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-117">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-117">&#182;</a>               </div>               <h3>Canvas line</h3>

<p>Draws a line on the screen.</p>

<p><em>@param {line}</em> The line to be drawn <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">ctx</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">if</span><span class="p">(</span><span class="s1">&#39;setLineDash&#39;</span> <span class="k">in</span> <span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">setLineDash</span><span class="p">((</span><span class="s1">&#39;dash&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">dash</span> <span class="o">:</span> <span class="p">[]));</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;lineDashOffset&#39;</span> <span class="k">in</span> <span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineDashOffset</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;dashOffset&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">dashOffset</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-118">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-118">&#182;</a>               </div>               <p>Set the drawing options</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">points</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">points</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">closePath</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">line</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-119">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-119">&#182;</a>               </div>               <p>Draw the line</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">path</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">curve</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">ctx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span>
        <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span>
        <span class="nx">step</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span>
        <span class="nx">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">;</span>


    <span class="nx">from</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;from&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">from</span> <span class="o">:</span> <span class="p">(</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span><span class="o">-</span><span class="nx">step</span><span class="p">;</span>
    <span class="nx">to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;to&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">to</span> <span class="o">:</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span><span class="o">+</span><span class="nx">step</span><span class="p">;</span>

    <span class="nx">ctx</span><span class="p">.</span><span class="nx">save</span><span class="p">()</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineWidth</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-120">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-120">&#182;</a>               </div>               <h3>Canvas path</h3>

<p>Draws a path on the screen.</p>

<p><em>@param {path}</em> The path to be drawn <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the scren</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">ctx</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">if</span><span class="p">(</span><span class="s1">&#39;setLineDash&#39;</span> <span class="k">in</span> <span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">setLineDash</span><span class="p">((</span><span class="s1">&#39;dash&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">dash</span> <span class="o">:</span> <span class="p">[]));</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;lineDashOffset&#39;</span> <span class="k">in</span> <span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineDashOffset</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;dashOffset&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">dashOffset</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-121">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-121">&#182;</a>               </div>               <p>Set the drawing options</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">curve</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">path</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">from</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">to</span><span class="p">;</span> <span class="nx">i</span><span class="o">+=</span><span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">path</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">i</span><span class="p">,</span> <span class="nx">curve</span><span class="p">(</span><span class="nx">i</span><span class="p">)]);</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-122">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-122">&#182;</a>               </div>               <p>If curve is a function f, the path will be (x, f(x))</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">path</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="nx">x</span> <span class="o">=</span> <span class="nx">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="nx">y</span> <span class="o">=</span> <span class="nx">curve</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">from</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">to</span><span class="p">;</span> <span class="nx">i</span><span class="o">+=</span><span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">path</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">x</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span> <span class="nx">y</span><span class="p">(</span><span class="nx">i</span><span class="p">)]);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">path</span> <span class="o">=</span> <span class="nx">curve</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-123">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-123">&#182;</a>               </div>               <p>If curve is an array of two functions [f, g], the path will be (f(x), g(x))</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nx">path</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">});</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">closePath</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>


    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;path&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">curve</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-124">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-124">&#182;</a>               </div>               <p>Draw the path</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">pixel</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">top</span>     <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">bottom</span>  <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">left</span>    <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">right</span>   <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">ctx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span>
        <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>

    <span class="nx">t</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">top</span><span class="p">,</span> <span class="nx">t</span><span class="p">);</span>
    <span class="nx">r</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">right</span><span class="p">,</span> <span class="nx">r</span><span class="p">);</span>
    <span class="nx">b</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">bottom</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
    <span class="nx">l</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">l</span><span class="p">);</span>


    <span class="kd">var</span> <span class="nx">tPxl</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="o">-</span><span class="nx">t</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span>
        <span class="nx">rPxl</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">r</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">),</span>
        <span class="nx">bPxl</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="o">-</span><span class="nx">b</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span>
        <span class="nx">lPxl</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">l</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">),</span>
        <span class="nx">w</span> <span class="o">=</span> <span class="p">(</span><span class="nx">rPxl</span><span class="o">-</span><span class="nx">lPxl</span><span class="p">),</span>
        <span class="nx">h</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bPxl</span><span class="o">-</span><span class="nx">tPxl</span><span class="p">),</span>
        <span class="nx">imgData</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">createImageData</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">),</span>
        <span class="nx">pxl</span><span class="p">;</span>


    <span class="k">for</span> <span class="p">(</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">tPxl</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">bPxl</span><span class="p">;</span> <span class="nx">y</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">lPxl</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">rPxl</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span><span class="p">,</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">pxl</span> <span class="o">=</span> <span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="o">/</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="o">/</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
        <span class="nx">imgData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="nx">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nx">pxl</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="nx">imgData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pxl</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="nx">imgData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pxl</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
        <span class="nx">imgData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pxl</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">ctx</span><span class="p">.</span><span class="nx">putImageData</span><span class="p">(</span><span class="nx">imgData</span><span class="p">,</span> <span class="p">(</span><span class="nx">left</span><span class="o">-</span><span class="nx">l</span><span class="p">)</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="p">(</span><span class="nx">t</span><span class="o">-</span><span class="nx">top</span><span class="p">)</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>


    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;pixel&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">f</span><span class="p">,</span>
        <span class="nx">t</span><span class="o">:</span> <span class="nx">t</span><span class="p">,</span>
        <span class="nx">r</span><span class="o">:</span> <span class="nx">r</span><span class="p">,</span>
        <span class="nx">b</span><span class="o">:</span> <span class="nx">b</span><span class="p">,</span>
        <span class="nx">l</span><span class="o">:</span> <span class="nx">l</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-125">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-125">&#182;</a>               </div>               <h3>Canvas pixel</h3>

<p>Draws pixel on the screen.</p>

<p><em>@param {path}</em> The path to be drawn <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">point</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">point</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">ctx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span>
        <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">dist</span><span class="p">,</span> <span class="nx">textOptions</span><span class="p">;</span>

    <span class="nx">ctx</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineWidth</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-126">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-126">&#182;</a>               </div>               <h3>Canvas point</h3>

<p>Draws a point on the screen.</p>

<p><em>@param {point}</em> The point to be drawn <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;fillColor&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="s1">&#39;color&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">opts</span><span class="p">[</span><span class="s1">&#39;fillStyle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">for</span> <span class="p">(</span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">ctx</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">if</span><span class="p">(</span><span class="s1">&#39;setLineDash&#39;</span> <span class="k">in</span> <span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">setLineDash</span><span class="p">((</span><span class="s1">&#39;dash&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">dash</span> <span class="o">:</span> <span class="p">[]));</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;lineDashOffset&#39;</span> <span class="k">in</span> <span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineDashOffset</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;dashOffset&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">dashOffset</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-127">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-127">&#182;</a>               </div>               <p>Set the drawing options</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nx">point</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nx">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nx">point</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">size</span> <span class="o">||</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">);</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">closePath</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">fill</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>


    <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">label</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">dist</span> <span class="o">=</span> <span class="mf">1.75</span> <span class="o">*</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">size</span> <span class="o">||</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span><span class="p">);</span>
      <span class="nx">screen</span><span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">label</span><span class="p">,</span>
        <span class="nx">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nx">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="nx">dist</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span>
        <span class="nx">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nx">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="nx">dist</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span> <span class="p">{},</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;point&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">point</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>

  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-128">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-128">&#182;</a>               </div>               <p>Draw the point</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">text</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">defaults</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">font</span><span class="o">:</span>       <span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span>
          <span class="nx">fontSize</span><span class="o">:</span>   <span class="mi">10</span><span class="p">,</span>
          <span class="nx">fillColor</span><span class="o">:</span>  <span class="s1">&#39;rgba(0, 0, 0, 1)&#39;</span><span class="p">,</span>
          <span class="nx">lineColor</span><span class="o">:</span>  <span class="s1">&#39;rgba(0, 0, 0, 1)&#39;</span><span class="p">,</span>
          <span class="nx">lineWidth</span><span class="o">:</span>  <span class="mf">0.05</span>
        <span class="p">},</span>
        <span class="nx">ctx</span><span class="p">,</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-129">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-129">&#182;</a>               </div>               <h3>Canvas text</h3>

<p>Writes text on the screen.</p>

<p><em>@param {str}</em> The string to be drawn <br />
<em>@param {x}</em> The x coordinate <br />
<em>@param {y}</em> The y coordinate <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ctx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">;</span>

    <span class="nx">opts</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span><span class="nx">extendObject</span><span class="p">(</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-130">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-130">&#182;</a>               </div>               <p>Determine the layer to draw onto</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span> <span class="p">(</span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">ctx</span><span class="p">.</span><span class="nx">font</span> <span class="o">=</span> <span class="s1">&#39;10px Helvetica&#39;</span><span class="p">;</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">textAlign</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">;</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">textBaseline</span> <span class="o">=</span> <span class="s1">&#39;middle&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-131">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-131">&#182;</a>               </div>               <p>Set the drawing options</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">tf</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">;</span>

    <span class="nx">ctx</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
      <span class="nx">ctx</span><span class="p">.</span><span class="nx">transform</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nx">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="nx">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
      <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">tf</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">x</span><span class="p">,</span> <span class="nx">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">y</span><span class="p">);</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>


    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">str</span><span class="p">,</span>
        <span class="nx">x</span><span class="o">:</span> <span class="nx">x</span><span class="p">,</span>
        <span class="nx">y</span><span class="o">:</span> <span class="nx">y</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>


<span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="p">{</span>

  <span class="nx">normalizeOptions</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">res</span><span class="o">:</span><span class="nx">any</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;fillColor&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">fillColor</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;color&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;font&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">[</span><span class="s1">&#39;font-family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">font</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;fontSize&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">[</span><span class="s1">&#39;font-size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">fontSize</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;size&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">size</span> <span class="o">=</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">size</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;lineColor&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">lineColor</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;color&#39;</span> <span class="k">in</span> <span class="nx">opt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="nx">opt</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dash&#39;</span> <span class="k">in</span> <span class="nx">opt</span> <span class="o">&amp;&amp;</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">dash</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">[</span><span class="s1">&#39;stroke-dasharray&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">dash</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dashOffset&#39;</span> <span class="k">in</span> <span class="nx">opt</span> <span class="o">&amp;&amp;</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">dashOffset</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">[</span><span class="s1">&#39;stroke-dashoffset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opt</span><span class="p">.</span><span class="nx">dashOffset</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
  <span class="p">},</span>


  <span class="nx">applyTransformation</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">l</span><span class="p">){</span>
      <span class="nx">l</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span>
        <span class="s1">&#39;matrix(&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="p">)});</span>
  <span class="p">},</span>




  <span class="nx">draw</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="o">?</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;text&#39;</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">_this</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;pixel&#39;</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">_this</span><span class="p">.</span><span class="nx">pixel</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">t</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">r</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">b</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">l</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nx">_this</span><span class="p">[</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span><span class="p">](</span><span class="nx">x</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">}</span>


    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;circle&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">circle</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">x</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span><span class="nx">_this</span><span class="p">[</span><span class="nx">y</span><span class="p">.</span><span class="nx">type</span><span class="p">](</span><span class="nx">y</span><span class="p">,</span> <span class="nx">options</span><span class="p">);});</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-132">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-132">&#182;</a>               </div>               <p>Draw the text</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">circle</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">circle</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span>
        <span class="nx">svgCircle</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span> <span class="s1">&#39;circle&#39;</span><span class="p">);</span>

    <span class="nx">svgCircle</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="nx">svgCircle</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nx">svgCircle</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">radius</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">svgCircle</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke-width&#39;</span><span class="p">,</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">svgCircle</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">[</span><span class="nx">prop</span><span class="p">]);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">svgCircle</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">circle</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-133">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-133">&#182;</a>               </div>               <h3>SVG circle</h3>

<p>Draws a circle on the screen.</p>

<p><em>@param {circle}</em> The circle to be drawn <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">line</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">line</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">points</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">getLineEndPoints</span><span class="p">(</span><span class="nx">line</span><span class="p">),</span>
        <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span>
        <span class="nx">svgLine</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">);</span>

    <span class="nx">svgLine</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
    <span class="nx">svgLine</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;y1&#39;</span><span class="p">,</span> <span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nx">svgLine</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="nx">points</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
    <span class="nx">svgLine</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;y2&#39;</span><span class="p">,</span> <span class="nx">points</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">svgLine</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke-width&#39;</span><span class="p">,</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">svgLine</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">[</span><span class="nx">prop</span><span class="p">]);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">svgLine</span><span class="p">);</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">line</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-134">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-134">&#182;</a>               </div>               <h3>SVG line</h3>

<p>Draws a line on the screen.</p>

<p><em>@param {line}</em> The line to be drawn <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {canvas}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">path</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">curve</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">svgPath</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span><span class="p">),</span>
        <span class="nx">step</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span>
        <span class="nx">pathString</span><span class="p">,</span> <span class="nx">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">path</span><span class="p">;</span>

    <span class="nx">from</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;from&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">from</span> <span class="o">:</span> <span class="p">(</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span><span class="o">-</span><span class="nx">step</span><span class="p">;</span>
    <span class="nx">to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;to&#39;</span> <span class="k">in</span> <span class="nx">options</span> <span class="o">?</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">to</span> <span class="o">:</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span><span class="o">+</span><span class="nx">step</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-135">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-135">&#182;</a>               </div>               <h3>SVG path</h3>

<p>Draws a path on the screen.</p>

<p><em>@param {curve}</em> The path to be drawn <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">curve</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">path</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">from</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">to</span><span class="p">;</span> <span class="nx">i</span><span class="o">+=</span><span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">path</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">i</span><span class="p">,</span> <span class="nx">curve</span><span class="p">(</span><span class="nx">i</span><span class="p">)]);</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-136">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-136">&#182;</a>               </div>               <p>If curve is a function f, the path will be (x, f(x))</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">path</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="nx">x</span> <span class="o">=</span> <span class="nx">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="nx">y</span> <span class="o">=</span> <span class="nx">curve</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">from</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">to</span><span class="p">;</span> <span class="nx">i</span><span class="o">+=</span><span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">path</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">x</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span> <span class="nx">y</span><span class="p">(</span><span class="nx">i</span><span class="p">)]);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">path</span> <span class="o">=</span> <span class="nx">curve</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">pathString</span> <span class="o">=</span> <span class="s1">&#39;M&#39;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="s1">&#39; L&#39;</span> <span class="o">+</span> <span class="nx">cur</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="nx">svgPath</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="nx">pathString</span><span class="p">);</span>

    <span class="nx">svgPath</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke-width&#39;</span><span class="p">,</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>


    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">svgPath</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">[</span><span class="nx">prop</span><span class="p">]);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">svgPath</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;path&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">curve</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-137">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-137">&#182;</a>               </div>               <p>If curve is an array of two functions [f, g], the path will be (f(x), g(x))</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">pixel</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">top</span>     <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">bottom</span>  <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">left</span>    <span class="o">=</span> <span class="p">(</span>              <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">right</span>   <span class="o">=</span> <span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">ctx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span>
        <span class="nx">canvas</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;canvas&#39;</span><span class="p">),</span>
        <span class="nx">canvasCtx</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">&#39;2d&#39;</span><span class="p">),</span>
        <span class="nx">svgImage</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">),</span>
        <span class="nx">svgContainer</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">),</span>
        <span class="nx">dataURL</span><span class="p">,</span> <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">pxl</span><span class="p">,</span>
        <span class="nx">m</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">;</span>

    <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
    <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
    <span class="nx">canvasCtx</span><span class="p">.</span><span class="nx">setTransform</span><span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>



    <span class="nx">svgContainer</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix(&#39;</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;,0,0,&#39;</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;,-&#39;</span><span class="o">+</span><span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+-</span><span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">);</span>
    <span class="nx">svgImage</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">width</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">);</span>
    <span class="nx">svgImage</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">height</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">);</span>
    <span class="nx">svgImage</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">);</span>
    <span class="nx">svgImage</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">);</span>



    <span class="nx">t</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">top</span><span class="p">,</span> <span class="nx">t</span><span class="p">);</span>
    <span class="nx">r</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">right</span><span class="p">,</span> <span class="nx">r</span><span class="p">);</span>
    <span class="nx">b</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">bottom</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
    <span class="nx">l</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">l</span><span class="p">);</span>


    <span class="kd">var</span> <span class="nx">tPxl</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="o">-</span><span class="nx">t</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span>
        <span class="nx">rPxl</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">r</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">),</span>
        <span class="nx">bPxl</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="o">-</span><span class="nx">b</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span>
        <span class="nx">lPxl</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">l</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">),</span>
        <span class="nx">w</span> <span class="o">=</span> <span class="p">(</span><span class="nx">rPxl</span><span class="o">-</span><span class="nx">lPxl</span><span class="p">),</span>
        <span class="nx">h</span> <span class="o">=</span> <span class="p">(</span><span class="nx">tPxl</span><span class="o">-</span><span class="nx">bPxl</span><span class="p">),</span>
        <span class="nx">imgData</span> <span class="o">=</span> <span class="nx">canvasCtx</span><span class="p">.</span><span class="nx">createImageData</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>



    <span class="k">for</span> <span class="p">(</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">tPxl</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">bPxl</span><span class="p">;</span> <span class="nx">y</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">lPxl</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">rPxl</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span><span class="p">,</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">pxl</span> <span class="o">=</span> <span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="o">/</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="o">/</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
        <span class="nx">imgData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="nx">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nx">pxl</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="nx">imgData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pxl</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="nx">imgData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pxl</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
        <span class="nx">imgData</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="nx">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pxl</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">canvasCtx</span><span class="p">.</span><span class="nx">putImageData</span><span class="p">(</span><span class="nx">imgData</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

    <span class="nx">svgImage</span><span class="p">.</span><span class="nx">setAttributeNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/1999/xlink&#39;</span><span class="p">,</span> <span class="s1">&#39;xlink:href&#39;</span><span class="p">,</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">toDataURL</span><span class="p">());</span>

    <span class="nx">svgContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">svgImage</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">svgContainer</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;pixel&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">f</span><span class="p">,</span>
        <span class="nx">t</span><span class="o">:</span> <span class="nx">t</span><span class="p">,</span>
        <span class="nx">r</span><span class="o">:</span> <span class="nx">r</span><span class="p">,</span>
        <span class="nx">b</span><span class="o">:</span> <span class="nx">b</span><span class="p">,</span>
        <span class="nx">l</span><span class="o">:</span> <span class="nx">l</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-138">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-138">&#182;</a>               </div>               <h3>SVG pixel</h3>

<p>Draws pixel on the screen.</p>

<p><em>@param {path}</em> The path to be drawn <br />
<em>@param {top}</em> The top coordinate of the draw rectangle <br />
<em>@param {right}</em> The right coordinate of the draw rectangle <br />
<em>@param {bottom}</em> The bottom coordinate of the draw rectangle <br />
<em>@param {left}</em> The left coordinate of the draw rectangle <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">point</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">point</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">dist</span><span class="p">,</span>
        <span class="nx">svgPoint</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span> <span class="s1">&#39;circle&#39;</span><span class="p">);</span>

    <span class="nx">svgPoint</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="nx">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nx">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nx">svgPoint</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;cy&#39;</span><span class="p">,</span> <span class="nx">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nx">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nx">svgPoint</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">size</span> <span class="o">||</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>


    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">svgPoint</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke-width&#39;</span><span class="p">,</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;fillOpacity&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">opts</span><span class="p">[</span><span class="s1">&#39;fill-opacity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;fillColor&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="s1">&#39;color&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">opts</span><span class="p">[</span><span class="s1">&#39;fill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">for</span> <span class="p">(</span><span class="nx">prop</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">svgPoint</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">[</span><span class="nx">prop</span><span class="p">]);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">moveable</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">svgPoint</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;cursor&#39;</span><span class="p">,</span> <span class="s1">&#39;move&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-139">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-139">&#182;</a>               </div>               <h3>SVG point</h3>

<p>Draws a point on the screen.</p>

<p><em>@param {point}</em> The point to be drawn <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">svgPoint</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;mousedown&#39;</span><span class="p">,</span> 
        <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="nx">screen</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;move&#39;</span><span class="p">;</span>
          <span class="kd">var</span> <span class="nx">invTransformation</span> <span class="o">=</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">.</span><span class="nx">inverse</span><span class="p">();</span>

          <span class="kd">var</span> <span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">evt</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>

                <span class="kd">var</span> <span class="nx">evtPoint</span> <span class="o">=</span> <span class="nx">invTransformation</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">getEventPoint</span><span class="p">(</span><span class="nx">evt</span><span class="p">));</span>
                <span class="nx">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">evtPoint</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                <span class="nx">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">evtPoint</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
                <span class="nx">screen</span><span class="p">.</span><span class="nx">draw</span><span class="p">()</span>
              <span class="p">},</span>

              <span class="nx">up</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">screen</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

                <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;mousemove&#39;</span><span class="p">,</span> <span class="nx">move</span><span class="p">);</span>
                <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;mouseup&#39;</span><span class="p">,</span> <span class="nx">up</span><span class="p">);</span>
              <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-140">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-140">&#182;</a>               </div>               <p>mousedown</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;mousemove&#39;</span><span class="p">,</span> <span class="nx">move</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-141">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-141">&#182;</a>               </div>               <p>mousemove</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;mouseup&#39;</span><span class="p">,</span> <span class="nx">up</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">);</span>
    <span class="p">}</span>


    <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">svgPoint</span><span class="p">);</span>


    <span class="k">if</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">label</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">dist</span> <span class="o">=</span> <span class="mf">1.75</span> <span class="o">*</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">size</span> <span class="o">||</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">lineWidth</span> <span class="o">||</span> <span class="mi">4</span><span class="p">);</span>
      <span class="nx">screen</span><span class="p">.</span><span class="nx">text</span><span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">label</span><span class="p">,</span>
        <span class="nx">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nx">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="nx">dist</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span>
        <span class="nx">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nx">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="nx">dist</span><span class="o">/</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">),</span> <span class="p">{},</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="nx">svgPoint</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;contextmenu&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">screen</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;contextmenu&#39;</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">svgPoint</span><span class="p">).</span><span class="nx">cx</span><span class="p">.</span><span class="nx">baseVal</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
          <span class="nx">y</span> <span class="o">=</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">svgPoint</span><span class="p">).</span><span class="nx">cy</span><span class="p">.</span><span class="nx">baseVal</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

      <span class="nx">screen</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> 
        <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem MathLib_temporaryMenuItem MathLib_is_disabled MathLib_is_centered&quot;&gt;Point&lt;/div&gt;&#39;</span> <span class="o">+</span>
        <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem MathLib_temporaryMenuItem MathLib_hasSubmenu&quot;&gt;Coordinates&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;menu class=&quot;MathLib_menu MathLib_submenu&quot;&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem&quot;&gt;cartesian: &lt;span class=&quot;MathLib_is_selectable MathLib_is_right&quot;&gt;(&#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">y</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&lt;/span&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem&quot;&gt;polar: &lt;span class=&quot;MathLib_is_selectable MathLib_is_right&quot;&gt;(&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">hypot</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">atan2</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">x</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&lt;/span&gt;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;/menu&gt;&#39;</span> <span class="o">+</span>
        <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>
        <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem MathLib_temporaryMenuItem MathLib_hasSubmenu&quot;&gt;Options&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;menu class=&quot;MathLib_menu MathLib_submenu&quot;&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem&quot;&gt;Moveable:&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;&lt;input type=&quot;checkbox&quot; class=&quot;MathLib_is_right&quot;&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem&quot;&gt;Size:&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;&lt;input type=&quot;spinner&quot; class=&quot;MathLib_is_right&quot;&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem&quot;&gt;Fill color:&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;&lt;input type=&quot;color&quot; class=&quot;MathLib_is_right&quot;&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;div class=&quot;MathLib_menuItem&quot;&gt;Line color:&#39;</span> <span class="o">+</span>
              <span class="s1">&#39;&lt;input type=&quot;color&quot; class=&quot;MathLib_is_right&quot;&gt;&#39;</span> <span class="o">+</span>
            <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;/menu&gt;&#39;</span> <span class="o">+</span>
        <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>
        <span class="s1">&#39;&lt;hr class=&quot;MathLib_separator MathLib_temporaryMenuItem&quot;&gt;&#39;</span> <span class="o">+</span>
        <span class="nx">screen</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
    <span class="p">});</span>


    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;point&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">point</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-142">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-142">&#182;</a>               </div>               <p>mouseup</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">text</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">redraw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">screen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">,</span>
        <span class="nx">svgText</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">),</span>
        <span class="nx">ctx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span>
        <span class="nx">prop</span><span class="p">,</span> <span class="nx">opts</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">tf</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">screen</span><span class="p">.</span><span class="nx">transformation</span><span class="p">;</span>

    <span class="nx">svgText</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">str</span><span class="p">;</span>
    <span class="nx">svgText</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="nx">x</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nx">svgText</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="nx">y</span><span class="o">*</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nx">svgText</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix(&#39;</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="s1">&#39;, 0, 0, &#39;</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="nx">screen</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="s1">&#39;, 0, 0)&#39;</span><span class="p">);</span>
    <span class="nx">svgText</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;font-family&#39;</span><span class="p">,</span> <span class="s1">&#39;Helvetica&#39;</span><span class="p">);</span>
    <span class="nx">svgText</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="nx">colorConvert</span><span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">color</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;#000000&#39;</span><span class="p">);</span>
    <span class="nx">svgText</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;fill-opacity&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">);</span>
    <span class="nx">svgText</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke&#39;</span><span class="p">,</span> <span class="nx">colorConvert</span><span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">color</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;#000000&#39;</span><span class="p">);</span>
    <span class="nx">svgText</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;text-anchor&#39;</span><span class="p">,</span> <span class="s1">&#39;middle&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-143">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-143">&#182;</a>               </div>               <h3>SVG text</h3>

<p>Writes text on the screen.</p>

<p><em>@param {str}</em> The string to be drawn <br />
<em>@param {x}</em> The x coordinate <br />
<em>@param {y}</em> The y coordinate <br />
<em>@param {object}</em> [options] Optional drawing options <br />
<em>@returns {screen}</em> Returns the screen</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">svgText</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;alignment-baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;middle&#39;</span><span class="p">);</span>


    <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">svgText</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">redraw</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">stack</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="nx">str</span><span class="p">,</span>
        <span class="nx">x</span><span class="o">:</span> <span class="nx">x</span><span class="p">,</span>
        <span class="nx">y</span><span class="o">:</span> <span class="nx">y</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-144">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-144">&#182;</a>               </div>               <p>alignment-baseline isn't defined for text elements, 
only for tspan, tref, altGlyph, textPath elements. <br />
see the <a href="http://www.w3.org/TR/SVG/text.html#AlignmentBaselineProperty">Specification</a> <br />
But it works for text elements, so we don't need an additional tspan element.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Screen2D</span> <span class="kr">extends</span> <span class="nx">Screen</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;screen2D&#39;</span><span class="p">;</span>

  <span class="nx">applyTransformation</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">background</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">renderer</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">axis</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">grid</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">layer</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">element</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>

  <span class="nx">init</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">redraw</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">drawAxis</span><span class="o">:</span><span class="nx">any</span><span class="p">;</span>
  <span class="nx">drawGrid</span><span class="o">:</span><span class="nx">any</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-145">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-145">&#182;</a>               </div>               <h2><a id="Screen2D"></a>Screen2D</h2>

<p>Two dimensional plotting</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">draw</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">circle</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">line</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">path</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">pixel</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">point</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">text</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-146">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-146">&#182;</a>               </div>               <p>Drawing functions</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">transformation</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">translation</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">scale</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">lookAt</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">range</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-147">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-147">&#182;</a>               </div>               <p>Transformation</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">interaction</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">zoomSpeed</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>


  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">id</span><span class="o">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">defaults</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">axis</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">color</span><span class="o">:</span> <span class="mh">0x000000</span><span class="p">,</span>
            <span class="nx">textColor</span><span class="o">:</span> <span class="mh">0x000000</span><span class="p">,</span>
            <span class="nx">tick</span><span class="o">:</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
          <span class="p">},</span>
          <span class="nx">grid</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">angle</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span>
            <span class="nx">color</span><span class="o">:</span> <span class="mh">0xcccccc</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;cartesian&#39;</span><span class="p">,</span>
            <span class="nx">tick</span><span class="o">:</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">r</span><span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
          <span class="p">},</span>
          <span class="nx">interaction</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">allowPan</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">allowZoom</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">zoomSpeed</span><span class="o">:</span> <span class="mi">1</span>
          <span class="p">},</span>
          <span class="nx">background</span><span class="o">:</span> <span class="mh">0xffffff</span><span class="p">,</span>
          <span class="nx">lookAt</span><span class="o">:</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">0</span><span class="p">},</span>
          <span class="nx">range</span><span class="o">:</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="nx">figcaption</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
          <span class="nx">renderer</span><span class="o">:</span> <span class="s1">&#39;Canvas&#39;</span><span class="p">,</span>
          <span class="nx">transformation</span><span class="o">:</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">([[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="p">},</span>
        <span class="nx">opts</span> <span class="o">=</span> <span class="nx">extendObject</span><span class="p">(</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">),</span>
        <span class="nx">element</span><span class="p">,</span>
        <span class="nx">transformation</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">transformation</span><span class="p">,</span>
        <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">background</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">interaction</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">axis</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">axis</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">grid</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">grid</span><span class="p">;</span>


  
    <span class="k">this</span><span class="p">.</span><span class="nx">applyTransformation</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-148">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-148">&#182;</a>               </div>               <p>Interaction TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">translation</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scale</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">transformation</span> <span class="o">=</span> <span class="nx">transformation</span><span class="p">;</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){</span><span class="k">return</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">];},</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">){</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();}</span>
    <span class="p">});</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){</span><span class="k">return</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">];},</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">){</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();}</span>
    <span class="p">});</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){</span><span class="k">return</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];},</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">){</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();}</span>
    <span class="p">});</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){</span><span class="k">return</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">];},</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">){</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();}</span>
    <span class="p">});</span>





    <span class="k">this</span><span class="p">.</span><span class="nx">lookAt</span><span class="o">=</span> <span class="p">{};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">range</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){</span><span class="k">return</span> <span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];},</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">){</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="nx">x</span><span class="o">*</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();}</span>
    <span class="p">});</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){</span><span class="k">return</span> <span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">];},</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">){</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="nx">y</span><span class="o">*</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();}</span>
    <span class="p">});</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){</span><span class="k">return</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]);},</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">){</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nx">_this</span><span class="p">.</span><span class="nx">width</span><span class="o">/</span><span class="nx">x</span><span class="p">;</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();}</span>
    <span class="p">});</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){</span><span class="k">return</span> <span class="o">-</span><span class="nx">_this</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]);},</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">){</span><span class="nx">_this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="nx">_this</span><span class="p">.</span><span class="nx">height</span><span class="o">/</span><span class="nx">y</span><span class="p">;</span> <span class="nx">_this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();}</span>
    <span class="p">});</span>



    <span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">x</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">range</span><span class="p">.</span><span class="nx">y</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">.</span><span class="nx">x</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">.</span><span class="nx">y</span></pre></div>             </td>           </tr>                               <tr id="section-149">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-149">&#182;</a>               </div>               <p>The interaction methods</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;SVG&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-150">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-150">&#182;</a>               </div>               <p>Create the SVG element which contains the layers</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span> <span class="s1">&#39;svg&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;MathLib_screen&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;xmlns&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;xmlns:xlink&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.w3.org/1999/xlink&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;1.1&#39;</span><span class="p">);</span>

      <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;#000000&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;stroke-opacity&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;#ffffff&#39;</span><span class="p">);</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;fill-opacity&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">);</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">element</span> <span class="o">=</span> <span class="nx">element</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;background&#39;</span> <span class="k">in</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">background</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="s1">&#39;http://www.w3.org/2000/svg&#39;</span><span class="p">,</span><span class="s1">&#39;rect&#39;</span><span class="p">);</span>

        <span class="nx">background</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;0px&#39;</span><span class="p">);</span>
        <span class="nx">background</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;0px&#39;</span><span class="p">);</span>
        <span class="nx">background</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">);</span>
        <span class="nx">background</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">);</span>
        <span class="nx">background</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="nx">colorConvert</span><span class="p">((</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="nx">options</span><span class="p">).</span><span class="nx">background</span><span class="p">));</span>
        <span class="nx">background</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;fill-opacity&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">background</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-151">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-151">&#182;</a>               </div>               <p>Create the canvas</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">back</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Layer</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;back&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">grid</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Layer</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">axis</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Layer</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Layer</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>


    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;Canvas&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">onmouseup</span>      <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmouseup</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">onmousedown</span>    <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmousedown</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">onmousemove</span>    <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmousemove</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">onmousewheel</span>   <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmousewheel</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-152">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-152">&#182;</a>               </div>               <h1>Create the Layers</h1>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">DOMMouseScroll</span> <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmousewheel</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span> 
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;SVG&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">onmouseup</span>      <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmouseup</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">onmousedown</span>    <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmousedown</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">onmousemove</span>    <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmousemove</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">onmousewheel</span>   <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmousewheel</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">DOMMouseScroll</span> <span class="o">=</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">onmousewheel</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-153">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-153">&#182;</a>               </div>               <p>For Firefox: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=111647">Bug report for the missing onmousewheel method</a></p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;Canvas&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">applyTransformation</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">;</span>

      
      <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{}){</span>
        <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">top</span>     <span class="o">=</span> <span class="p">(</span>            <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
              <span class="nx">bottom</span>  <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
              <span class="nx">left</span>    <span class="o">=</span> <span class="p">(</span>            <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
              <span class="nx">right</span>   <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-154">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-154">&#182;</a>               </div>               <h1>The canvas renderer</h1>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">l</span><span class="p">){</span><span class="nx">l</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">clearRect</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">top</span><span class="p">,</span> <span class="nx">right</span><span class="o">-</span><span class="nx">left</span><span class="p">,</span> <span class="nx">bottom</span><span class="o">-</span><span class="nx">top</span><span class="p">)})</span>

          <span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">){</span><span class="nx">x</span><span class="p">.</span><span class="nx">draw</span><span class="p">();})</span>
        <span class="p">}</span>


        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;circle&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">circle</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">x</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span><span class="nx">_this</span><span class="p">[</span><span class="nx">y</span><span class="p">.</span><span class="nx">type</span><span class="p">](</span><span class="nx">y</span><span class="p">,</span> <span class="nx">options</span><span class="p">);});</span>
        <span class="p">}</span>
      <span class="p">}</span>


      <span class="k">this</span><span class="p">.</span><span class="nx">circle</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">circle</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">line</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span></pre></div>             </td>           </tr>                               <tr id="section-155">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-155">&#182;</a>               </div>               <p>Clear the canvas</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">pixel</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">pixel</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">point</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">point</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-156">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-156">&#182;</a>               </div>               <p>Should the pixel method default to the main layer or to the back layer?</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;SVG&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">applyTransformation</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">;</span>
   
      <span class="k">this</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{}){</span>
        <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-157">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-157">&#182;</a>               </div>               <h1>The SVG renderer</h1>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">l</span><span class="p">){</span>
            <span class="nx">l</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
          <span class="p">});</span>

          <span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">){</span><span class="nx">x</span><span class="p">.</span><span class="nx">draw</span><span class="p">();})</span>
        <span class="p">}</span>


        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;circle&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">circle</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">x</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span><span class="nx">_this</span><span class="p">[</span><span class="nx">y</span><span class="p">.</span><span class="nx">type</span><span class="p">](</span><span class="nx">y</span><span class="p">,</span> <span class="nx">options</span><span class="p">);});</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">circle</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">circle</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">line</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">line</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span></pre></div>             </td>           </tr>                               <tr id="section-158">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-158">&#182;</a>               </div>               <p>Clear the layer</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">pixel</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">pixel</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">point</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">point</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);};</span>

    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;MathLib_screen2D&#39;</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">gridType</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">type</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">type</span> <span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">contextMenu</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.MathLib_grid_type[value=&#39;</span> <span class="o">+</span> <span class="nx">gridType</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">checked</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>


    <span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-159">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-159">&#182;</a>               </div>               <p>Should the pixel method default to the main layer or to the back layer?</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">resize</span><span class="p">(</span><span class="nx">width</span> <span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">height</span> <span class="o">:</span> <span class="nx">number</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Screen2D</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>


  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;Canvas&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">back</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">back</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">back</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s1">&#39;rgba(255, 255, 255, 0)&#39;</span><span class="p">;</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s1">&#39;rgba(255, 255, 255, 0)&#39;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeStyle</span> <span class="o">=</span> <span class="nx">colorConvert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">color</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;#cccccc&#39;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">axis</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">axis</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">axis</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s1">&#39;rgba(255, 255, 255, 0)&#39;</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s1">&#39;rgba(255, 255, 255, 0)&#39;</span><span class="p">;</span>
  <span class="p">}</span>


  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">===</span> <span class="s1">&#39;SVG&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nx">width</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">height</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-160">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-160">&#182;</a>               </div>               <h3>Screen2D.prototype.resize()</h3>

<p>Adjust the rendering if the screen is resized</p>

<p><em>@param {number}</em> The new width <br />
<em>@param {number}</em> The new height <br />
<em>@returns {Screen2D}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">getEventPoint</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">offsetX</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">x</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">offsetX</span><span class="p">;</span>
    <span class="nx">y</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">offsetY</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">x</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">layerX</span><span class="p">;</span>
    <span class="nx">y</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">layerY</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Point</span><span class="p">([</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-161">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-161">&#182;</a>               </div>               <h3>Screen.prototype.getEventPoint</h3>

<p>Creates a point based on the coordinates of an event.</p>

<p><em>@param {event}</em> <br />
<em>@returns {point}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">getLineEndPoints</span> <span class="p">(</span><span class="nx">l</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">l</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> 
        <span class="nx">top</span>    <span class="o">=</span> <span class="p">(</span>            <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">bottom</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
        <span class="nx">left</span>   <span class="o">=</span> <span class="p">(</span>            <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">right</span>  <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
        <span class="nx">lineRight</span>  <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="nx">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nx">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="nx">right</span><span class="p">)</span>  <span class="o">/</span> <span class="nx">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="nx">lineTop</span>    <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="nx">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nx">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span> <span class="nx">top</span><span class="p">)</span>    <span class="o">/</span> <span class="nx">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="nx">lineLeft</span>   <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="nx">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nx">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="nx">left</span><span class="p">)</span>   <span class="o">/</span> <span class="nx">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="nx">lineBottom</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="nx">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nx">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span> <span class="nx">bottom</span><span class="p">)</span> <span class="o">/</span> <span class="nx">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="nx">res</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">lineRight</span><span class="o">&lt;=</span><span class="nx">top</span> <span class="o">&amp;&amp;</span> <span class="nx">lineRight</span><span class="o">&gt;=</span><span class="nx">bottom</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">right</span><span class="p">,</span> <span class="nx">lineRight</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">lineLeft</span><span class="o">&lt;=</span><span class="nx">top</span> <span class="o">&amp;&amp;</span> <span class="nx">lineLeft</span><span class="o">&gt;=</span><span class="nx">bottom</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">left</span><span class="p">,</span> <span class="nx">lineLeft</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">lineTop</span><span class="o">&lt;</span><span class="nx">right</span> <span class="o">&amp;&amp;</span> <span class="nx">lineTop</span><span class="o">&gt;</span><span class="nx">left</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">lineTop</span><span class="p">,</span> <span class="nx">top</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">lineBottom</span><span class="o">&lt;</span><span class="nx">right</span> <span class="o">&amp;&amp;</span> <span class="nx">lineBottom</span><span class="o">&gt;</span><span class="nx">left</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">lineBottom</span><span class="p">,</span> <span class="nx">bottom</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">l</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-162">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-162">&#182;</a>               </div>               <h3>Screen2D.prototype.getineEndPoint()</h3>

<p>Calculates the both endpoints for the line
for drawing purposes</p>

<p><em>@param {line|array}</em> <br />
<em>@returns {array}</em> The array has the format [[x1, y1], [x2, y2]]</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">onmousedown</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-163">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-163">&#182;</a>               </div>               <h3>Screen.prototype.onmousedown()</h3>

<p>Handles the mousedown event</p>

<p><em>@param {event}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">button</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>


  <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">evt</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-164">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-164">&#182;</a>               </div>               <p>Only start the action if the left mouse button was clicked</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">allowPan</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;pan&#39;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">startPoint</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getEventPoint</span><span class="p">(</span><span class="nx">evt</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">startTransformation</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">.</span><span class="nx">copy</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-165">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-165">&#182;</a>               </div>               <p>Pan mode</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">onmousemove</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">evt</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  </pre></div>             </td>           </tr>                               <tr id="section-166">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-166">&#182;</a>               </div>               <h3>Screen.prototype.onmousemove()</h3>

<p>Handles the mousemove event</p>

<p><em>@param {event}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;pan&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getEventPoint</span><span class="p">(</span><span class="nx">evt</span><span class="p">).</span><span class="nx">minus</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">startPoint</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">startTransformation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">translation</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">startTransformation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-167">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-167">&#182;</a>               </div>               <p>Pan mode</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">onmouseup</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">evt</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-168">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-168">&#182;</a>               </div>               <h3>Screen.prototype.onmouseup()</h3>

<p>Handles the mouseup event</p>

<p><em>@param {event}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;pan&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">type</span><span class="p">;</span>
    <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">startPoint</span><span class="p">;</span>
    <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">startTransformation</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-169">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-169">&#182;</a>               </div>               <p>Go back to normal mode</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">onmousewheel</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">delta</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">z</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">allowZoom</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nx">evt</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-170">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-170">&#182;</a>               </div>               <h3>Screen.prototype.onmousewheel()</h3>

<p>Handles the mousewheel event</p>

<p><em>@param {event}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">wheelDelta</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">delta</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">wheelDelta</span> <span class="o">/</span> <span class="mi">360</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-171">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-171">&#182;</a>               </div>               <p>Chrome/Safari</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">delta</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">detail</span> <span class="o">/</span> <span class="o">-</span><span class="mi">9</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-172">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-172">&#182;</a>               </div>               <p>Firefox</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">z</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">zoomSpeed</span><span class="p">,</span> <span class="nx">delta</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-173">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-173">&#182;</a>               </div>               <p>The amount of zoom is determined by the zoom speed
and the amount how much the scrollwheel has been moved</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">.</span><span class="nx">inverse</span><span class="p">().</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getEventPoint</span><span class="p">(</span><span class="nx">evt</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-174">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-174">&#182;</a>               </div>               <p>Transform the (computer-)screen coordinates of the mouse to the internal coordinates</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">s</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">([[</span><span class="nx">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">z</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nx">z</span><span class="p">,</span> <span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">z</span> <span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">transformation</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">transformation</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>


    <span class="k">this</span><span class="p">.</span><span class="nx">applyTransformation</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">();</span>

  <span class="p">}</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-175">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-175">&#182;</a>               </div>               <p>Compute new scale matrix in current mouse position</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Screen3D</span> <span class="kr">extends</span> <span class="nx">Screen</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;screen3D&#39;</span><span class="p">;</span>
 
  <span class="nx">grid</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">axis</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">render</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">camera</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">element</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>
  <span class="nx">scene</span><span class="o">:</span> <span class="nx">any</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">id</span><span class="o">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">defaults</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">anaglyphMode</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="nx">axis</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">background</span><span class="o">:</span> <span class="mh">0xffffff</span><span class="p">,</span>
          <span class="nx">camera</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">lookAt</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="nx">position</span><span class="o">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
          <span class="p">},</span>
          <span class="nx">controls</span><span class="o">:</span> <span class="s1">&#39;Trackball&#39;</span><span class="p">,</span>
          <span class="nx">grid</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">xy</span><span class="o">:</span> <span class="p">{</span>
              <span class="nx">angle</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span>
              <span class="nx">color</span><span class="o">:</span> <span class="mh">0xcccccc</span><span class="p">,</span>
              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
              <span class="nx">tick</span><span class="o">:</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">r</span><span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">xz</span><span class="o">:</span> <span class="p">{</span>
              <span class="nx">angle</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span>
              <span class="nx">color</span><span class="o">:</span> <span class="mh">0xcccccc</span><span class="p">,</span>
              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
              <span class="nx">tick</span><span class="o">:</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">r</span><span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">yz</span><span class="o">:</span> <span class="p">{</span>
              <span class="nx">angle</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span>
              <span class="nx">color</span><span class="o">:</span> <span class="mh">0xcccccc</span><span class="p">,</span>
              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
              <span class="nx">tick</span><span class="o">:</span> <span class="p">{</span><span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">r</span><span class="o">:</span> <span class="mi">1</span><span class="p">}</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="nx">height</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
          <span class="nx">renderer</span><span class="o">:</span> <span class="s1">&#39;WebGL&#39;</span><span class="p">,</span>
          <span class="nx">width</span><span class="o">:</span> <span class="mi">500</span>
        <span class="p">},</span>
        <span class="nx">opts</span> <span class="o">=</span> <span class="nx">extendObject</span><span class="p">(</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">),</span>
        <span class="nx">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Scene</span><span class="p">(),</span></pre></div>             </td>           </tr>                               <tr id="section-176">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-176">&#182;</a>               </div>               <h2><a id="Screen3D"></a>Screen3D</h2>

<p>Two dimensional plotting</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">camera</span><span class="p">,</span> <span class="nx">renderer</span><span class="p">,</span> <span class="nx">controls</span><span class="p">,</span> <span class="nx">viewAngle</span><span class="p">,</span> <span class="nx">aspect</span><span class="p">,</span> <span class="nx">near</span><span class="p">,</span> <span class="nx">far</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">scene</span> <span class="o">=</span> <span class="nx">scene</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">axis</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">axis</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">grid</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">grid</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-177">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-177">&#182;</a>               </div>               <p>clock = new THREE.Clock(),</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">viewAngle</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
    <span class="nx">aspect</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">width</span> <span class="o">/</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
    <span class="nx">near</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="nx">far</span> <span class="o">=</span> <span class="mi">20000</span><span class="p">;</span>

    <span class="nx">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="nx">viewAngle</span><span class="p">,</span> <span class="nx">aspect</span><span class="p">,</span> <span class="nx">near</span><span class="p">,</span> <span class="nx">far</span><span class="p">);</span>
    <span class="nx">camera</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">to3js</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">);</span>
    <span class="nx">camera</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">(</span><span class="nx">to3js</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">));</span>
    <span class="nx">camera</span><span class="p">.</span><span class="nx">up</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">camera</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-178">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-178">&#182;</a>               </div>               <h1>Camera</h1>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">[</span><span class="nx">opts</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">+</span> <span class="s1">&#39;Renderer&#39;</span><span class="p">](</span> <span class="p">{</span><span class="nx">antialias</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span> <span class="nx">preserveDrawingBuffer</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-179">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-179">&#182;</a>               </div>               <h1>Renderer</h1>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">origRenderer</span> <span class="o">=</span> <span class="nx">renderer</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-180">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-180">&#182;</a>               </div>               <p>Storing the the original renderer to recover it easily when leaving anaglyph mode</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">anaglyphMode</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">AnaglyphEffect</span><span class="p">(</span><span class="nx">renderer</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">renderer</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-181">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-181">&#182;</a>               </div>               <p>Overwrite the renderer with the anaglyph mode renderer</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-182">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-182">&#182;</a>               </div>               <h1>Controls</h1>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">controls</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">controls</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">[</span><span class="nx">opts</span><span class="p">.</span><span class="nx">controls</span><span class="o">+</span><span class="s1">&#39;Controls&#39;</span><span class="p">](</span><span class="nx">camera</span><span class="p">,</span> <span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-183">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-183">&#182;</a>               </div>               <p>Other possible values are: 'FirstPerson', 'Fly', 'Orbit', 'Path', 'Roll', 'Trackback' or false
MathLib defaults to the TrackballControls
move mouse and left   click (or hold 'A') to rotate
               middle click (or hold 'S') to zoom
               right  click (or hold 'D') to pan</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">controls</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">update</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(){}</span>
      <span class="p">};</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-184">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-184">&#182;</a>               </div>               <p>A update function for the controls doing nothing.
The function is called in the update function.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">light1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PointLight</span><span class="p">(</span><span class="mh">0xffffff</span><span class="p">);</span>
    <span class="nx">light1</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span>
    <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">light1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">light2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PointLight</span><span class="p">(</span><span class="mh">0xffffff</span><span class="p">);</span>
    <span class="nx">light2</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">200</span><span class="p">);</span>
    <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">light2</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-185">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-185">&#182;</a>               </div>               <h1>Light</h1>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">renderer</span><span class="p">.</span><span class="nx">setClearColorHex</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">background</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="nx">renderer</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-186">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-186">&#182;</a>               </div>               <h1>Background</h1>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">drawGrid</span><span class="p">();</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-187">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-187">&#182;</a>               </div>               <h1>Grid</h1>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">axis</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">axis</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">AxisHelper</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">axis</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-188">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-188">&#182;</a>               </div>               <h1>Axis</h1>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">animate</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">);</span>
      <span class="nx">render</span><span class="p">();</span>
      <span class="nx">update</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-189">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-189">&#182;</a>               </div>               <h1>Animate the scene</h1>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">controls</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-190">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-190">&#182;</a>               </div>               <p>var delta = clock.getDelta();</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">scene</span><span class="p">,</span> <span class="nx">camera</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-191">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-191">&#182;</a>               </div>               <p>Render the scene</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">animate</span><span class="p">();</span>


    <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">element</span> <span class="o">=</span> <span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">renderer</span> <span class="o">=</span> <span class="nx">renderer</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">camera</span> <span class="o">=</span> <span class="nx">camera</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;MathLib_screen3D&#39;</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-192">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-192">&#182;</a>               </div>               <p>kick of the animation loop</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">drawGrid</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
      <span class="nx">gridDrawer</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">rotX</span><span class="p">,</span> <span class="nx">rotY</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="nx">grid</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Object3D</span><span class="p">(),</span>
            <span class="nx">color</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">color</span><span class="p">),</span>
            <span class="nx">i</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;cartesian&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">tickX</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">tick</span> <span class="o">?</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">tick</span><span class="p">.</span><span class="nx">x</span> <span class="o">:</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">tick</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
              <span class="nx">tickY</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span> <span class="k">in</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">tick</span> <span class="o">?</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">tick</span><span class="p">.</span><span class="nx">z</span> <span class="o">:</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">tick</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
              <span class="nx">lines</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Shape</span><span class="p">();</span>

          <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="nx">size</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">size</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">tickX</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lines</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="o">-</span><span class="nx">size</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
            <span class="nx">lines</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">size</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
          <span class="p">}</span>   

          <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="nx">size</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">size</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">tickY</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lines</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="o">-</span><span class="nx">size</span><span class="p">);</span>
            <span class="nx">lines</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">size</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="nx">grid</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Line</span><span class="p">(</span><span class="nx">lines</span><span class="p">.</span><span class="nx">createPointsGeometry</span><span class="p">(),</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">LineBasicMaterial</span><span class="p">({</span><span class="nx">color</span><span class="o">:</span> <span class="nx">color</span><span class="p">}),</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">LinePieces</span><span class="p">));</span>

          <span class="nx">grid</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">rotX</span><span class="p">;</span>
          <span class="nx">grid</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">rotY</span><span class="p">;</span>

          <span class="nx">_this</span><span class="p">.</span><span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">grid</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;polar&#39;</span><span class="p">)</span> <span class="p">{</span>

          <span class="kd">var</span> <span class="nx">circles</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Shape</span><span class="p">(),</span>
              <span class="nx">rays</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Shape</span><span class="p">(),</span>
              <span class="nx">line</span><span class="p">;</span>


          <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">size</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">tick</span><span class="p">.</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">circles</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="nx">circles</span><span class="p">.</span><span class="nx">absarc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="nx">grid</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Line</span><span class="p">(</span><span class="nx">circles</span><span class="p">.</span><span class="nx">createPointsGeometry</span><span class="p">(),</span>
                      <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">LineBasicMaterial</span><span class="p">({</span><span class="nx">color</span><span class="o">:</span> <span class="nx">color</span><span class="p">})));</span>

          <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">angle</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">rays</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
            <span class="nx">rays</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">size</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span> <span class="nx">size</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
          <span class="p">}</span>

          <span class="nx">grid</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Line</span><span class="p">(</span><span class="nx">rays</span><span class="p">.</span><span class="nx">createPointsGeometry</span><span class="p">(),</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">LineBasicMaterial</span><span class="p">({</span><span class="nx">color</span><span class="o">:</span> <span class="nx">color</span><span class="p">})));</span>

          <span class="nx">grid</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">rotX</span><span class="p">;</span>
          <span class="nx">grid</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">rotY</span><span class="p">;</span>

          <span class="nx">_this</span><span class="p">.</span><span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">grid</span><span class="p">);</span>

        <span class="p">}</span>
      <span class="p">};</span>


  <span class="nx">gridDrawer</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">xy</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="nx">gridDrawer</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">xz</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="nx">gridDrawer</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">yz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-193">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-193">&#182;</a>               </div>               <h3>Screen3D.prototype.drawGrid</h3>

<p>Draws the grid.</p>

<p><em>@returns {Screen3D}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">parametricPlot3D</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Screen3D</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">closed</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">debug</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">min</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">max</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">pointNum</span><span class="o">:</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="nx">radius</span><span class="o">:</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="nx">segmentsRadius</span><span class="o">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="nx">material</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;MeshLambert&#39;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">extendObject</span><span class="p">(</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">),</span>


      <span class="nx">curve</span> <span class="o">=</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Curve</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
        <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">t</span> <span class="o">=</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">max</span> <span class="o">-</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">min</span><span class="p">)</span> <span class="o">*</span> <span class="nx">t</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">min</span><span class="p">;</span>
          <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">f</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="nx">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
        <span class="p">}</span>
      <span class="p">),</span>
    

      <span class="nx">mesh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">TubeGeometry</span><span class="p">(</span><span class="k">new</span> <span class="nx">curve</span><span class="p">(),</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">pointNum</span><span class="p">,</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">radius</span><span class="p">,</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">segmentsRadius</span><span class="p">,</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">closed</span><span class="p">,</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">debug</span><span class="p">),</span>
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">[</span><span class="nx">opts</span><span class="p">.</span><span class="nx">material</span><span class="p">.</span><span class="nx">type</span> <span class="o">+</span> <span class="s1">&#39;Material&#39;</span><span class="p">](</span><span class="nx">opts</span><span class="p">.</span><span class="nx">material</span><span class="p">)</span>
      <span class="p">);</span>


  <span class="k">this</span><span class="p">.</span><span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">mesh</span><span class="p">);</span>


  <span class="cm">/*</span>
<span class="cm">  guiObj = {</span>
<span class="cm">    color: [mesh.material.color.r, mesh.material.color.g, mesh.material.color.b]</span>
<span class="cm">  };</span>


<span class="cm">  var folder = _3D.datGUI.addFolder(options.name);</span>
<span class="cm">  folder.add(mesh, &#39;visible&#39;);</span>
<span class="cm">  folder.addColor(guiObj, &#39;color&#39;)</span>
<span class="cm">    .onChange(function(value){mesh.material.color.setRGB(value[0]/255, value[1]/255, value[2]/255);});</span>
<span class="cm">  */</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-194">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-194">&#182;</a>               </div>               <h3>Matrix.parametricPlot3D()</h3>

<p><em>@param {function}</em> The function which is called on every argument <br />
<em>@returns {screen3D}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">plot3D</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Screen3D</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">surfacePlot3D</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">u</span><span class="p">,</span> <span class="nx">v</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">[</span><span class="nx">u</span><span class="p">,</span><span class="nx">v</span><span class="p">,</span><span class="nx">f</span><span class="p">(</span><span class="nx">u</span><span class="p">,</span><span class="nx">v</span><span class="p">)];</span>
  <span class="p">},</span>
  <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-195">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-195">&#182;</a>               </div>               <h3>Screen3D.prototype.plot3D()</h3>

<p><em>@param {function}</em> The map for the height <br />
<em>@param {object}</em> Options <br />
<em>@returns {screen3D}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">resize</span><span class="p">(</span><span class="nx">width</span> <span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">height</span> <span class="o">:</span> <span class="nx">number</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Screen3D</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">renderer</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">aspect</span> <span class="o">=</span> <span class="nx">width</span> <span class="o">/</span> <span class="nx">height</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">updateProjectionMatrix</span><span class="p">();</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-196">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-196">&#182;</a>               </div>               <h3>Screen3D.prototype.resize()</h3>

<p>Adjust the rendering if the screen is resized</p>

<p><em>@param {number}</em> The new width <br />
<em>@param {number}</em> The new height <br />
<em>@returns {Screen3D}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">surfacePlot3D</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Screen3D</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">material</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;MeshLambert&#39;</span>
        <span class="p">},</span>
        <span class="nx">pointNumX</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="nx">pointNumY</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="nx">xmin</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">xmax</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">ymin</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">ymax</span><span class="o">:</span> <span class="mi">1</span>
      <span class="p">},</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="nx">extendObject</span><span class="p">(</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">),</span>
      <span class="nx">map</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">u</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">u</span> <span class="o">=</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">xmax</span> <span class="o">-</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">xmin</span><span class="p">)</span> <span class="o">*</span> <span class="nx">u</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">xmin</span><span class="p">;</span>
        <span class="nx">v</span> <span class="o">=</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">ymax</span> <span class="o">-</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">ymin</span><span class="p">)</span> <span class="o">*</span> <span class="nx">v</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">ymin</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">f</span><span class="p">(</span><span class="nx">u</span><span class="p">,</span> <span class="nx">v</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="nx">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
      <span class="p">},</span>
      <span class="nx">material</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">[</span><span class="nx">opts</span><span class="p">.</span><span class="nx">material</span><span class="p">.</span><span class="nx">type</span> <span class="o">+</span> <span class="s1">&#39;Material&#39;</span><span class="p">](</span><span class="nx">opts</span><span class="p">.</span><span class="nx">material</span><span class="p">),</span>
      <span class="nx">mesh</span><span class="p">;</span>

      <span class="nx">material</span><span class="p">.</span><span class="nx">side</span> <span class="o">=</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">DoubleSide</span><span class="p">;</span>

      <span class="nx">mesh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">ParametricGeometry</span><span class="p">(</span><span class="nx">map</span><span class="p">,</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">pointNumX</span><span class="p">,</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">pointNumY</span><span class="p">,</span> <span class="kc">false</span><span class="p">),</span>
        <span class="nx">material</span>
      <span class="p">);</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">mesh</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-197">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-197">&#182;</a>               </div>               <h3>screen3D.prototype.surfacePlot()</h3>

<p><em>@param {function}</em> The map for the surface <br />
<em>@param {object}</em> Options <br />
<em>@returns {screen3D}</em></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-198">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-198">&#182;</a>               </div>               <p>if (options.datGUI) {
  guiObj = {
    color: [mesh.material.color.r, mesh.material.color.g, mesh.material.color.b]
  };</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-199">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-199">&#182;</a>               </div>               <p>var folder = _3D.datGUI.addFolder(options.datGUI.name);
  if (options.datGUI.visible) {
    folder.add(mesh, 'visible');
  }</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-200">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-200">&#182;</a>               </div>               <p>if (options.datGUI.wireframe) {
    folder.add(mesh.material, 'wireframe');
  }</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-201">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-201">&#182;</a>               </div>               <p>if (options.datGUI.color) {
    color = mesh.material.color.getHex();
    var guiObj = {
      color: color
    };</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-202">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-202">&#182;</a>               </div>               <pre><code>folder.addColor(guiObj, 'color').name('color')
  .onChange(function(value){mesh.material.color = new THREE.Color(value);});
</code></pre>

<p>}
}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Vector</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;vector&#39;</span><span class="p">;</span>

  <span class="nx">length</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">coords</span><span class="o">:</span> <span class="nx">number</span><span class="p">[])</span> <span class="p">{</span>
    <span class="nx">coords</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">x</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">coords</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-203">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-203">&#182;</a>               </div>               <h2><a id="Vector" href="http://mathlib.de/en/docs/Vector">Vector</a></h2>

<p>The vector implementation of MathLib makes calculations with vectors of
arbitrary size possible. The entries of the vector can be numbers and complex
numbers.</p>

<p>It is as easy as
<code>new MathLib.Vector([1, 2, 3])</code>
to create the following vector: <br />
    1  <br />
    2  <br />
    3 </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">areLinearIndependent</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">v</span> <span class="o">:</span> <span class="nx">Vector</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="nx">m</span> <span class="o">=</span> <span class="nx">v</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&gt;</span> <span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">v</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">m</span><span class="p">;</span>
    <span class="p">})</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">v</span><span class="p">)).</span><span class="nx">rank</span><span class="p">()</span> <span class="o">===</span> <span class="nx">n</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-204">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-204">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/areLinearIndependent">Vector.prototype.areLinearIndependent()</a></h3>

<p>Checks if the vectors are linear independent.</p>

<p><em>@param {array}</em> An array containing the vectors. <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">every</span><span class="p">(</span><span class="nx">f</span> <span class="o">:</span> <span class="p">(</span><span class="nx">value</span> <span class="o">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">index</span> <span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">vector</span> <span class="o">:</span> <span class="nx">Vector</span> <span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">bool</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">every</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">f</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-205">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-205">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/every">Vector.prototype.every()</a></h3>

<p>Works like Array.prototype.every.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">forEach</span><span class="p">(</span><span class="nx">f</span> <span class="o">:</span> <span class="p">(</span><span class="nx">value</span> <span class="o">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">index</span> <span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">vector</span> <span class="o">:</span> <span class="nx">Vector</span> <span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">)</span> <span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
  <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">forEach</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">f</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-206">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-206">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/forEach">Vector.prototype.forEach()</a></h3>

<p>Works like Array.prototype.forEach.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEqual</span><span class="p">(</span><span class="nx">v</span> <span class="o">:</span> <span class="nx">Vector</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">v</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-207">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-207">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/isEqual">Vector.prototype.isEqual()</a></h3>

<p>Determines if two vectors are equal</p>

<p><em>@param {Vector}</em> v The vector to compare <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isZero</span><span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-208">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-208">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/isZero">Vector.prototype.isZero()</a></h3>

<p>Determines if the vector is the zero vector.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">map</span><span class="p">(</span><span class="nx">f</span> <span class="o">:</span> <span class="p">(</span><span class="nx">value</span> <span class="o">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">index</span> <span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">vector</span> <span class="o">:</span> <span class="nx">Vector</span> <span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="k">this</span><span class="p">[</span><span class="s1">&#39;constructor&#39;</span><span class="p">](</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">f</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-209">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-209">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/map">Vector.prototype.map()</a></h3>

<p>Works like Array.prototype.map.</p>

<p><em>@param {function}</em> <br />
<em>@returns {Vector}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">minus</span><span class="p">(</span><span class="nx">v</span> <span class="o">:</span> <span class="nx">Vector</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">negative</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-210">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-210">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/minus">Vector.prototype.minus()</a></h3>

<p>Calculates the difference of two vectors.</p>

<p><em>@param {Vector}</em> The vector to be subtracted. <br />
<em>@returns {Vector}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">negative</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Vector</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-211">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-211">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/negative">Vector.prototype.negative()</a></h3>

<p>Returns the negative vector.</p>

<p><em>@returns {Vector}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">norm</span><span class="p">(</span><span class="nx">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">p</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">hypot</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">p</span> <span class="o">===</span> <span class="kc">Infinity</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">).</span><span class="nx">toArray</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">root</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">curr</span><span class="p">){</span>
      <span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">curr</span><span class="p">),</span><span class="nx">p</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">0</span><span class="p">),</span> <span class="nx">p</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-212">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-212">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/norm">Vector.prototype.norm()</a></h3>

<p>Calcultes the norm of the vector.</p>

<p><em>@param {number}</em> [default=2] The p for the p-norm
<em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">outerProduct</span><span class="p">(</span><span class="nx">v</span> <span class="o">:</span> <span class="nx">Vector</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">v</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-213">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-213">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/outerProduct">Vector.prototype.outerProduct()</a></h3>

<p>Calculates the outer product of two vectors.</p>

<p><em>@param {Vector}</em> <br />
<em>@returns {Matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">plus</span><span class="p">(</span><span class="nx">v</span> <span class="o">:</span> <span class="nx">Vector</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Vector</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Vector</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">v</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}));</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-214">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-214">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/plus">Vector.prototype.plus()</a></h3>

<p>Calculates the sum of two vectors.</p>

<p><em>@param {Vector}</em> <br />
<em>@returns {Vector}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">reduce</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reduce</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-215">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-215">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/reduce">Vector.prototype.reduce()</a></h3>

<p>Works like Array.prototype.reduce.</p>

<p><em>@returns {any}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">scalarProduct</span><span class="p">(</span><span class="nx">v</span> <span class="o">:</span> <span class="nx">Vector</span><span class="p">)</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">w</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">w</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">v</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
    <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-216">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-216">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/scalarProduct">Vector.prototype.scalarProduct()</a></h3>

<p>Calculates the scalar product of two vectors.</p>

<p><em>@param {vector}</em> <br />
<em>@returns {number|complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">slice</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[]</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-217">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-217">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/slice">Vector.prototype.slice()</a></h3>

<p>Works like the Array.prototype.slice function</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">times</span><span class="p">(</span><span class="nx">n</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;rational&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">n</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">toNumber</span><span class="p">();</span> 
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">n</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">||</span> <span class="nx">n</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;matrix&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">toColVectors</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">scalarProduct</span><span class="p">(</span><span class="nx">res</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Vector</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-218">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-218">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/times">Vector.prototype.times()</a></h3>

<p>Multiplies the vector by a (complex) number or a matrix.
The vector is multiplied from left to the matrix. 
If you want to multiply it from the right use
matrix.times(vector) instead of vector.times(matrix)</p>

<p><em>@param {number|complex|matrix}</em> <br />
<em>@returns {vector}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toArray</span><span class="p">()</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[]</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-219">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-219">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/toArray">Vector.prototype.toArray()</a></h3>

<p>Converts the vector to an array.</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toContentMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
  <span class="p">},</span> <span class="s1">&#39;&lt;vector&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/vector&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-220">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-220">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/toContentMathMLString">Vector.prototype.toContentMathMLString()</a></h3>

<p>Returns the content MathML representation of the vector.</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toLaTeX</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;\\begin{pmatrix}\n\t&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="s1">&#39;\\\\\n\t&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
  <span class="p">})</span> <span class="o">+</span> <span class="s1">&#39;\n\\end{pmatrix}&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-221">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-221">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/toLaTeX">Vector.prototype.toLaTeX()</a></h3>

<p>Returns a LaTeX representation of the vector.</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="s1">&#39;&lt;mtr&gt;&lt;mtd&gt;&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="nx">cur</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mtd&gt;&lt;/mtr&gt;&#39;</span><span class="p">;</span>
  <span class="p">},</span> <span class="s1">&#39;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mtable&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mtable&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-222">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-222">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/toMathMLString">Vector.prototype.toMathMLString()</a></h3>

<p>Returns the (presentation) MathML representation of the vector.</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
  <span class="p">})</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-223">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-223">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/toString">Vector.prototype.toString()</a></h3>

<p>Returns a string representation of the vector.</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">vectorProduct</span><span class="p">(</span><span class="nx">v</span> <span class="o">:</span> <span class="nx">Vector</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Vector</span> <span class="p">{</span>
  <span class="cm">/* TODO: Implement vectorproduct for non three-dimensional vectors */</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">3</span> <span class="o">&amp;&amp;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Vector</span><span class="p">([</span>
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nx">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nx">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">v</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span>
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">]);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-224">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-224">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/vectorProduct">Vector.prototype.vectorProduct()</a></h3>

<p>Calculates the vector product of two vectors.</p>

<p><em>@param {Vector}</em> <br />
<em>@returns {Vector}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">zero</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span> <span class="o">:</span> <span class="nx">number</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Vector</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">i</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Vector</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-225">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-225">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Vector/zero">Vector.prototype.zero()</a></h3>

<p>Returns a zero vector of given size.</p>

<p><em>@param {number}</em> The number of entries in the vector. <br />
<em>@returns {Vector}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Circle</span> <span class="p">{</span>

  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">;</span>

  <span class="nx">center</span><span class="o">:</span> <span class="nx">Point</span><span class="p">;</span>
  <span class="nx">radius</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">center</span><span class="o">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">radius</span><span class="o">:</span> <span class="nx">number</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">center</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">center</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="nx">center</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">center</span> <span class="o">=</span> <span class="nx">center</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">radius</span> <span class="o">=</span> <span class="nx">radius</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-226">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-226">&#182;</a>               </div>               <h2><a id="Circle" href="http://mathlib.de/en/docs/Circle">Circle</a></h2>

<p>MathLib.Circle expects two arguments.
First the center in the form of an Array or a MathLib.point.
The second argument should be the radius of the circle.</p>

<h4>Simple use case:</h4>

<p><code>
// Create a circle with center (1, 2) and radius 3. <br />
var c = new MathLib.Circle([1, 2], 3); <br />
c.center                   // The center of the circle (point) <br />
c.radius                   // returns the radius of the circle
</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">area</span><span class="p">()</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">radius</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">radius</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-227">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-227">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Circle/area">Circle.prototype.area()</a></h3>

<p>Calculates the area of the circle.</p>

<p><em>@param {number}</em> The area of the circle</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">circumference</span><span class="p">()</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">radius</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-228">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-228">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Circle/circumference">Circle.prototype.circumference()</a></h3>

<p>Calculates the circumference of the circle.</p>

<p><em>@param {number}</em> The circumference of the circle</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">draw</span><span class="p">(</span><span class="nx">screen</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">screen</span><span class="p">))</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">circle</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">screen</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">x</span><span class="p">.</span><span class="nx">circle</span><span class="p">(</span><span class="nx">circle</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">screen</span><span class="p">.</span><span class="nx">circle</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-229">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-229">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Circle/draw">Circle.prototype.draw()</a></h3>

<p>Draw the circle onto the screen.</p>

<p><em>@param {screen}</em> The screen to draw onto. <br />
<em>@param {options}</em> Optional drawing options <br />
<em>@return {circle}</em> Returns the circle for chaining</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEqual</span><span class="p">(</span><span class="nx">c</span><span class="o">:</span> <span class="nx">Circle</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">radius</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">radius</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">center</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-230">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-230">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Circle/isEqual">Circle.prototype.isEqual()</a></h3>

<p>Checks if two circles are equal</p>

<p><em>@return {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">positionOf</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">diff</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;point&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">diff</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">distanceTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">center</span><span class="p">)</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">diff</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;on&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;in&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s1">&#39;out&#39;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-231">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-231">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Circle/positionOf">Circle.prototype.positionOf()</a></h3>

<p>Determine if a point is in, on or outside a circle.</p>

<p><em>@return {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">reflectAt</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Circle</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Circle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">reflectAt</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nx">radius</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-232">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-232">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Circle/reflectAt">Circle.prototype.reflectAt()</a></h3>

<p>Reflect the circle at a point or line</p>

<p><em>@return {Circle}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toLaTeX</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;B_{&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}\\left(&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;\\right)&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-233">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-233">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Circle/toLaTeX">Circle.prototype.toLaTeX()</a></h3>

<p>Returns a LaTeX expression of the circle</p>

<p><em>@return {string}</em> </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMatrix</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">center</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
      <span class="nx">y</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">center</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
      <span class="nx">r</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="nx">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="nx">y</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="nx">x</span><span class="p">,</span> <span class="o">-</span><span class="nx">y</span><span class="p">,</span> <span class="nx">x</span><span class="o">*</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="o">*</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">r</span><span class="o">*</span><span class="nx">r</span><span class="p">]]);</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-234">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-234">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/Circle/toMatrix">Circle.prototype.toMatrix()</a></h3>

<p>Converts the circle to the corresponding matrix.</p>

<p><em>@return {Matrix}</em> </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Complex</span> <span class="p">{</span>

  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;complex&#39;</span><span class="p">;</span>

  <span class="nx">re</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">im</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">re</span><span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">im</span><span class="o">:</span> <span class="nx">number</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">re</span> <span class="o">=</span> <span class="nx">re</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">im</span> <span class="o">=</span> <span class="nx">im</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-235">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-235">&#182;</a>               </div>               <h2><a id="Complex"></a>Complex</h2>

<p>MathLib.Complex is the MathLib implementation of complex numbers.</p>

<p>There are two ways of defining complex numbers:</p>

<ul>
<li>Two numbers representing the real and the complex part.</li>
<li>MathLib.Complex.polar(abs, arg)</li>
</ul>

<h4>Simple example:</h4>

<p><code>
// Create the complex number 1 + 2i <br />
var c = new MathLib.Complex(1, 2]); <br />
</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">infinity</span> <span class="o">=</span> <span class="s1">&#39;complexInfinity&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-236">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-236">&#182;</a>               </div>               <h3>Complex.infinity</h3>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">abs</span><span class="p">()</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">hypot</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-237">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-237">&#182;</a>               </div>               <h3>Complex.prototype.abs()</h3>

<p>Returns the absolute value of the number.</p>

<p><em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">arccos</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">arcsin</span><span class="p">());</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-238">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-238">&#182;</a>               </div>               <h3>Complex.prototype.arccos()</h3>

<p>Returns the inverse cosine of the number.</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">arccot</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">arctan</span><span class="p">());</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-239">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-239">&#182;</a>               </div>               <h3>Complex.prototype.arccot()</h3>

<p>Returns the inverse cotangent of the number.</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">arccsc</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">ln</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">))))</span> <span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">divide</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="k">this</span><span class="p">))));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-240">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-240">&#182;</a>               </div>               <h3>Complex.prototype.arccsc()</h3>

<p>Returns the inverse cosecant of the number</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">arcsin</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span>
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">arccos</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">a</span><span class="o">*</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="o">*</span><span class="nx">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="nx">b</span><span class="o">*</span><span class="nx">b</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">a</span><span class="o">*</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="o">*</span><span class="nx">b</span><span class="p">)),</span>
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">arcosh</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">a</span><span class="o">*</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="o">*</span><span class="nx">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="nx">b</span><span class="o">*</span><span class="nx">b</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">a</span><span class="o">*</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="o">*</span><span class="nx">b</span><span class="p">))</span>
    <span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-241">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-241">&#182;</a>               </div>               <h3>Complex.prototype.arcsin()</h3>

<p>Returns the inverse sine of the number</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">arctan</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">iz</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">ln</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">divide</span><span class="p">(</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">iz</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">iz</span><span class="p">))));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-242">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-242">&#182;</a>               </div>               <h3>Complex.prototype.arctan()</h3>

<p>Returns the inverse tangent of the number</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">arg</span><span class="p">()</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">atan2</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-243">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-243">&#182;</a>               </div>               <h3>Complex.prototype.arg()</h3>

<p>Returns the argument (= the angle) of the complex number</p>

<p><em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">artanh</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">ln</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">this</span><span class="p">)),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">ln</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">this</span><span class="p">))));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-244">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-244">&#182;</a>               </div>               <h3>Complex.prototype.artanh()</h3>

<p>Returns the inverse hyperbolic tangent of the number</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">compare</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">abs</span><span class="p">()</span> <span class="o">-</span> <span class="nx">x</span><span class="p">.</span><span class="nx">abs</span><span class="p">());</span>
  <span class="k">return</span> <span class="nx">a</span> <span class="o">?</span> <span class="nx">a</span> <span class="o">:</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">arg</span><span class="p">()</span> <span class="o">-</span> <span class="nx">x</span><span class="p">.</span><span class="nx">arg</span><span class="p">());</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-245">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-245">&#182;</a>               </div>               <h3>Complex.prototype.compare()</h3>

<p>Compares two complex numbers</p>

<p><em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">conjugate</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-246">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-246">&#182;</a>               </div>               <h3>Complex.prototype.conjugate()</h3>

<p>Calculates the conjugate of a complex number</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">copy</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-247">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-247">&#182;</a>               </div>               <h3>Complex.prototype.copy()</h3>

<p>Copies the complex number</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">cos</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span> <span class="o">*</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">cosh</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">),</span> <span class="o">-</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span><span class="o">*</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">sinh</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-248">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-248">&#182;</a>               </div>               <h3>Complex.prototype.cos()</h3>

<p>Calculates the cosine of a complex number</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">cosh</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">)</span> <span class="o">*</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">cosh</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">)</span><span class="o">*</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">sinh</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-249">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-249">&#182;</a>               </div>               <h3>Complex.prototype.cosh()</h3>

<p>Calculates the hyperbolic cosine of a complex number</p>

<p><em>@returns {Complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">divide</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">inverse</span><span class="p">(</span><span class="nx">c</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-250">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-250">&#182;</a>               </div>               <h3>Complex.prototype.divide()</h3>

<p>Divides a complex number by an other</p>

<p><em>@param {number|complex}</em> The divisor <br />
<em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">exp</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span> <span class="o">*</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span><span class="o">*</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-251">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-251">&#182;</a>               </div>               <h3>Complex.prototype.exp()</h3>

<p>Evaluates the exponential function with a complex argument</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">inverse</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">divide</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="mi">2</span><span class="p">))),</span>
    <span class="nx">MathLib</span><span class="p">.</span><span class="nx">divide</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="mi">2</span><span class="p">))));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-252">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-252">&#182;</a>               </div>               <h3>Complex.prototype.inverse()</h3>

<p>Calculates the inverse of a complex number</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEqual</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">n</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">n</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="nx">n</span><span class="p">.</span><span class="nx">im</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-253">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-253">&#182;</a>               </div>               <h3>Complex.prototype.isEqual()</h3>

<p>Determines if the complex number is equal to another number.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">isFinite</span><span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nb">isFinite</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nb">isFinite</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-254">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-254">&#182;</a>               </div>               <h3>Complex.prototype.isFinite()</h3>

<p>Determines if the complex number is finite.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isOne</span><span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isOne</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-255">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-255">&#182;</a>               </div>               <h3>Complex.prototype.isOne()</h3>

<p>Determines if the complex number is equal to 1.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isReal</span><span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-256">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-256">&#182;</a>               </div>               <h3>Complex.prototype.isReal()</h3>

<p>Determines if the complex number is real.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isZero</span><span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-257">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-257">&#182;</a>               </div>               <h3>Complex.prototype.isZero()</h3>

<p>Determines if the complex number is equal to 0.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">ln</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">ln</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">abs</span><span class="p">()),</span> <span class="k">this</span><span class="p">.</span><span class="nx">arg</span><span class="p">());</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-258">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-258">&#182;</a>               </div>               <h3>Complex.prototype.ln()</h3>

<p>Evaluates the natural logarithm with complex arguments</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">minus</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">(</span><span class="nx">c</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-259">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-259">&#182;</a>               </div>               <h3>Complex.prototype.minus()</h3>

<p>Calculates the difference of two complex numbers</p>

<p><em>@param {number|complex}</em> The subtrahend <br />
<em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">negative</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-260">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-260">&#182;</a>               </div>               <h3>Complex.prototype.negative()</h3>

<p>Calculates the negative of the complex number</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">one</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Complex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-261">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-261">&#182;</a>               </div>               <h3>Complex.one()</h3>

<p>Complex representation of 1.</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">plus</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">re</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">im</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;rational&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">toNumber</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">c</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-262">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-262">&#182;</a>               </div>               <h3>Complex.prototype.plus()</h3>

<p>Add complex numbers</p>

<p><em>@param {complex|number|rational}</em> The number to be added <br />
<em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">polar</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">abs</span><span class="p">,</span> <span class="nx">arg</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">abs</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">arg</span><span class="p">),</span> <span class="nx">abs</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">arg</span><span class="p">));</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-263">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-263">&#182;</a>               </div>               <h3>Complex.polar()</h3>

<p>Construct a complex number out of the absolute value and the argument</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">pow</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">abs</span><span class="p">(),</span> <span class="nx">n</span><span class="p">),</span> <span class="nx">n</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">arg</span><span class="p">());</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-264">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-264">&#182;</a>               </div>               <h3>Complex.prototype.pow()</h3>

<p>Calculates the n-th pow of the complex number</p>

<p><em>@param {number}</em> The pow to which the complex number should be raised <br />
<em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sign</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">.</span><span class="nx">polar</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">arg</span><span class="p">());</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-265">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-265">&#182;</a>               </div>               <h3>Complex.prototype.sign()</h3>

<p>Calculates the signum of a complex number</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sin</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span> <span class="o">*</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">cosh</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">)</span><span class="o">*</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">sinh</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-266">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-266">&#182;</a>               </div>               <h3>Complex.prototype.sin()</h3>

<p>Calculates the sine of a complex number</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sinh</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">)</span> <span class="o">*</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sinh</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">)</span><span class="o">*</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">cosh</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-267">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-267">&#182;</a>               </div>               <h3>Complex.prototype.sinh()</h3>

<p>Calculates the hyperbolic sine of a complex number</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">times</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">re</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">im</span><span class="p">)),</span>
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">im</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">re</span><span class="p">)));</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;rational&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">toNumber</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">c</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="nx">c</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-268">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-268">&#182;</a>               </div>               <h3>Complex.prototype.times()</h3>

<p>Multiplies complex numbers</p>

<p><em>@param {complex|number|rational}</em> The number to be multiplied <br />
<em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toContentMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nb">String</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;&lt;cn type=&quot;complex-cartesian&quot;&gt;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">re</span> <span class="o">+</span> <span class="s1">&#39;&lt;sep/&gt;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">im</span> <span class="o">+</span> <span class="s1">&#39;&lt;/cn&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-269">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-269">&#182;</a>               </div>               <h3>Complex.prototype.toContentMathMLString()</h3>

<p>Returns the content MathML representation of the number</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toLaTeX</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="nx">reFlag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">);</span>
    <span class="nx">reFlag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="nx">reFlag</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;i&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-270">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-270">&#182;</a>               </div>               <h3>Complex.prototype.toLaTeX()</h3>

<p>Returns the LaTeX representation of the complex number</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">reFlag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">);</span>
    <span class="nx">reFlag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="nx">reFlag</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;mo&gt;&amp;#x2062;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;mn&gt;0&lt;/mn&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-271">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-271">&#182;</a>               </div>               <h3>Complex.prototype.toMathMLString()</h3>

<p>Returns the (presentation) MathML representation of the number</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMatrix</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">([[</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">)],</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">]]);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-272">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-272">&#182;</a>               </div>               <h3>Complex.prototype.toMatrix()</h3>

<p>Transforms the complex number to a 2x2 matrix</p>

<p><em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toPoint</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Point</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-273">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-273">&#182;</a>               </div>               <h3>Complex.prototype.toPoint()</h3>

<p>Interprets the complex number as point in the two dimensional plane</p>

<p><em>@returns {point}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">re</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">+=</span>  <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="s1">&#39;+&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">im</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;i&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-274">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-274">&#182;</a>               </div>               <h3>Complex.prototype.toString()</h3>

<p>Custom toString function</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">zero</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-275">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-275">&#182;</a>               </div>               <h3>Complex.zero()</h3>

<p>Complex representation of 0.</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Line</span> <span class="kr">extends</span> <span class="nx">Vector</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;line&#39;</span><span class="p">;</span>

  <span class="nx">dimension</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">coords</span><span class="o">:</span> <span class="nx">number</span><span class="p">[])</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">coords</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-276">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-276">&#182;</a>               </div>               <h2><a id="Line"></a>Line</h2>

<p>The vector implementation of MathLib makes calculations with lines in the 
real plane possible. (Higher dimensions will be supported later)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">draw</span><span class="p">(</span><span class="nx">screen</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">screen</span><span class="p">))</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">screen</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">x</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="nx">line</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">screen</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-277">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-277">&#182;</a>               </div>               <h3>Line.prototype.draw()</h3>

<p>Draws the line on one or more screens</p>

<p><em>@param {screen}</em> The screen to draw onto. <br />
<em>@param {object}</em> [options] Drawing options <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEqual</span><span class="p">(</span><span class="nx">q</span> <span class="o">:</span> <span class="nx">Line</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">normalize</span><span class="p">();</span>
      <span class="nx">q</span> <span class="o">=</span> <span class="nx">q</span><span class="p">.</span><span class="nx">normalize</span><span class="p">();</span>

  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="nx">q</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">p</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">q</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-278">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-278">&#182;</a>               </div>               <h3>Line.prototype.isEqual()</h3>

<p>Determines if two lines are equal.</p>

<p><em>@param {line}</em> <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">isFinite</span><span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-279">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-279">&#182;</a>               </div>               <h3>Line.prototype.isFinite()</h3>

<p>Determines if the line is finite</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isOrthogonalTo</span><span class="p">(</span><span class="nx">l</span> <span class="o">:</span> <span class="nx">Line</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Line</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]).</span><span class="nx">crossRatio</span><span class="p">(</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">meet</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Line</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span>
      <span class="nx">l</span><span class="p">.</span><span class="nx">meet</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Line</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> 
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Point</span><span class="p">.</span><span class="nx">I</span><span class="p">,</span>
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Point</span><span class="p">.</span><span class="nx">J</span>
    <span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-280">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-280">&#182;</a>               </div>               <h3>Line.prototype.isOrthogonalTo()</h3>

<p>Determines if two lines are orthogonal.</p>

<p><em>@param {line}</em> <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isParallelTo</span><span class="p">(</span><span class="nx">l</span> <span class="o">:</span> <span class="nx">Line</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">l</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">||</span> <span class="nx">i</span> <span class="o">===</span> <span class="nx">l</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-281">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-281">&#182;</a>               </div>               <h3>Line.prototype.isParallelTo()</h3>

<p>Determines if two lines are parallel.</p>

<p><em>@param {line}</em> <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">meet</span><span class="p">(</span><span class="nx">l</span> <span class="o">:</span> <span class="nx">Line</span><span class="p">,</span> <span class="nx">dyn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Point</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">point</span><span class="p">,</span>
      <span class="nx">k</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">===</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">l</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">point</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">vectorProduct</span><span class="p">(</span><span class="nx">l</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">dyn</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperties</span><span class="p">(</span><span class="nx">point</span><span class="p">,</span> <span class="p">{</span>
        <span class="s2">&quot;0&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">get</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="nx">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nx">l</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="p">},</span>
          <span class="nx">set</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span>
          <span class="nx">enumerable</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">configurable</span> <span class="o">:</span> <span class="kc">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;1&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">get</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nx">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">l</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="p">},</span>
          <span class="nx">set</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span>
          <span class="nx">enumerable</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">configurable</span> <span class="o">:</span> <span class="kc">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;2&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">get</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nx">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">l</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="p">},</span>
          <span class="nx">set</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span>
          <span class="nx">enumerable</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">configurable</span> <span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">point</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-282">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-282">&#182;</a>               </div>               <h3>Line.prototype.meet()</h3>

<p>Calculates the meeting point of two lines</p>

<p><em>@param {line}</em> <br />
<em>@returns {point}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">normalize</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Line</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">hypot</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="k">this</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">/</span> <span class="nx">h</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-283">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-283">&#182;</a>               </div>               <h3>Line.prototype.normalize()</h3>

<p>Normalizes the line.</p>

<p><em>@returns {line}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;matrix&#39;</span><span class="p">;</span>

  <span class="nx">length</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">cols</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">rows</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">LUpermutation</span><span class="o">:</span> <span class="nx">Permutation</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">matrix</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">matrix</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-284">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-284">&#182;</a>               </div>               <h2><a id="Matrix"></a>Matrix</h2>

<p>The matrix implementation of MathLib makes calculations with matrices of
arbitrary size possible. The entries of a matrix can be numbers and complex
numbers.</p>

<p>It is as easy as
<code>
new MathLib.Matrix([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
</code>
to create the following matrix: <br />
    1 2 3  <br />
    4 5 6  <br />
    7 8 9 </p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">matrix</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">MathML</span><span class="p">(</span><span class="nx">matrix</span><span class="p">).</span><span class="nx">parse</span><span class="p">();</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-285">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-285">&#182;</a>               </div>               <p>If there is a &lt; in the string we assume it's MathML</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">matrix</span> <span class="o">=</span> <span class="nx">matrix</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/;?\n/g</span><span class="p">,</span> <span class="s1">&#39;],[&#39;</span><span class="p">);</span>
        <span class="nx">matrix</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;[[&#39;</span> <span class="o">+</span> <span class="nx">matrix</span> <span class="o">+</span> <span class="s1">&#39;]]&#39;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">matrix</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">x</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">matrix</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">cols</span> <span class="o">=</span> <span class="nx">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">rows</span> <span class="o">=</span> <span class="nx">matrix</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-286">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-286">&#182;</a>               </div>               <p>else we assume it's MatLab notation</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">LU</span><span class="p">(</span><span class="nx">dontSwapPivot</span><span class="o">?</span> <span class="o">:</span> <span class="nx">bool</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span>
      <span class="nx">LU</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(),</span>
      <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">,</span>
      <span class="nx">n</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">,</span>
      <span class="nx">permutation</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-287">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-287">&#182;</a>               </div>               <h3>Matrix.prototype.LU()</h3>

<p>Calculates the LU decomposition of a matrix
The result is cached.</p>

<p><em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dontSwapPivot</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">p</span> <span class="o">=</span> <span class="nx">k</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">m</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">LU</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">k</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">LU</span><span class="p">[</span><span class="nx">p</span><span class="p">][</span><span class="nx">k</span><span class="p">]))</span> <span class="p">{</span>
          <span class="nx">p</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-288">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-288">&#182;</a>               </div>               <p>Find the pivot</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">p</span> <span class="o">!==</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">permutation</span><span class="p">.</span><span class="nx">unshift</span><span class="p">([</span><span class="nx">p</span><span class="p">,</span> <span class="nx">k</span><span class="p">]);</span>
        <span class="nx">t</span> <span class="o">=</span> <span class="nx">LU</span><span class="p">[</span><span class="nx">p</span><span class="p">];</span> <span class="nx">LU</span><span class="p">[</span><span class="nx">p</span><span class="p">]</span> <span class="o">=</span> <span class="nx">LU</span><span class="p">[</span><span class="nx">k</span><span class="p">];</span> <span class="nx">LU</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">t</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-289">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-289">&#182;</a>               </div>               <p>Exchange if necessary</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">LU</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">k</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">m</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">LU</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">divide</span><span class="p">(</span><span class="nx">LU</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">k</span><span class="p">],</span> <span class="nx">LU</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">k</span><span class="p">]);</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">LU</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">LU</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">],</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">LU</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">k</span><span class="p">],</span> <span class="nx">LU</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">j</span><span class="p">]));</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">LU</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">LU</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">LU</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">LU</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">LUpermutation</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Permutation</span><span class="p">(</span><span class="nx">permutation</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">LU</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-290">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-290">&#182;</a>               </div>               <p>The elimination</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">adjoint</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">conjugate</span><span class="p">).</span><span class="nx">transpose</span><span class="p">();</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-291">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-291">&#182;</a>               </div>               <h3>Matrix.prototype.adjoint()</h3>

<p>Calculates the adjoint matrix</p>

<p><em>@returns {Matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">adjugate</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">r</span><span class="p">).</span><span class="nx">determinant</span><span class="p">(),</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="nx">r</span><span class="o">+</span><span class="nx">c</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-292">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-292">&#182;</a>               </div>               <h3>Matrix.prototype.adjugate()</h3>

<p>Calculates the adjugate matrix</p>

<p><em>@returns {Matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">cholesky</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">rr</span><span class="p">,</span> <span class="nx">temp</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">kk</span><span class="p">,</span> <span class="nx">sum</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">cholesky</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">rr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">r</span> <span class="o">&lt;</span> <span class="nx">rr</span><span class="p">;</span> <span class="nx">r</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">([]);</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">rr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">r</span> <span class="o">&lt;</span> <span class="nx">rr</span><span class="p">;</span> <span class="nx">r</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">c</span><span class="o">&lt;</span><span class="nx">r</span><span class="p">;</span> <span class="nx">c</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">kk</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="nx">kk</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">sum</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">sum</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">temp</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">k</span><span class="p">],</span> <span class="nx">temp</span><span class="p">[</span><span class="nx">c</span><span class="p">][</span><span class="nx">k</span><span class="p">]));</span>
      <span class="p">}</span>
      <span class="nx">temp</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">c</span><span class="p">]</span> <span class="o">-</span> <span class="nx">sum</span><span class="p">)</span><span class="o">/</span><span class="nx">temp</span><span class="p">[</span><span class="nx">c</span><span class="p">][</span><span class="nx">c</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="nx">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">kk</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="nx">kk</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">sum</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">sum</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">temp</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">k</span><span class="p">],</span> <span class="nx">temp</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">k</span><span class="p">]));</span>
    <span class="p">}</span>
    <span class="nx">temp</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">c</span><span class="p">][</span><span class="nx">c</span><span class="p">]</span> <span class="o">-</span> <span class="nx">sum</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">c</span><span class="o">++</span><span class="p">;</span> <span class="nx">c</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">c</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">temp</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

  <span class="p">}</span>
  <span class="nx">cholesky</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">temp</span><span class="p">);</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">cholesky</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">cholesky</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">cholesky</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-293">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-293">&#182;</a>               </div>               <h3>Matrix.prototype.cholesky()</h3>

<p>The cholesky decomposition of a matrix
using the CholeskyBanachiewicz algorithm.
Does not change the current matrix, but returns a new one.
The result is cached.</p>

<p><em>@returns {Matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">copy</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">copy</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-294">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-294">&#182;</a>               </div>               <h3>Matrix.prototype.copy()</h3>

<p>Copies the matrix</p>

<p><em>@returns {Matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">determinant</span><span class="p">()</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isSquare</span><span class="p">())</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">arr</span><span class="p">,</span> <span class="nx">determinant</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rank</span><span class="p">()</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">determinant</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">arr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">LU</span><span class="p">();</span>
      <span class="nx">determinant</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">LUpermutation</span><span class="p">.</span><span class="nx">sgn</span><span class="p">(),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">diag</span><span class="p">()));</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">determinant</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">determinant</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="nx">determinant</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-295">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-295">&#182;</a>               </div>               <h3>Matrix.prototype.determinant()</h3>

<p>Calculates the determinant of the matrix via the LU decomposition.
The result is cached.</p>

<p><em>@returns {number|complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">diag</span><span class="p">()</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[]</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">);</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">i</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-296">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-296">&#182;</a>               </div>               <h3>Matrix.prototype.diag()</h3>

<p>Returns the entries on the diagonal in an array</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">divide</span><span class="p">(</span><span class="nx">n</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">inverse</span><span class="p">(</span><span class="nx">n</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-297">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-297">&#182;</a>               </div>               <h3>Matrix.prototype.divide()</h3>

<p>Multiplies the matrix by the inverse of a number or a matrix</p>

<p><em>@returns {Matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">every</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">every</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">every</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-298">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-298">&#182;</a>               </div>               <h3>Matrix.prototype.every()</h3>

<p>This function works like the Array.prototype.every function.
The matrix is processed row by row.
The function is called with the following arguments:
the entry at the current position, the number of the row,
the number of the column and the complete matrix</p>

<p><em>@param {function}</em> The function which is called on every argument <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">forEach</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">forEach</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">forEach</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-299">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-299">&#182;</a>               </div>               <h3>Matrix.prototype.forEach()</h3>

<p>This function works like the Array.prototype.forEach function.
The matrix is processed row by row.
The function is called with the following arguments:
the entry at the current position, the number of the row,
the number of the column and the complete matrix</p>

<p><em>@param {function}</em> The function which is called on every argument</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">gershgorin</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">rc</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">rr</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">rc</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="nx">rr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="s1">&#39;complex&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">toPoint</span><span class="p">());</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Point</span><span class="p">([</span><span class="nx">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]));</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">rc</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> 
      <span class="nx">rr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> 
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Circle</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">rc</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">rr</span><span class="p">[</span><span class="nx">i</span><span class="p">])));</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-300">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-300">&#182;</a>               </div>               <h3>Matrix.prototype.gershgorin()</h3>

<p>Returns the Gershgorin circles of the matrix.</p>

<p><em>@returns {array}</em> Returns an array of circles</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">givens</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">,</span>
      <span class="nx">cols</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">,</span>
      <span class="nx">R</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">copy</span><span class="p">(),</span>
      <span class="nx">Q</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">.</span><span class="nx">identity</span><span class="p">(</span><span class="nx">rows</span><span class="p">),</span>
      <span class="nx">c</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">rho</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">ri</span><span class="p">,</span> <span class="nx">rj</span><span class="p">,</span> <span class="nx">qi</span><span class="p">,</span> <span class="nx">qj</span><span class="p">;</span> 
      
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">R</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-301">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-301">&#182;</a>               </div>               <h3>Matrix.prototype.givens()</h3>

<p>QR decomposition with the givens method.</p>

<p><em>@returns {[matrix, matrix]}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">rho</span> <span class="o">=</span> <span class="p">(</span><span class="nx">R</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">hypot</span><span class="p">(</span><span class="nx">R</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">i</span><span class="p">],</span>  <span class="nx">R</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">i</span><span class="p">]);</span>
        <span class="nx">c</span>   <span class="o">=</span> <span class="nx">R</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span> <span class="o">/</span> <span class="nx">rho</span><span class="p">;</span>
        <span class="nx">s</span>   <span class="o">=</span> <span class="nx">R</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span> <span class="o">/</span> <span class="nx">rho</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-302">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-302">&#182;</a>               </div>               <p>We can't use the sign function here, because we want the factor 
to be 1 if A[i][i] is zero.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">ri</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">rj</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">qi</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">qj</span> <span class="o">=</span> <span class="p">[];</span>
        </pre></div>             </td>           </tr>                               <tr id="section-303">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-303">&#182;</a>               </div>               <p>Apply the rotation</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">for</span> <span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">k</span><span class="o">&lt;</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">ri</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">R</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">k</span><span class="p">]);</span>
          <span class="nx">rj</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">R</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">k</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">k</span><span class="o">&lt;</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">R</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">rj</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">*</span> <span class="nx">s</span> <span class="o">+</span> <span class="nx">ri</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">*</span> <span class="nx">c</span><span class="p">;</span>
          <span class="nx">R</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">rj</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">*</span> <span class="nx">c</span> <span class="o">-</span> <span class="nx">ri</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">*</span> <span class="nx">s</span><span class="p">;</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-304">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-304">&#182;</a>               </div>               <p>Multiply to R</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">for</span> <span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">k</span><span class="o">&lt;</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">qi</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Q</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">i</span><span class="p">]);</span>
          <span class="nx">qj</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Q</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">k</span><span class="o">&lt;</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">Q</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span>  <span class="nx">qi</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">*</span> <span class="nx">c</span> <span class="o">+</span> <span class="nx">qj</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">*</span> <span class="nx">s</span><span class="p">;</span>
          <span class="nx">Q</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nx">qi</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">*</span> <span class="nx">s</span> <span class="o">+</span> <span class="nx">qj</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">*</span> <span class="nx">c</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">[</span><span class="nx">Q</span><span class="p">,</span> <span class="nx">R</span><span class="p">];</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-305">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-305">&#182;</a>               </div>               <p>Multiply to Q</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">givensMatrix</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">phi</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">givens</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">.</span><span class="nx">identity</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
  <span class="nx">givens</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">givens</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">phi</span><span class="p">);</span>
  <span class="nx">givens</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">phi</span><span class="p">);</span>
  <span class="nx">givens</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nx">givens</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">k</span><span class="p">];</span>
  <span class="k">return</span> <span class="nx">givens</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-306">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-306">&#182;</a>               </div>               <h3>Matrix.givensMatrix()</h3>

<p>This function returns a givens matrix</p>

<p><em>@param {number}</em> The size of the matrix. <br />
<em>@param {number}</em> The first row/column. <br />
<em>@param {number}</em> The second row/column. <br />
<em>@param {number}</em> The angle (in radians). <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">identity</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temp</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
  <span class="nx">n</span> <span class="o">=</span> <span class="nx">n</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="nx">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="nx">temp</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">temp</span><span class="p">);</span>
  <span class="nx">temp</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">temp</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">n</span><span class="o">-</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nx">n</span><span class="o">-</span><span class="nx">i</span><span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-307">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-307">&#182;</a>               </div>               <h3>Matrix.identity</h3>

<p>Returns the identity matrix.</p>

<p><em>@param {number}</em> The number of rows and columns. <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">inverse</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isSquare</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">determinant</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">adjugate</span><span class="p">().</span><span class="nx">divide</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">determinant</span><span class="p">());</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-308">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-308">&#182;</a>               </div>               <h3>Matrix.prototype.inverse()</h3>

<p>Calculates the inverse matrix.</p>

<p><em>@returns {matrix}</em>
TODO: optimize this calculation. But hey, you shouldn't use inverse anyway ;-)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isBandMatrix</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span> <span class="nx">u</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">ii</span><span class="p">,</span> <span class="nx">jj</span><span class="p">;</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">u</span> <span class="o">=</span> <span class="nx">l</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">i</span><span class="o">-</span><span class="nx">l</span> <span class="o">&lt;=</span> <span class="nx">j</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span><span class="o">+</span><span class="nx">u</span> <span class="o">&gt;=</span> <span class="nx">j</span><span class="p">)</span> <span class="o">||</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-309">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-309">&#182;</a>               </div>               <h3>Matrix.prototype.isBandMatrix()</h3>

<p>Determines if the matrix is a band matrix.</p>

<p><em>@param {number}</em> <br />
<em>@param {number}</em> <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-310">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-310">&#182;</a>               </div>               <p>for (i = 0, ii = this.rows; i &lt; ii; i++) {
  for (j = 0, jj = this.cols; j &lt; jj; j++) {
    if (i - j &lt; l &amp;&amp; this[i][j] !== 0) {
      return false;
    }
  }
}
return true;</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isDiag</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">ii</span><span class="p">,</span> <span class="nx">jj</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;isUpper&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">isUpper</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;isLower&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">isLower</span><span class="p">()))</span> <span class="o">+</span> <span class="p">(</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;isSymmetric&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">isSymmetric</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">jj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">jj</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">!==</span> <span class="nx">j</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-311">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-311">&#182;</a>               </div>               <h3>Matrix.prototype.isDiag()</h3>

<p>Determines if the matrix is a diagonal matrix.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEqual</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">ii</span><span class="p">,</span> <span class="nx">jj</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">===</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span> <span class="o">===</span> <span class="nx">x</span><span class="p">.</span><span class="nx">rows</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span> <span class="o">===</span> <span class="nx">x</span><span class="p">.</span><span class="nx">cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">jj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">jj</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">],</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-312">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-312">&#182;</a>               </div>               <h3>Matrix.prototype.isEqual()</h3>

<p>Determines if the matrix is equal to an other matrix.</p>

<p><em>@param {matrix}</em> the matrix to compare with <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isIdentity</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isSquare</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">isIdentity</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">r</span><span class="o">===</span><span class="nx">c</span> <span class="o">?</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isOne</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">:</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">isIdentity</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">isIdentity</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">isIdentity</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-313">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-313">&#182;</a>               </div>               <h3>Matrix.prototype.isIdentity()</h3>

<p>Determines if the matrix is a identity matrix.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isInvertible</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">isSquare</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">rank</span><span class="p">()</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-314">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-314">&#182;</a>               </div>               <h3>Matrix.prototype.isInvertible()</h3>

<p>Determines if the matrix is invertible.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isLower</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="nx">every</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-315">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-315">&#182;</a>               </div>               <h3>Matrix.prototype.isLower()</h3>

<p>Determines if the matrix is a lower triangular matrix.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isNegDefinite</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isSquare</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-316">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-316">&#182;</a>               </div>               <h3>Matrix.prototype.isNegDefinite()</h3>

<p>Determines if the matrix is negative definite</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">determinant</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">isNegDefinite</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">determinant</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">isNegDefinite</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-317">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-317">&#182;</a>               </div>               <p>Sylvester's criterion</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isOrthogonal</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">transpose</span><span class="p">().</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">isIdentity</span><span class="p">();</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-318">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-318">&#182;</a>               </div>               <h3>Matrix.prototype.isOrthogonal()</h3>

<p>Determines if the matrix is a orthogonal.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isPermutation</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">cols</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isOne</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span> <span class="o">||</span> <span class="nx">cols</span><span class="p">[</span><span class="nx">c</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">rows</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">cols</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">})</span> <span class="o">&amp;&amp;</span> <span class="nx">rows</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span> <span class="o">&amp;&amp;</span> <span class="nx">cols</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-319">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-319">&#182;</a>               </div>               <h3>Matrix.prototype.isPermutation()</h3>

<p>Determines if the matrix is a permutation matrix</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isPosDefinite</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isSquare</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-320">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-320">&#182;</a>               </div>               <h3>Matrix.prototype.isPosDefinite()</h3>

<p>Determines if the matrix is positive definite</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">determinant</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">isPosDefinite</span><span class="p">();</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-321">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-321">&#182;</a>               </div>               <p>Sylvester's criterion</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isReal</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isReal</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-322">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-322">&#182;</a>               </div>               <h3>Matrix.prototype.isReal()</h3>

<p>Determines if the matrix has only real entries</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isScalar</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">,</span>
      <span class="nx">diag</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">diag</span><span class="p">,</span>
      <span class="nx">i</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;isIdentity&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;isZero&#39;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isIdentity</span><span class="p">()</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">isZero</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isDiag</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">diag</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">diag</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-323">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-323">&#182;</a>               </div>               <h3>Matrix.prototype.isScalar()</h3>

<p>Determines if the matrix is a scalar matrix
(that is a multiple of the scalar matrix)</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isSquare</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-324">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-324">&#182;</a>               </div>               <h3>Matrix.prototype.isSquare()</h3>

<p>Determines if the matrix is a square matrix</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isSymmetric</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">bool</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isSquare</span><span class="p">())</span> <span class="p">{</span>
    <span class="nx">bool</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
<span class="nx">lp</span><span class="o">:</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">],</span> <span class="k">this</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
          <span class="nx">bool</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="k">break</span> <span class="nx">lp</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">isSymmetric</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">bool</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">bool</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-325">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-325">&#182;</a>               </div>               <h3>Matrix.prototype.isSymmetric()</h3>

<p>Determines if the matrix is symmetric</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isUpper</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="nx">every</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-326">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-326">&#182;</a>               </div>               <h3>Matrix.prototype.isUpper()</h3>

<p>Determines if the matrix is a upper triangular matrix</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isVector</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cols</span> <span class="o">===</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-327">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-327">&#182;</a>               </div>               <h3>Matrix.prototype.isVector()</h3>

<p>Determines if the matrix is a vector
(only one row or one column)</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isZero</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">isZero</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">);</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">isZero</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">isZero</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">isZero</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-328">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-328">&#182;</a>               </div>               <h3>Matrix.prototype.isZero()</h3>

<p>Determines if the matrix the zero matrix
The result is cached.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">map</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span>
    <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">m</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">})</span>
  <span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-329">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-329">&#182;</a>               </div>               <h3>Matrix.prototype.map()</h3>

<p>This function works like the Array.prototype.map function.
The matrix is processed row by row.
The function is called with the following arguments:
the entry at the current position, the number of the row,
the number of the column and the complete matrix</p>

<p><em>@param {function}</em> The function which is called on every argument <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">minor</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">).</span><span class="nx">determinant</span><span class="p">();</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-330">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-330">&#182;</a>               </div>               <h3>Matrix.prototype.minor()</h3>

<p>Calculates a minor</p>

<p><em>@param {number}</em> The row to be removed. <br />
<em>@param {number}</em> The column to be removed. <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">minus</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">negative</span><span class="p">());</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-331">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-331">&#182;</a>               </div>               <h3>Matrix.prototype.minus()</h3>

<p>Calculates the difference of two matrices</p>

<p><em>@param {matrix}</em> The matrix to be subtracted. <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">negative</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-332">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-332">&#182;</a>               </div>               <h3>Matrix.prototype.negative()</h3>

<p>Returns the negative matrix</p>

<p><em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">numbers</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">help</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nx">c</span> <span class="o">||</span> <span class="nx">r</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">help</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nx">r</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span> <span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">help</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-333">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-333">&#182;</a>               </div>               <h3>Matrix.numbers()</h3>

<p>Returns a matrix consisting completely of a given number</p>

<p><em>@param {number}</em> The number. <br />
<em>@param {number}</em> The number of rows. <br />
<em>@param {number}</em> The number of columns. <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">one</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">r</span> <span class="o">=</span> <span class="nx">r</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
  <span class="nx">c</span> <span class="o">=</span> <span class="nx">c</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">.</span><span class="nx">numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-334">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-334">&#182;</a>               </div>               <h3>Matrix.one()</h3>

<p>Returns a matrix consisting completely of ones.</p>

<p><em>@param {number}</em> The number of rows. <br />
<em>@param {number}</em> The number of columns. <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">plus</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">r</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">,</span>
      <span class="nx">c</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">,</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">r</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">c</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">],</span> <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-335">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-335">&#182;</a>               </div>               <h3>Matrix.prototype.plus()</h3>

<p>This function adds a matrix to the current matrix
and returns the result as a new matrix.</p>

<p><em>@param {matrix}</em> The matrix to be added. <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">random</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temp</span><span class="p">,</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">ii</span><span class="p">,</span> <span class="nx">jj</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nx">r</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">temp</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">jj</span> <span class="o">=</span> <span class="nx">c</span> <span class="o">||</span> <span class="nx">r</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">jj</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">temp</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-336">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-336">&#182;</a>               </div>               <h3>Matrix.random()</h3>

<p>Returns a matrix consisting completely of random numbers between 0 and 1</p>

<p><em>@param {number}</em> The number of rows.
<em>@param {number}</em> The number of columns.
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">rank</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">rank</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">mat</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">,</span> <span class="nx">j</span><span class="p">;</span>
  <span class="nx">mat</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rref</span><span class="p">();</span>

  <span class="nx">label</span><span class="o">:</span> <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">j</span><span class="o">&gt;=</span><span class="nx">i</span><span class="p">;</span> <span class="nx">j</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">mat</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nx">rank</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span> <span class="nx">label</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">rank</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">rank</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">rank</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-337">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-337">&#182;</a>               </div>               <h3>Matrix.prototype.rank()</h3>

<p>Determines the rank of the matrix</p>

<p><em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">reduce</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reduce</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-338">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-338">&#182;</a>               </div>               <h3>Matrix.prototype.reduce()</h3>

<p>This function works like the Array.prototype.reduce function.</p>

<p><em>@returns {any}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">remove</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">row</span> <span class="o">||</span> <span class="nx">row</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">row</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">row</span> <span class="o">=</span> <span class="p">[</span><span class="nx">row</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="nx">res</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">row</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">col</span> <span class="o">||</span> <span class="nx">col</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">col</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">col</span> <span class="o">=</span> <span class="p">[</span><span class="nx">col</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="nx">col</span> <span class="o">=</span> <span class="nx">col</span><span class="p">.</span><span class="nx">sort</span><span class="p">().</span><span class="nx">reverse</span><span class="p">();</span>
    <span class="nx">col</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">x</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
      <span class="p">});</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-339">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-339">&#182;</a>               </div>               <h3>Matrix.prototype.remove()</h3>

<p>This function removes the specified rows and/or columns for the matrix.</p>

<p><em>@param {number|array}</em> The row(s) to be removed. <br />
<em>@param {number|array}</em> The column(s) to be removed. <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">rref</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">lead</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">rref</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(),</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">temp</span><span class="p">,</span> <span class="nx">val</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">r</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">r</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cols</span> <span class="o">&lt;=</span> <span class="nx">lead</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">rref</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">i</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">rref</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">lead</span><span class="p">]</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span> <span class="o">===</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">i</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>
        <span class="nx">lead</span><span class="o">++</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cols</span> <span class="o">===</span> <span class="nx">lead</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">rref</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-340">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-340">&#182;</a>               </div>               <h3>Matrix.prototype.rref()</h3>

<p>Calculate the reduced row echelon form (rref) of a matrix.</p>

<p><em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">rref</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="nx">rref</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">rref</span><span class="p">[</span><span class="nx">r</span><span class="p">];</span>
    <span class="nx">rref</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>

    <span class="nx">val</span> <span class="o">=</span> <span class="nx">rref</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">lead</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">rref</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">/=</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">val</span> <span class="o">=</span> <span class="nx">rref</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">lead</span><span class="p">];</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rref</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">rref</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">],</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">rref</span><span class="p">[</span><span class="nx">r</span><span class="p">][</span><span class="nx">j</span><span class="p">]));</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">lead</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">rref</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-341">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-341">&#182;</a>               </div>               <p>Switch the lines</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">slice</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-342">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-342">&#182;</a>               </div>               <h3>Matrix.prototype.slice()</h3>

<p>This function works like the Array.prototype.slice function.</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">solve</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-343">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-343">&#182;</a>               </div>               <h3>Matrix.prototype.solve()</h3>

<p>Solves the system of linear equations Ax = b
given by the matrix A and a vector or point b.</p>

<p><em>@param {vector|point}</em> The b in Ax = b <br />
<em>@returns {vector|point}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">LU</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">LU</span><span class="p">(),</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span>
      <span class="nx">n</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="nx">x</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">y</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-344">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-344">&#182;</a>               </div>               <p>Ax = b -> LUx = b. Then y is defined to be Ux</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">b</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">LUpermutation</span><span class="p">.</span><span class="nx">applyTo</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-345">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-345">&#182;</a>               </div>               <p>Permutate b according to the LU decomposition</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">y</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">i</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">y</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">y</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">LU</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">],</span> <span class="nx">y</span><span class="p">[</span><span class="nx">j</span><span class="p">]));</span>
    <span class="p">}</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-346">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-346">&#182;</a>               </div>               <p>Forward solve Ly = b</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">LU</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">],</span> <span class="nx">x</span><span class="p">[</span><span class="nx">j</span><span class="p">]));</span>
    <span class="p">}</span>
    <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">divide</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">LU</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">i</span><span class="p">]);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nx">b</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-347">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-347">&#182;</a>               </div>               <p>Backward solve Ux = y</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">some</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">some</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">some</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-348">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-348">&#182;</a>               </div>               <h3>Matrix.prototype.some()</h3>

<p>This function works like the Array.prototype.some function.
The matrix is processed row by row.
The function is called with the following arguments:
the entry at the current position, the number of the row,
the number of the column and the complete matrix</p>

<p><em>@param {function}</em> The function which is called on every argument <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">times</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">temp</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;rational&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">toNumber</span><span class="p">();</span> 
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">||</span> <span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">a</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;matrix&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cols</span> <span class="o">===</span> <span class="nx">a</span><span class="p">.</span><span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">temp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

          <span class="k">for</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">temp</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">temp</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">k</span><span class="p">],</span> <span class="nx">a</span><span class="p">[</span><span class="nx">k</span><span class="p">][</span><span class="nx">j</span><span class="p">]));</span>
          <span class="p">}</span>
          <span class="nx">res</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;point&#39;</span> <span class="o">||</span> <span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;vector&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cols</span> <span class="o">===</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">temp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">temp</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">temp</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">k</span><span class="p">],</span> <span class="nx">a</span><span class="p">[</span><span class="nx">k</span><span class="p">]));</span>
        <span class="p">}</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">temp</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">a</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-349">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-349">&#182;</a>               </div>               <h3>Matrix.prototype.times()</h3>

<p>Multiplies the current matrix with a number, a matrix, a point or a vector.</p>

<p><em>@param {number|matrix|point|rational|vector}</em> <br />
<em>@returns {matrix|point|vector}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toArray</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-350">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-350">&#182;</a>               </div>               <h3>Matrix.prototype.toArray()</h3>

<p>Converts the matrix to a two-dimensional array</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toColVectors</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">transpose</span><span class="p">().</span><span class="nx">toRowVectors</span><span class="p">();</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-351">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-351">&#182;</a>               </div>               <h3>Matrix.prototype.toColVectors()</h3>

<p>Converts the columns of the matrix to vectors</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toComplex</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span> <span class="o">!==</span> <span class="mi">2</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span> <span class="o">!==</span> <span class="mi">2</span> <span class="o">||</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="k">this</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="k">this</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-352">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-352">&#182;</a>               </div>               <h3>Matrix.prototype.toComplex()</h3>

<p>Transforms a 2x2 matrix into the corresponding complex number
(if the entries allow the transformation)</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toContentMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">str</span> <span class="o">+</span> <span class="nx">x</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
    <span class="p">},</span> <span class="s1">&#39;&lt;matrixrow&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/matrixrow&gt;&#39;</span><span class="p">;</span>
  <span class="p">},</span> <span class="s1">&#39;&lt;matrix&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/matrix&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-353">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-353">&#182;</a>               </div>               <h3>Matrix.prototype.toContentMathMLString()</h3>

<p>converting the matrix to content MathML</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toLaTeX</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;\\begin{pmatrix}\n&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">str</span> <span class="o">+</span> <span class="nx">x</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
    <span class="p">})</span> <span class="o">+</span> <span class="s1">&#39;\\\n&#39;</span><span class="p">;</span>
  <span class="p">},</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;\n\\end{pmatrix}&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-354">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-354">&#182;</a>               </div>               <h3>Matrix.prototype.toLaTeX()</h3>

<p>Converting the matrix to LaTeX</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">str</span> <span class="o">+</span> <span class="nx">x</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="s1">&#39;&lt;mtd&gt;&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="nx">cur</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mtd&gt;&#39;</span><span class="p">;</span>
    <span class="p">},</span> <span class="s1">&#39;&lt;mtr&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mtr&gt;&#39;</span><span class="p">;</span>
  <span class="p">},</span> <span class="s1">&#39;&lt;mrow&gt;&lt;mo&gt; ( &lt;/mo&gt;&lt;mtable&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mtable&gt;&lt;mo&gt; ) &lt;/mo&gt;&lt;/mrow&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-355">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-355">&#182;</a>               </div>               <h3>Matrix.prototype.toMathMLString()</h3>

<p>converting the matrix to (presentation) MathML</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toRowVectors</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Vector</span><span class="p">(</span><span class="nx">v</span><span class="p">);});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-356">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-356">&#182;</a>               </div>               <h3>Matrix.prototype.toRowVectors()</h3>

<p>Converts the rows of the matrix to vectors</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">str</span> <span class="o">+</span> <span class="nx">x</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="s1">&#39;\t&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
    <span class="p">})</span> <span class="o">+</span> <span class="s1">&#39;\n&#39;</span><span class="p">;</span>
  <span class="p">},</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-357">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-357">&#182;</a>               </div>               <h3>Matrix.prototype.toString()</h3>

<p>Creating a custom .toString() function</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">trace</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">trace</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">diag</span><span class="p">());</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">trace</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">trace</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">trace</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-358">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-358">&#182;</a>               </div>               <h3>Matrix.prototype.trace()</h3>

<p>Calculating the trace of the matrix</p>

<p><em>@returns {number|complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">transpose</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temp</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">transpose</span><span class="p">,</span>
      <span class="nx">help</span><span class="p">,</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">ii</span><span class="p">,</span> <span class="nx">jj</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cols</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">help</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">jj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">jj</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">help</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">help</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">transpose</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">temp</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">transpose</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">transpose</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">transpose</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-359">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-359">&#182;</a>               </div>               <h3>Matrix.prototype.transpose()</h3>

<p>Calculating the transpose of the matrix
The result is cached.</p>

<p><em>@returns {Matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">zero</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">r</span> <span class="o">=</span> <span class="nx">r</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
  <span class="nx">c</span> <span class="o">=</span> <span class="nx">c</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">.</span><span class="nx">numbers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
<span class="p">};</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-360">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-360">&#182;</a>               </div>               <h3>Matrix.zero()</h3>

<p>Returns a matrix consisting completely of zeros.</p>

<p><em>@param {number}</em> The number of rows. <br />
<em>@param {number}</em> The number of columns. <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Permutation</span> <span class="p">{</span>

  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;permutation&#39;</span><span class="p">;</span>

  <span class="nx">length</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">cycle</span><span class="o">:</span> <span class="nx">any</span><span class="p">[];</span>


  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">cycle</span><span class="p">,</span> <span class="nx">permutation</span><span class="p">;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span>
      <span class="nx">cycle</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
      <span class="nx">permutation</span> <span class="o">=</span> <span class="nx">Permutation</span><span class="p">.</span><span class="nx">cycleToList</span><span class="p">(</span><span class="nx">cycle</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">permutation</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
      <span class="nx">cycle</span> <span class="o">=</span> <span class="nx">Permutation</span><span class="p">.</span><span class="nx">listToCycle</span><span class="p">(</span><span class="nx">permutation</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">permutation</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">x</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">permutation</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">cycle</span> <span class="o">=</span> <span class="nx">cycle</span><span class="p">;</span>

  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-361">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-361">&#182;</a>               </div>               <h2><a id="Permutation"></a>Permutation</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">applyTo</span><span class="p">(</span><span class="nx">n</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">res</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">n</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">n</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="nx">n</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">res</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">n</span><span class="p">[</span><span class="nx">p</span><span class="p">.</span><span class="nx">applyTo</span><span class="p">(</span><span class="nx">i</span><span class="p">)];</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="nx">res</span> <span class="o">:</span> <span class="k">new</span> <span class="nx">n</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="nx">res</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-362">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-362">&#182;</a>               </div>               <h3>Permutation.prototype.applyTo()</h3>

<p>Applies the permutation to a number or a array/matrix/point/vector</p>

<p><em>@param {number|array|matrix|point|vector}</em> <br />
<em>@returns {number|array|matrix|point|vector}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">cycleToList</span><span class="p">(</span><span class="nx">cycle</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">number</span><span class="p">[]</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">cur</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">jj</span><span class="p">,</span> <span class="nx">max</span><span class="p">;</span>

  <span class="nx">max</span> <span class="o">=</span> <span class="nx">cycle</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
  <span class="p">});</span>
  <span class="nx">max</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">max</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="nx">max</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;=</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">cur</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">jj</span> <span class="o">=</span> <span class="nx">cycle</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">jj</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">index</span> <span class="o">=</span> <span class="nx">cycle</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">cur</span> <span class="o">=</span> <span class="nx">cycle</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">index</span> <span class="o">%</span> <span class="nx">cycle</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">length</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-363">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-363">&#182;</a>               </div>               <h3>Permutation.cycleToList()</h3>

<p>Converts a cycle representation to a list representation</p>

<p><em>@param{array}</em> cycle The cycle to be converted <br />
<em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">id</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Permutation</span><span class="p">([[]]);</span></pre></div>             </td>           </tr>                               <tr id="section-364">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-364">&#182;</a>               </div>               <h3>Permutation.id()</h3>

<p>The id permutation</p>

<p><em>@returns {permutation}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">inverse</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Permutation</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">cycle</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cycle</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="nx">cycle</span><span class="p">.</span><span class="nx">reverse</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Permutation</span><span class="p">(</span><span class="nx">cycle</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-365">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-365">&#182;</a>               </div>               <h3>Permutation.prototype.inverse()</h3>

<p>Calculates the inverse of the permutation</p>

<p><em>@returns {permutation}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">listToCycle</span><span class="p">(</span><span class="nx">list</span> <span class="o">:</span> <span class="nx">number</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">finished</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">cur</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">,</span> <span class="nx">temp</span><span class="p">,</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">cur</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
    <span class="nx">temp</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nx">finished</span><span class="p">[</span><span class="nx">cur</span><span class="p">])</span> <span class="p">{</span>
      <span class="nx">finished</span><span class="p">[</span><span class="nx">cur</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
      <span class="nx">cur</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span><span class="nx">cur</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">temp</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">temp</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-366">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-366">&#182;</a>               </div>               <h3>Permutation.listToCycle()</h3>

<p>Converts a list representation to a cycle representation</p>

<p><em>@param{array}</em> list The list to be converted <br />
<em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">map</span><span class="p">(...</span><span class="nx">args</span><span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">Permutation</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Permutation</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-367">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-367">&#182;</a>               </div>               <h3>Permutation.prototype.map()</h3>

<p>Works like Array.prototype.map.</p>

<p><em>@returns {permutation}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sgn</span><span class="p">()</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">cycle</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">count</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cycle</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">count</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cycle</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="nx">count</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-368">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-368">&#182;</a>               </div>               <h3>Permutation.prototype.sgn()</h3>

<p>Calculates the signum of the permutation</p>

<p><em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">times</span><span class="p">(</span><span class="nx">p</span> <span class="o">:</span> <span class="nx">Permutation</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Permutation</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">p</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">a</span><span class="p">[</span><span class="nx">x</span><span class="p">];</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-369">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-369">&#182;</a>               </div>               <h3>Permutation.prototype.times()</h3>

<p>Multiplies two permutations</p>

<p><em>@returns {permutation}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMatrix</span><span class="p">(</span><span class="nx">n</span> <span class="o">:</span> <span class="nx">number</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Matrix</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">temp</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
      <span class="nx">n</span> <span class="o">=</span> <span class="nx">n</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">arr</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="mi">1</span><span class="p">]).</span><span class="nx">concat</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">temp</span> <span class="o">=</span> <span class="nx">n</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">applyTo</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">temp</span><span class="p">,</span> <span class="nx">temp</span> <span class="o">+</span> <span class="nx">n</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-370">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-370">&#182;</a>               </div>               <h3>Permutation.prototype.times()</h3>

<p>Multiplies two permutations</p>

<p><em>@param{number}</em> [size] The size of the matrix <br />
<em>@returns {matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">cycle</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">elem</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-371">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-371">&#182;</a>               </div>               <h3>Permutation.prototype.toString()</h3>

<p>String representation of the permutation. </p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Point</span> <span class="kr">extends</span> <span class="nx">Vector</span> <span class="p">{</span>

  <span class="nx">dimension</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">coords</span><span class="o">:</span> <span class="nx">number</span><span class="p">[])</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="nx">coords</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;point&#39;</span><span class="p">;</span>

  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-372">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-372">&#182;</a>               </div>               <h2><a id="Point"></a>Point</h2>

<p>The point implementation of MathLib makes calculations with point in
arbitrary dimensions possible.</p>

<p>MathLib uses the homogeneous form of a point for calculations and storage.</p>

<p>To create the point (4, 2) on the two dimensional plane use
<code>new MathLib.Point([4, 2, 1])</code>
Alternatively you can use
<code>new MathLib.Point(4, 2)</code>
The 1 will be added for you.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">I</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Point</span><span class="p">([</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span></pre></div>             </td>           </tr>                               <tr id="section-373">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-373">&#182;</a>               </div>               <h3>Point.I</h3>

<p>The Point I = (-i, 0, 1).
This is NOT the complex number i.</p>

<p><em>@returns {point}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">J</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Point</span><span class="p">([</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span></pre></div>             </td>           </tr>                               <tr id="section-374">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-374">&#182;</a>               </div>               <h3>Point.J</h3>

<p>The Point J = (i, 0, 1).</p>

<p><em>@returns {point}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">crossRatio</span><span class="p">(</span><span class="nx">a</span> <span class="o">:</span> <span class="nx">Point</span><span class="p">,</span> <span class="nx">b</span> <span class="o">:</span> <span class="nx">Point</span><span class="p">,</span> <span class="nx">c</span> <span class="o">:</span> <span class="nx">Point</span><span class="p">,</span> <span class="nx">d</span> <span class="o">:</span> <span class="nx">Point</span><span class="p">)</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">xa</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">vectorProduct</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span>
      <span class="nx">xb</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">vectorProduct</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>

  <span class="k">return</span> <span class="nx">xa</span><span class="p">.</span><span class="nx">scalarProduct</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">*</span><span class="nx">xb</span><span class="p">.</span><span class="nx">scalarProduct</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">xa</span><span class="p">.</span><span class="nx">scalarProduct</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">*</span> <span class="nx">xb</span><span class="p">.</span><span class="nx">scalarProduct</span><span class="p">(</span><span class="nx">c</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-375">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-375">&#182;</a>               </div>               <h3>Point.prototype.crossRatio()</h3>

<p>Calculates the distance crossratio (A,B,C,D) of four points
as seen from the current point.</p>

<p><em>@param {point}</em> a The point A <br />
<em>@param {point}</em> b The point B <br />
<em>@param {point}</em> c The point C <br />
<em>@param {point}</em> d The point D <br />
<em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">distanceTo</span><span class="p">(</span><span class="nx">point</span> <span class="o">:</span> <span class="nx">Point</span><span class="p">)</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">hypot</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">dimension</span><span class="p">]);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">point</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;point&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">===</span> <span class="nx">point</span><span class="p">.</span><span class="nx">dimension</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">hypot</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">normalize</span><span class="p">().</span><span class="nx">minus</span><span class="p">(</span><span class="nx">point</span><span class="p">.</span><span class="nx">normalize</span><span class="p">()).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-376">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-376">&#182;</a>               </div>               <h3>Point.prototype.distanceTo()</h3>

<p>Calculates the distance to an other point.
If no other point is provided, it calculates the distance to the origin.</p>

<p><em>@param {point}</em> [point] The point to calculate the distance to <br />
<em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">draw</span><span class="p">(</span><span class="nx">screen</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">screen</span><span class="p">))</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">point</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">screen</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">x</span><span class="p">.</span><span class="nx">point</span><span class="p">(</span><span class="nx">point</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">screen</span><span class="p">.</span><span class="nx">point</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-377">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-377">&#182;</a>               </div>               <h3>Point.prototype.draw()</h3>

<p>Draws the point on a canvas or svg element.</p>

<p><em>@param {MathLib.screen object}</em> screen The screen to draw onto <br />
<em>@param {object}</em> [options] Drawing options <br />
<em>@returns {point}</em> The current point</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEqual</span><span class="p">(</span><span class="nx">q</span> <span class="o">:</span> <span class="nx">Point</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">normalize</span><span class="p">();</span>
  <span class="nx">q</span> <span class="o">=</span> <span class="nx">q</span><span class="p">.</span><span class="nx">normalize</span><span class="p">();</span>

  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="nx">q</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">p</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">q</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-378">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-378">&#182;</a>               </div>               <h3>Point.prototype.isEqual()</h3>

<p>Determines if the point has the same coordinates as an other point</p>

<p><em>@param {point}</em> The point to compare
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">isFinite</span><span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-379">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-379">&#182;</a>               </div>               <h3>Point.prototype.isFinite()</h3>

<p>Determines if the point is finite</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isInside</span><span class="p">(</span><span class="nx">a</span> <span class="o">:</span> <span class="nx">Circle</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;circle&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">distanceTo</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">center</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-380">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-380">&#182;</a>               </div>               <h3>Point.prototype.isInside()</h3>

<p>Determines wether a point is inside a circle</p>

<p><em>@param {circle}</em>
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isOn</span><span class="p">(</span><span class="nx">a</span> <span class="o">:</span> <span class="nx">Circle</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">distanceTo</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">center</span><span class="p">)</span> <span class="o">===</span> <span class="nx">a</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;circle&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">distanceTo</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">center</span><span class="p">)</span> <span class="o">===</span> <span class="nx">a</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-381">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-381">&#182;</a>               </div>               <h3>Point.prototype.isOn()</h3>

<p>Determines wether a point is on a line or circle</p>

<p><em>@param {line|point}</em>
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isOutside</span><span class="p">(</span><span class="nx">a</span> <span class="o">:</span> <span class="nx">Circle</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;circle&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">distanceTo</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">center</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">radius</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-382">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-382">&#182;</a>               </div>               <h3>Point.prototype.isOutside()</h3>

<p>Determines wether a point is outside a circle</p>

<p><em>@param {circle}</em>
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">lineTo</span><span class="p">(</span><span class="nx">q</span> <span class="o">:</span> <span class="nx">Point</span><span class="p">,</span> <span class="nx">dyn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Line</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">line</span><span class="p">,</span>
      <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">===</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">q</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">line</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Line</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">vectorProduct</span><span class="p">(</span><span class="nx">q</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">dyn</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperties</span><span class="p">(</span><span class="nx">line</span><span class="p">,</span> <span class="p">{</span>
        <span class="s2">&quot;0&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">get</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="nx">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nx">q</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="p">},</span>
          <span class="nx">set</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span>
          <span class="nx">enumerable</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">configurable</span> <span class="o">:</span> <span class="kc">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;1&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">get</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nx">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">q</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="p">},</span>
          <span class="nx">set</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span>
          <span class="nx">enumerable</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">configurable</span> <span class="o">:</span> <span class="kc">true</span>
        <span class="p">},</span>
        <span class="s2">&quot;2&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">get</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nx">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nx">q</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="p">},</span>
          <span class="nx">set</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span>
          <span class="nx">enumerable</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">configurable</span> <span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">line</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-383">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-383">&#182;</a>               </div>               <h3>Point.prototype.lineTo()</h3>

<p>Calculates a line connecting two points</p>

<p><em>@param {point}</em> The point to calculate the line to
<em>@returns {line}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">normalize</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Point</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">last</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">dimension</span><span class="p">]</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">/</span> <span class="nx">last</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-384">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-384">&#182;</a>               </div>               <h3>Point.prototype.normalize()</h3>

<p>Normalizes the point.</p>

<p><em>@returns {point}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">reflectAt</span><span class="p">(</span><span class="nx">a</span> <span class="o">:</span> <span class="nx">Point</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Point</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;point&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">===</span> <span class="nx">a</span><span class="p">.</span><span class="nx">dimension</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">i</span><span class="p">,</span>
          <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">normalize</span><span class="p">();</span>
      <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">normalize</span><span class="p">();</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">dimension</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">-</span> <span class="nx">p</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span>
      <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-385">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-385">&#182;</a>               </div>               <h3>Point.prototype.reflectAt()</h3>

<p>Reflects the point at an other point</p>

<p><em>@returns {point}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toComplex</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Complex</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dimension</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">.</span><span class="nx">infinity</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Complex</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="k">this</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="k">this</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="k">this</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-386">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-386">&#182;</a>               </div>               <h3>Point.prototype.toComplex()</h3>

<p>Converts a two dimensional point to the corresponding complex number.</p>

<p><em>@returns {complex}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/* toContentMathMLString(opt) { */</span>
<span class="cm">/* } */</span></pre></div>             </td>           </tr>                               <tr id="section-387">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-387">&#182;</a>               </div>               <h3>Point.prototype.toContentMathMLString()</h3>

<p>Returns content MathML representation of the point</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toLaTeX</span><span class="p">(</span><span class="nx">opt</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">opt</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">normalize</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>

  <span class="k">return</span> <span class="s1">&#39;\\begin{pmatrix}&#39;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="s1">&#39;\\\\&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
  <span class="p">})</span> <span class="o">+</span> <span class="s1">&#39;\\end{pmatrix}&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-388">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-388">&#182;</a>               </div>               <h3>Point.prototype.toLaTeX()</h3>

<p>Returns LaTeX representation of the point</p>

<p><em>@returns {boolean}</em> Optional parameter to indicate if the output should be projective.
<em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMathMLString</span><span class="p">(</span><span class="nx">opt</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">opt</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">normalize</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>

  <span class="k">return</span> <span class="nx">p</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="s1">&#39;&lt;mtr&gt;&lt;mtd&gt;&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="nx">cur</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mtd&gt;&lt;/mtr&gt;&#39;</span><span class="p">;</span>
  <span class="p">},</span> <span class="s1">&#39;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mtable&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mtable&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-389">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-389">&#182;</a>               </div>               <h3>Point.prototype.toMathMLString()</h3>

<p>Returns (presentation) MathML representation of the point</p>

<p><em>@returns {boolean}</em> Optional parameter to indicate if the output should be projective.
<em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toString</span><span class="p">(</span><span class="nx">opt</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">opt</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">normalize</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>

  <span class="k">return</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
  <span class="p">})</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-390">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-390">&#182;</a>               </div>               <h3>Point.prototype.toString()</h3>

<p>Returns string representation of the point</p>

<p><em>@returns {boolean}</em> Optional parameter to indicate if the output should be projective.
<em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-391">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-391">&#182;</a>               </div>               <h2><a id="Polynomial"></a>Polynomial</h2>

<p>The polynomial implementation of MathLib makes calculations with polynomials.
Both the coefficients and the arguments of a polynomial can be numbers,
complex numbers and matrices.</p>

<p>It is as easy as
<code>
new MathLib.Polynomial([1, 2, 3])
</code>
to create the polynomial 1 + 2x + 3x <br />
The polynomial x can be created with the following statement:
<code>
new MathLib.Polynomial(100)
</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Polynomial</span> <span class="p">{</span>

  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">;</span>

  <span class="nx">deg</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">length</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">subdeg</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">polynomial</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">temp</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">polynomial</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">polynomial</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">polynomial</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">polynomial</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span><span class="nx">polynomial</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
      <span class="nx">polynomial</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">polynomial</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">x</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x</span><span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">polynomial</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">deg</span> <span class="o">=</span> <span class="nx">polynomial</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">subdeg</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
          <span class="k">while</span><span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">Infinity</span><span class="p">;</span>
      <span class="p">}(</span><span class="nx">polynomial</span><span class="p">));</span>

  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-392">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-392">&#182;</a>               </div>               <p>declare var Polynomial : any;</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">differentiate</span><span class="p">(</span><span class="nx">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Polynomial</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temparr</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="nx">i</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">integrate</span><span class="p">(</span><span class="o">-</span><span class="nx">n</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">deg</span> <span class="o">-</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">temparr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">n</span><span class="p">],</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">fallingFactorial</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">n</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">(</span><span class="nx">temparr</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-393">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-393">&#182;</a>               </div>               <h3>Polynomial.prototype.differentiate()</h3>

<p>Differentiates the polynomial</p>

<p><em>@param {number}</em> [n] the number of times to differentiate the polynomial. <br />
<em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">draw</span><span class="p">(</span><span class="nx">screen</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">i</span><span class="p">,</span>
      <span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">screen</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">screen</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">x</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="nx">line</span><span class="p">.</span><span class="nx">valueAt</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">)],</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="nx">line</span><span class="p">.</span><span class="nx">valueAt</span><span class="p">(</span><span class="mi">50</span><span class="p">)]],</span> <span class="nx">options</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">screen</span><span class="p">.</span><span class="nx">line</span><span class="p">([[</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueAt</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">)],</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueAt</span><span class="p">(</span><span class="mi">50</span><span class="p">)]],</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">else</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">;</span> <span class="nx">i</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nx">i</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">path</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">i</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)]);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">screen</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">screen</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">screen</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-394">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-394">&#182;</a>               </div>               <h3>Polynomial.prototype.draw()</h3>

<p>Draws the polynomial on the screen</p>

<p><em>@param {screen}</em> The screen to draw the polynomial onto. <br />
<em>@param {object}</em> [options] Optional drawing options. <br />
<em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">every</span><span class="p">(</span><span class="nx">f</span> <span class="o">:</span> <span class="p">(</span><span class="nx">value</span> <span class="o">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">index</span> <span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">vector</span> <span class="o">:</span> <span class="nx">Vector</span> <span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">bool</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">every</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">f</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-395">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-395">&#182;</a>               </div>               <h3>Polynomial.prototype.every()</h3>

<p>Works like Array.prototype.every.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">forEach</span><span class="p">()</span> <span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
  <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">forEach</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-396">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-396">&#182;</a>               </div>               <h3>Polynomial.prototype.forEach()</h3>

<p>Works like the Array.prototype.forEach function</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">integrate</span><span class="p">(</span><span class="nx">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Polynomial</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temparr</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">i</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">n</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">differentiate</span><span class="p">(</span><span class="o">-</span><span class="nx">n</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">temparr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">temparr</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">n</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">/</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">fallingFactorial</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">n</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">(</span><span class="nx">temparr</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-397">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-397">&#182;</a>               </div>               <h3>Polynomial.prototype.integrate()</h3>

<p>Integrates the polynomial</p>

<p><em>@param {number}</em> [n] the number of times to integrate the polynomial. <br />
<em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">interpolation</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temp</span><span class="p">,</span>
      <span class="nx">res</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
      <span class="nx">n</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">;</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">[</span><span class="nx">x</span><span class="p">,</span> <span class="nx">b</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">([</span><span class="mi">1</span><span class="p">]);</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">!==</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">temp</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">([</span><span class="o">-</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])]));</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">res</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">temp</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]));</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-398">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-398">&#182;</a>               </div>               <h3>Polynomial.interpolation</h3>

<p>Interpolates points.</p>

<p><em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEqual</span><span class="p">(</span><span class="nx">p</span> <span class="o">:</span> <span class="nx">Polynomial</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span> <span class="o">!==</span> <span class="nx">p</span><span class="p">.</span><span class="nx">deg</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">subdeg</span> <span class="o">!==</span> <span class="nx">p</span><span class="p">.</span><span class="nx">subdeg</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;=</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">p</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-399">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-399">&#182;</a>               </div>               <h3>Polynomial.prototype.isEqual()</h3>

<p>Decides if two polynomials are equal.</p>

<p><em>@param {polynomial}</em> <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">map</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Polynomial</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">f</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-400">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-400">&#182;</a>               </div>               <h3>Polynomial.prototype.map()</h3>

<p>Works like the Array.prototype.map function</p>

<p><em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">negative</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Polynomial</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-401">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-401">&#182;</a>               </div>               <h3>Polynomial.prototype.negative()</h3>

<p>Returns the negative polynomial</p>

<p><em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">one</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Polynomial</span><span class="p">([</span><span class="mi">1</span><span class="p">]);</span></pre></div>             </td>           </tr>                               <tr id="section-402">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-402">&#182;</a>               </div>               <h3>Polynomial.one</h3>

<p>Returns the one polynomial</p>

<p><em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">plus</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Polynomial</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temparr</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">i</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">temparr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">();</span>
    <span class="nx">temparr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">temparr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">a</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">,</span> <span class="nx">a</span><span class="p">.</span><span class="nx">deg</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">temparr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span>  <span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="nx">temparr</span> <span class="o">=</span> <span class="nx">temparr</span><span class="p">.</span><span class="nx">concat</span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span> <span class="o">&gt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">deg</span> <span class="o">?</span> <span class="k">this</span> <span class="o">:</span> <span class="nx">a</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">(</span><span class="nx">temparr</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-403">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-403">&#182;</a>               </div>               <h3>Polynomial.prototype.plus()</h3>

<p>Adds a number or a polynomial</p>

<p><em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">regression</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Polynomial</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="nx">xy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">xi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">yi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">x2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">m</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">xy</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">y</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">xi</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">yi</span> <span class="o">+=</span> <span class="nx">y</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">x2</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">xy</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
      <span class="nx">xi</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
      <span class="nx">yi</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
      <span class="nx">x2</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">m</span> <span class="o">=</span> <span class="p">(</span><span class="nx">length</span> <span class="o">*</span> <span class="nx">xy</span> <span class="o">-</span> <span class="nx">xi</span> <span class="o">*</span> <span class="nx">yi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">length</span> <span class="o">*</span> <span class="nx">x2</span> <span class="o">-</span> <span class="nx">xi</span> <span class="o">*</span> <span class="nx">xi</span><span class="p">);</span>
  <span class="nx">c</span> <span class="o">=</span> <span class="p">(</span><span class="nx">yi</span> <span class="o">*</span> <span class="nx">x2</span> <span class="o">-</span> <span class="nx">xy</span> <span class="o">*</span> <span class="nx">xi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">length</span> <span class="o">*</span> <span class="nx">x2</span> <span class="o">-</span> <span class="nx">xi</span> <span class="o">*</span> <span class="nx">xi</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">([</span><span class="nx">c</span><span class="p">,</span> <span class="nx">m</span><span class="p">]);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-404">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-404">&#182;</a>               </div>               <h3>Polynomial.regression</h3>

<p>Calculates the regression line for some points</p>

<p><em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">roots</span><span class="p">(</span><span class="nx">zeros</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Polynomial</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temp</span><span class="p">,</span> <span class="nx">coef</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">zeros</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;array&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">zeros</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">zeros</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">temp</span> <span class="o">=</span> <span class="nx">zeros</span><span class="p">.</span><span class="nx">powerset</span><span class="p">();</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="nx">zeros</span><span class="p">.</span><span class="nx">card</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">coef</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-405">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-405">&#182;</a>               </div>               <h3>Polynomial.roots</h3>

<p>Returns a polynomial with the specified roots</p>

<p><em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">temp</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">coef</span><span class="p">[</span><span class="nx">ii</span><span class="o">-</span><span class="nx">x</span><span class="p">.</span><span class="nx">card</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">coef</span><span class="p">[</span><span class="nx">ii</span><span class="o">-</span><span class="nx">x</span><span class="p">.</span><span class="nx">card</span><span class="p">],</span> <span class="nx">x</span><span class="p">.</span><span class="nx">times</span><span class="p">());</span>
  <span class="p">});</span>

  <span class="nx">coef</span> <span class="o">=</span> <span class="nx">coef</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">((</span><span class="nx">ii</span><span class="o">-</span><span class="nx">i</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">negative</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="nx">coef</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">(</span><span class="nx">coef</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-406">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-406">&#182;</a>               </div>               <p>Vieta's theorem</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">slice</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[]</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-407">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-407">&#182;</a>               </div>               <h3>Polynomial.prototype.slice()</h3>

<p>Works like the Array.prototype.slice function</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">tangent</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Polynomial</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueAt</span><span class="p">(</span><span class="nx">p</span><span class="p">),</span>
      <span class="nx">slope</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">differentiate</span><span class="p">().</span><span class="nx">valueAt</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">([</span><span class="nx">value</span> <span class="o">-</span> <span class="nx">slope</span> <span class="o">*</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">slope</span><span class="p">]);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-408">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-408">&#182;</a>               </div>               <h3>Polynomial.prototype.tangent()</h3>

<p>Returns the tangent to the polynomial at a given point</p>

<p><em>@param{number}</em> The x-value of the point. <br />
<em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">times</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Polynomial</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temparr</span> <span class="o">=</span> <span class="p">[],</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">;</span>
      
  <span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;rational&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">toNumber</span><span class="p">();</span> 
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">deg</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">temparr</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">((</span><span class="nx">temparr</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">j</span><span class="p">]</span> <span class="o">?</span> <span class="nx">temparr</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">j</span><span class="p">]</span> <span class="o">:</span> <span class="mi">0</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]));</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Polynomial</span><span class="p">(</span><span class="nx">temparr</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>  <span class="c1">// we we multiply it to every coefficient</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
                      <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-409">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-409">&#182;</a>               </div>               <h3>Polynomial.prototype.times()</h3>

<p>Multiplies the polynomial by a number or an other polynomial  </p>

<p><em>@param{number|Polynomial}</em> The multiplicator <br />
<em>@returns {Polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="nx">math</span><span class="p">)</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;apply&gt;&lt;plus/&gt;&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">;</span> <span class="nx">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;&lt;apply&gt;&lt;times/&gt;&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;&lt;apply&gt;&lt;power/&gt;&lt;ci&gt;x&lt;/ci&gt;&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/apply&gt;&lt;/apply&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;&lt;ci&gt;x&lt;/ci&gt;&lt;/apply&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/apply&gt;&#39;</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">math</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;complexes/&gt;&lt;/domainofapplication&gt;&#39;</span> <span class="o">+</span> <span class="nx">str</span> <span class="o">+</span> <span class="s1">&#39;&lt;/lambda&gt;&lt;/math&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-410">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-410">&#182;</a>               </div>               <h3>Polynomial.prototype.toContentMathMLString()</h3>

<p>Returns a content MathML representation of the polynomial</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toFunctn</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;=</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;* Math.pow(x,&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;*x&#39;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Functn</span><span class="p">(</span><span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;return &#39;</span> <span class="o">+</span> <span class="nx">str</span><span class="p">),</span> <span class="p">{</span><span class="nx">contentMathMLString</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="kc">true</span><span class="p">)});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-411">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-411">&#182;</a>               </div>               <h3>Polynomial.prototype.toFunctn()</h3>

<p>Converts the polynomial to a functn</p>

<p><em>@returns {Functn}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toLaTeX</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;x^{&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">deg</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">,</span>
      <span class="nx">i</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-412">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-412">&#182;</a>               </div>               <h3>Polynomial.prototype.toLaTeX()</h3>

<p>Returns a LaTeX representation of the polynomial</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">str</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-413">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-413">&#182;</a>               </div>               <p>if(i === 0) {
  str += MathLib.toLaTeX(this[i]);
}
else {</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;x^{&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;x&#39;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-414">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-414">&#182;</a>               </div>               <p>}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMathMLString</span><span class="p">(</span><span class="nx">math</span><span class="p">)</span> <span class="o">:</span><span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;mrow&gt;&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&lt;mo&gt;&amp;#x2062;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/msup&gt;&#39;</span><span class="p">,</span>
      <span class="nx">i</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-415">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-415">&#182;</a>               </div>               <h3>Polynomial.prototype.toMathMLString()</h3>

<p>Returns a MathML representation of the polynomial</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">str</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-416">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-416">&#182;</a>               </div>               <p>if(i === 0) {
  str += MathLib.toMathML(this[i]);
}
else {</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;&lt;mo&gt;&amp;#x2062;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/msup&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;&lt;mo&gt;&amp;#x2062;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/mrow&gt;&#39;</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">math</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">str</span> <span class="o">+</span> <span class="s1">&#39;&lt;/math&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-417">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-417">&#182;</a>               </div>               <p>}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toString</span><span class="p">(</span><span class="nx">opt</span><span class="p">)</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;*x^&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">,</span>
      <span class="nx">i</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>

      <span class="nx">str</span> <span class="o">+=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;*x^&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;*x&#39;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-418">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-418">&#182;</a>               </div>               <h3>Polynomial.prototype.toString()</h3>

<p>Custom toString function</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">valueAt</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">pot</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="s1">&#39;matrix&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">.</span><span class="nx">identity</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">rows</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">cols</span><span class="p">)</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="nx">res</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="s1">&#39;matrix&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">.</span><span class="nx">zero</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">rows</span><span class="p">,</span> <span class="nx">x</span><span class="p">.</span><span class="nx">cols</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">;</span>
  
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">deg</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;=</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">res</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">pot</span><span class="p">));</span>
    <span class="nx">pot</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">pot</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-419">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-419">&#182;</a>               </div>               <h3>Polynomial.prototype.valueAt()</h3>

<p>Evaluates the polynomial at a given point </p>

<p><em>@param {number|complex|matrix}</em> <br />
<em>@returns {number|complex|matrix}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">zero</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Polynomial</span><span class="p">([</span><span class="mi">0</span><span class="p">]);</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-420">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-420">&#182;</a>               </div>               <h3>Polynomial.zero</h3>

<p>Returns the zero polynomial</p>

<p><em>@returns {polynomial}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Rational</span> <span class="p">{</span>

  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;rational&#39;</span><span class="p">;</span>

  <span class="nx">numerator</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">denominator</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">numerator</span><span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">denominator</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="nx">denominator</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="s1">&#39;The denominator cannot be zero.&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numerator</span> <span class="o">=</span> <span class="nx">numerator</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">denominator</span> <span class="o">=</span> <span class="nx">denominator</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-421">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-421">&#182;</a>               </div>               <h2><a id="Rational" href="http://mathlib.de/en/docs/rational">Rational</a></h2>

<p>MathLib.Rational is the MathLib implementation of rational numbers.</p>

<h4>Simple use case:</h4>

<p><code>
// Create the rational number 2/3 <br />
var r = new MathLib.Rational(2, 3); <br />
</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">divide</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;rational&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">denominator</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">numerator</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">r</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">,</span> <span class="nx">r</span><span class="p">));</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-422">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-422">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/divide">Rational.prototype.divide()</a></h3>

<p>Divides rational numbers</p>

<p><em>@param {Rational, number}</em> The divisor <br />
<em>@returns {Rational}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">r</span><span class="p">.</span><span class="nx">inverse</span><span class="p">().</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-423">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-423">&#182;</a>               </div>               <p>For complex numbers</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">inverse</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Rational</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-424">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-424">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/inverse">Rational.prototype.inverse()</a></h3>

<p>Calculates the inverse of a rational number</p>

<p><em>@returns {Rational}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEqual</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">denominator</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">numerator</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-425">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-425">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/isEqual">Rational.prototype.isEqual()</a></h3>

<p>Checks if the rational number is equal to an other number</p>

<p><em>@returns {bool}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isZero</span><span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isZero</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-426">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-426">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/isZero">Rational.prototype.isZero()</a></h3>

<p>Checks if the rational number is zero</p>

<p><em>@returns {bool}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">minus</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">,</span>
      <span class="nx">d</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;rational&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">denominator</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">numerator</span><span class="p">)),</span>
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">denominator</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">r</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">d</span><span class="p">)),</span> <span class="nx">d</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-427">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-427">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/minus">Rational.prototype.minus()</a></h3>

<p>Subtracts rational numbers</p>

<p><em>@param {Rational|number}</em> The number to be subtracted <br />
<em>@returns {Rational}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">r</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">negative</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-428">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-428">&#182;</a>               </div>               <p>For complex numbers</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">negative</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Rational</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-429">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-429">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/negative">Rational.prototype.negative()</a></h3>

<p>Calculates the negative of a rational number</p>

<p><em>@returns {Rational}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">plus</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">,</span>
      <span class="nx">d</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;rational&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">numerator</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">denominator</span><span class="p">)),</span>
      <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">denominator</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">r</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">d</span><span class="p">)),</span> <span class="nx">d</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-430">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-430">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/plus">Rational.prototype.plus()</a></h3>

<p>Adds rational numbers</p>

<p><em>@param {Rational, number}</em> The number to be added <br />
<em>@returns {Rational}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">r</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-431">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-431">&#182;</a>               </div>               <p>For complex numbers</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">reduce</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Rational</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gcd</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">)</span> <span class="o">*</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">gcd</span><span class="p">([</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">]);</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="o">/</span><span class="nx">gcd</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="o">/</span><span class="nx">gcd</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-432">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-432">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/reduce">Rational.prototype.reduce()</a></h3>

<p>Reduces the rational number</p>

<p><em>@returns {Rational}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">times</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;rational&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">numerator</span><span class="p">),</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">denominator</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">r</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Rational</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">,</span> <span class="nx">r</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-433">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-433">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/times">Rational.prototype.times()</a></h3>

<p>Multiplies rational numbers</p>

<p><em>@param {Rational, number}</em> The number to be multiplied <br />
<em>@returns {Rational}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">r</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-434">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-434">&#182;</a>               </div>               <p>For complex numbers, matrices, vectors, polynomials</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toContentMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nb">String</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;&lt;cn type=&quot;rational&quot;&gt;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">numerator</span> <span class="o">+</span> <span class="s1">&#39;&lt;sep/&gt;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">denominator</span> <span class="o">+</span> <span class="s1">&#39;&lt;/cn&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-435">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-435">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/toContentMathMLString">Rational.prototype.toContentMathMLString()</a></h3>

<p>Returns the Content MathML representation of the rational number</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toLaTeX</span><span class="p">()</span> <span class="o">:</span> <span class="nb">String</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;\\frac{&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}{&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-436">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-436">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/toLaTeX">Rational.prototype.toLaTeX()</a></h3>

<p>Returns the LaTeX representation of the rational number</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nb">String</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;&lt;mfrac&gt;&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">)</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/mfrac&gt;&#39;</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-437">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-437">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/toMathMLString">Rational.prototype.toMathMLString()</a></h3>

<p>Returns the MathML representation of the rational number</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toNumber</span><span class="p">()</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">numerator</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-438">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-438">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/toNumber">Rational.prototype.toNumber()</a></h3>

<p>Returns the number represented by the rational number</p>

<p><em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toString</span><span class="p">()</span> <span class="o">:</span> <span class="nb">String</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numerator</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">denominator</span><span class="p">);</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-439">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-439">&#182;</a>               </div>               <h3><a href="http://mathlib.de/en/docs/rational/toString">Rational.prototype.toString()</a></h3>

<p>Custom toString function</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">export</span> <span class="kr">class</span> <span class="nx">Set</span> <span class="p">{</span>

  <span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;set&#39;</span><span class="p">;</span>

  <span class="nx">length</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nx">card</span><span class="o">:</span> <span class="nx">number</span><span class="p">;</span>

  <span class="nx">constructor</span> <span class="p">(</span><span class="nx">elements</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">elements</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">elements</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="p">}</span>
    <span class="nx">elements</span> <span class="o">=</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">compare</span><span class="p">);</span>
    
    <span class="nx">elements</span> <span class="o">=</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">x</span> <span class="o">!==</span> <span class="nx">a</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
    <span class="p">});</span>

    <span class="nx">elements</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">x</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">card</span> <span class="o">=</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-440">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-440">&#182;</a>               </div>               <h2><a id="Set"></a>Set</h2>

<p>To generate the set {1, 2, 3, 4, 5} you simply need to type
<code>
new MathLib.Set([1, 2, 3, 4, 5])
</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">compare</span><span class="p">(</span><span class="nx">x</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">card</span> <span class="o">!==</span> <span class="nx">x</span><span class="p">.</span><span class="nx">card</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">card</span> <span class="o">-</span> <span class="nx">x</span><span class="p">.</span><span class="nx">card</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">stop</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">stop</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">a</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">res</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span>
          <span class="nx">stop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-441">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-441">&#182;</a>               </div>               <h3>Set.prototype.compare()</h3>

<p>Compare function for sets</p>

<p><em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">every</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">every</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-442">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-442">&#182;</a>               </div>               <h3>Set.prototype.every()</h3>

<p>Works like the Array.prototype.every function</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">filter</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">Set</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">filter</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-443">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-443">&#182;</a>               </div>               <h3>Set.prototype.filter()</h3>

<p>Works like the Array.prototype.filter function</p>

<p><em>@returns {set}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">forEach</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="k">void</span> <span class="p">{</span>
  <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">forEach</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-444">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-444">&#182;</a>               </div>               <h3>Set.prototype.forEach()</h3>

<p>Works like the Array.prototype.forEach function</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">static</span> <span class="nx">fromTo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">f</span> <span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">t</span> <span class="o">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">s</span> <span class="o">:</span> <span class="nx">number</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Set</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">f</span> <span class="o">&lt;=</span> <span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">f</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">t</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-445">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-445">&#182;</a>               </div>               <h3>Set.prototype.fromTo()</h3>

<p>Creates a set containing the numbers from a start value to a end value.</p>

<p><em>@param {number}</em> The number to start from <br />
<em>@param {number}</em> The number to end with <br />
<em>@param {number}</em> The stepsize (default = 1) <br />
<em>@returns {set}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">indexOf</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-446">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-446">&#182;</a>               </div>               <h3>Set.prototype.indexOf()</h3>

<p>Works like the Array.prototype.indexOf function</p>

<p><em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">insert</span><span class="p">(</span><span class="nx">x</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Set</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">locate</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">card</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-447">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-447">&#182;</a>               </div>               <h3>Set.prototype.insert()</h3>

<p>Inserts an element into the set.</p>

<p><em>@returns {set}</em> Returns the current set</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEmpty</span><span class="p">()</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">card</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-448">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-448">&#182;</a>               </div>               <h3>Set.prototype.isEmpty()</h3>

<p>Determines if the set is empty.</p>

<p><em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isEqual</span><span class="p">(</span><span class="nx">x</span> <span class="o">:</span> <span class="nx">Set</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">card</span> <span class="o">!==</span> <span class="nx">x</span><span class="p">.</span><span class="nx">card</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">x</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-449">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-449">&#182;</a>               </div>               <h3>Set.prototype.isEqual()</h3>

<p>Determines if the set is equal to an other set.</p>

<p><em>@param {set}</em> The set to compare <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">isSubsetOf</span><span class="p">(</span><span class="nx">a</span> <span class="o">:</span> <span class="nx">Set</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-450">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-450">&#182;</a>               </div>               <h3>Set.prototype.isSubsetOf()</h3>

<p>Determines if the set is a subset of an other set.</p>

<p><em>@param {set}</em> The potential superset <br />
<em>@returns {boolean}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">locate</span><span class="p">(</span><span class="nx">x</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">number</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">right</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">card</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
      <span class="nx">middle</span><span class="p">,</span>
      <span class="nx">i</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">while</span> <span class="p">(</span><span class="nx">left</span> <span class="o">&lt;=</span> <span class="nx">right</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">middle</span> <span class="o">=</span> <span class="nx">left</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="nx">right</span> <span class="o">-</span> <span class="nx">left</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">middle</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">left</span> <span class="o">=</span> <span class="nx">middle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">middle</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">right</span> <span class="o">=</span> <span class="nx">middle</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">middle</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">left</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-451">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-451">&#182;</a>               </div>               <h3>Set.prototype.locate()</h3>

<p>Array.prototype.indexOf() returns only the position of an element in the
array and not the position where one should be inserted.</p>

<p><em>@param {set}</em> The element to locate <br />
<em>@returns {number}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">map</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">));</span>
<span class="p">}</span>


<span class="nx">plus</span><span class="p">(</span><span class="nx">n</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;set&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">n</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">));</span>
        <span class="p">});</span>
      <span class="p">});</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">n</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-452">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-452">&#182;</a>               </div>               <h3>Set.prototype.map()</h3>

<p>Works like the Array.prototype.map function</p>

<p><em>@param {function}</em> The mapping function <br />
<em>@returns {set}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">powerset</span><span class="p">()</span> <span class="o">:</span> <span class="nx">Set</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">arr</span><span class="p">,</span> <span class="nx">temp</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ii</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">jj</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">card</span><span class="p">);</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">arr</span> <span class="o">=</span> <span class="nx">i</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">reverse</span><span class="p">();</span>
    <span class="nx">temp</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">jj</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">card</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">jj</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">temp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">temp</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-453">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-453">&#182;</a>               </div>               <h3>Set.prototype.powerset()</h3>

<p>Returns the powerset</p>

<p><em>@returns {set}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">reduce</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reduce</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-454">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-454">&#182;</a>               </div>               <h3>Set.prototype.reduce()</h3>

<p>Works like the Array.prototype.reduce function</p>

<p><em>@returns {any}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">remove</span><span class="p">(</span><span class="nx">a</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Set</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">card</span><span class="o">--</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>


<span class="kr">static</span> <span class="nx">createSetOperation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">both</span><span class="p">,</span> <span class="nx">right</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">tl</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">card</span><span class="p">,</span>
        <span class="nx">al</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">card</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">tl</span> <span class="o">&amp;&amp;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">al</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">left</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">right</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nx">j</span><span class="o">++</span><span class="p">;</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">both</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
        <span class="nx">j</span><span class="o">++</span><span class="p">;</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">left</span> <span class="o">&amp;&amp;</span> <span class="nx">j</span> <span class="o">===</span> <span class="nx">al</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">right</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">===</span> <span class="nx">tl</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">j</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="nx">union</span> <span class="o">=</span> <span class="nx">Set</span><span class="p">.</span><span class="nx">createSetOperation</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">intersect</span> <span class="o">=</span> <span class="nx">Set</span><span class="p">.</span><span class="nx">createSetOperation</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="nx">without</span> <span class="o">=</span> <span class="nx">Set</span><span class="p">.</span><span class="nx">createSetOperation</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="nx">xor</span> <span class="o">=</span> <span class="nx">Set</span><span class="p">.</span><span class="nx">createSetOperation</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-455">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-455">&#182;</a>               </div>               <h3>Set.prototype.remove()</h3>

<p>Removes a element from a set</p>

<p><em>@returns {set}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">slice</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-456">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-456">&#182;</a>               </div>               <h3>Set.prototype.slice()</h3>

<p>Works like the Array.prototype.slice function</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">splice</span><span class="p">(...</span><span class="nx">args</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">splice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-457">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-457">&#182;</a>               </div>               <h3>Set.prototype.splice()</h3>

<p>Works like the Array.prototype.splice function</p>

<p><em>@returns {set}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">times</span><span class="p">(</span><span class="nx">n</span> <span class="o">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">:</span> <span class="nx">any</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">n</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-458">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-458">&#182;</a>               </div>               <h3>Set.prototype.times()</h3>

<p>Multiplies all elements in the set if no argument is passed.
Multiplies all elements by a argument if one is passed.</p>

<p><em>@param {number|MathLib object}</em> <br />
<em>@returns {set}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toArray</span><span class="p">()</span> <span class="o">:</span> <span class="nx">any</span><span class="p">[]</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-459">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-459">&#182;</a>               </div>               <h3>Set.prototype.toArray()</h3>

<p>Converts the set to an array</p>

<p><em>@returns {array}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toContentMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;emptyset/&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toContentMathMLString</span><span class="p">(</span><span class="nx">cur</span><span class="p">);</span>
    <span class="p">},</span> <span class="s1">&#39;&lt;set&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/set&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-460">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-460">&#182;</a>               </div>               <h3>Set.prototype.toContentMathMLString()</h3>

<p>Returns the content MathML representation of the set</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toLaTeX</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;\\emptyset&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toLaTeX</span><span class="p">(</span><span class="nx">cur</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="p">;</span>
    <span class="p">},</span> <span class="s1">&#39;\\{&#39;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;\\}&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-461">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-461">&#182;</a>               </div>               <h3>Set.prototype.toLaTeX()</h3>

<p>Returns the LaTeX representation of the set</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toMathMLString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;mi&gt;&amp;#x2205;&lt;/mi&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">old</span><span class="p">,</span> <span class="nx">cur</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">old</span> <span class="o">+</span> <span class="nx">MathLib</span><span class="p">.</span><span class="nx">toMathMLString</span><span class="p">(</span><span class="nx">cur</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;mo&gt;,&lt;/mo&gt;&#39;</span><span class="p">;</span>
    <span class="p">},</span> <span class="s1">&#39;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&#39;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-462">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-462">&#182;</a>               </div>               <h3>Set.prototype.toMathMLString()</h3>

<p>Returns the (presentation) MathML representation of the set</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">toString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">join</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
<span class="p">}</span>


<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-463">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-463">&#182;</a>               </div>               <h3>Set.prototype.toString()</h3>

<p>Returns a string representation of the set</p>

<p><em>@returns {string}</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="cm">/*</span>
<span class="cm">  MathLib.noConflict = function () {</span>
<span class="cm">    global.MathLib = oldMathLib;</span>
<span class="cm">    return MathLib;</span>
<span class="cm">  };</span>
<span class="cm">  */</span>

<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-464">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-464">&#182;</a>               </div>               <h3>MathLib.noConflict</h3>

<p>Restores the original value of MathLib in the global namespace</p>

<p><em>@returns {object}</em> Returns a reference to this MathLib library</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-465">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-465">&#182;</a>               </div>               <p>@ sourceMappingURL=MathLib.js.map</p>             </td>             <td class="code">               <div class="highlight"><pre>undefined</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 