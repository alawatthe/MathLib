/*! MathLib v0.1 MathLib.de | MathLib.de/en/license */
Array.prototype.every||(Array.prototype.every=function(a){"use strict";if(this==null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=arguments[1];for(var e=0;e<c;e++)if(e in b&&!a.call(d,b[e],e,b))return!1;return!0}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(this==null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=[],e=arguments[1];for(var f=0;f<c;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(this==null)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(c=b),d=0;while(d<f){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(this==null)throw new TypeError(" this is null or not defined");var f=Object(this),g=f.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(c=b),d=Array(g),e=0;while(e<g){var h,i;e in f&&(h=f[e],i=a.call(c,h,e,f),d[e]=i),e++}return d}),Array.prototype.reduce||(Array.prototype.reduce=function(b){var c=0,d=this.length>>0,e;if(typeof b!="function")throw new TypeError("First argument is not callable");if(arguments.length<2){if(d===0)throw new TypeError("Array length is 0 and no second argument");e=this[0],c=1}else e=arguments[1];while(c<d)c in this&&(e=b.call(undefined,e,this[c],c,this)),++c;return e}),Array.prototype.some||(Array.prototype.some=function(a){"use strict";if(this==null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=arguments[1];for(var e=0;e<c;e++)if(e in b&&a.call(d,b[e],e,b))return!0;return!1}),function(a){var b="MathLib",c=this,d=c.MathLib,e=c[b],f,g="__proto__",h,i=function(a){return a.reduce(function(a,b){return a.concat(b)})},j=Array.prototype.slice;f={version:.1,apery:1.2020569031595942,e:Math.E,epsilon:Number.EPSILON||function(){var a,b;for(a=1;1+a!==1;a/=2)b=a;return b}(),eulerMascheroni:.5772156649015329,goldenRatio:1.618033988749895,pi:Math.PI},h={func:Object.getPrototypeOf(function(){}),array:Object.getPrototypeOf([]),object:Object.getPrototypeOf({})},f.prototypes=h,f.extend=function(a,b,c,d){d=d||{enumerable:!0},Object.defineProperty(f[a],b,{value:c,writable:d.writable,enumerable:d.enumerable,configurable:d.configurable})},f.extendPrototype=function(a,b,c,d){d=d||{enumerable:!0},Object.defineProperty(h[a],b,{value:c,writable:d.writable,enumerable:d.enumerable,configurable:d.configurable})};var k={abs:Math.abs,arccos:Math.acos,arccot:function(a){return f.pi/2-Math.atan(a)},arccsc:function(a){return Math.asin(1/a)},arcosh:function(a){return Math.log(a+Math.sqrt(a*a-1))},arcoth:function(a){return.5*Math.log((a+1)/(a-1))},arcsch:function(a){return Math.log((1+Math.sqrt(1+a*a))/a)},arcsec:function(a){return Math.acos(1/a)},arcsin:Math.asin,arctan:Math.atan,arsech:function(a){return Math.log((1+Math.sqrt(1-a*a))/a)},arsinh:function(a){return Math.log(a+Math.sqrt(a*a+1))},artanh:function(a){return.5*Math.log((1+a)/(1-a))},binomial:function(a,b){var c=1,d;if(b<0||a>0&&b>a)return 0;a<0&&(c=Math.pow(-1,b),a=b-a-1),b>a/2&&(b=a-b);for(d=1;d<=b;d++)c*=(a+1-d)/d;return c},cbrt:function(a){var b,c,d,e;if(a===0||a!==a||a===Infinity||a===-Infinity)return a;e=f.sgn(a)*Math.pow(Math.abs(a),1/3);for(;;){b=Math.pow(e,3),c=b+a,d=e*(c+a)/(c+b);if(f.isZero(d-e))break;e=d}return d},ceil:Math.ceil,conjugate:function(a){return a},copy:function(a){return a},cos:Math.cos,cosh:Math.cosh||function(a){return(Math.exp(a)+Math.exp(-a))/2},cot:function(a){return 1/Math.tan(a)},coth:function(a){return(Math.exp(a)+Math.exp(-a))/(Math.exp(a)-Math.exp(-a))},csc:function(a){return 1/Math.sin(a)},csch:function(a){return 2/(Math.exp(a)-Math.exp(-a))},degToRad:function(a){return a/180*f.pi},digitproduct:function(a){var b=1;while(a>9)b*=a%10,a=Math.floor(a/10);return b*a},digitsum:function(a){var b=0;while(a>9)b+=a%10,a=Math.floor(a/10);return b+a},divide:function(a,b){return f.times(a,f.inverse(b))},divisors:function(a){var b=a===1?[]:[1],c,d;for(c=2,d=a/2;c<=d;c++)a%c===0&&b.push(c);return b.push(a),f.set(b)},exp:Math.exp,factor:function(a){var b=[],c;a=Math.abs(a);while(a%2===0)a/=2,b.push(2);c=3;while(a!==1){while(a%c===0)a/=c,b.push(c);c+=2}return f.set(b,!0)},factorial:function(a){var b=1,c;for(c=1;c<=a;c+=1)b*=c;return b},fallingFactorial:function(a,b,c){var d=1,e;c=c||1;for(e=0;e<b;e++)d*=a-e*c;return d},fibonacci:function(a){return Math.floor(Math.pow(f.goldenRatio,a)/Math.sqrt(5))},floor:Math.floor,hypot:function(a,b){var c,d,e;return arguments.length===1?Math.abs(a):(arguments.length>2&&(c=Array.prototype.slice.call(arguments),c.shift(),b=f.hypot.apply(null,c)),a=f.abs(a),b=f.abs(b),a===Infinity||b===Infinity?Infinity:(d=Math.max(a,b),e=Math.min(a,b),d*Math.sqrt(1+Math.pow(e/d,2))))},hypot2:function(){var a=Array.prototype.slice.call(arguments);return a.some(function(a){return a===Infinity||a===-Infinity})?Infinity:a.reduce(function(a,b){return a+b*b},0)},inverse:function(a){return 1/a},isFinite:function(a){return Math.abs(a)!==Infinity},isInt:function(a){return a%1===0},isNaN:function(a){return a!==a},isNegZero:function(a){return 1/a===-Infinity},isOne:function(a){return Math.abs(a-1)<f.epsilon},isPosZero:function(a){return 1/a===Infinity},isPrime:function(a){var b=Math.sqrt(a),c;if(a%1===0&&a>1){if(a===2)return!0;if(a%2===0)return!1;for(c=3;c<=b;c+=2)if(a%c===0)return!1;return!0}return!1},isReal:function(a){return!0},isZero:function(a){return Math.abs(a)<f.epsilon},lg:function(a){return Math.log(a)/Math.ln10},ln:function(a){return a>0?Math.log(a):f.complex([Math.log(-a),Math.PI])},log:function(a,b){return arguments.length===1&&(b=a,a=10),Math.log(b)/Math.log(a)},minus:function(a,b){return f.plus(a,f.negative(b))},mod:function(a,b){var c=a%b;return c<0?c+b:c},negative:function(a){return-a},pow:function(a,b){return a===1||a===-1&&(b===Infinity||b===-Infinity)?1:Math.pow(a,b)},radToDeg:function(a){return a*180/Math.PI},random:Math.random,risingFactorial:function(a,b,c){var d=1,e;c=c||1;for(e=0;e<b;e++)d*=a+e*c;return d},root:function(a,b){return arguments.length===1?Math.sqrt(a):Math.pow(a,1/b)},sec:function(a){return 1/Math.cos(a)},sech:function(a){return 2/(Math.exp(a)+Math.exp(-a))},sgn:function(a){return a>0?1:a<0?-1:0},sin:Math.sin,sinh:Math.sinh||function(a){return(Math.exp(a)-Math.exp(-a))/2},tan:Math.tan,tanh:Math.tanh||function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))},trunc:function(a,b){return a.toFixed(b||0)},toContentMathML:function(a){return"<cn>"+a+"</cn>"},toLaTeX:function(a,b){return b?(a<0?"-":"+")+Math.abs(a):(a<0?"-":"")+Math.abs(a)},toMathML:function(a,b){return b?"<mo>"+(a<0?"-":"+")+"</mo><mn>"+Math.abs(a)+"</mn>":(a<0?"<mo>-</mo>":"")+"<mn>"+Math.abs(a)+"</mn>"},toString:function(a,b){return b?(a<0?"-":"+")+Math.abs(a):(a<0?"-":"")+Math.abs(a)}};f.compare=function(a,b){return f.type(a)!==f.type(b)?f.sgn(f.type(a).localeCompare(f.type(b))):typeof a=="number"?f.sgn(a-b):typeof a=="string"?a.localeCompare(b):a.compare(b)},f.type=function(a){return a.type?a.type:Object.prototype.toString.call(a).slice(8,-1).toLowerCase()},f.is=function(a,b){return h[b]?h[b].isPrototypeOf(a):typeof a===b};var l={arithMean:function(){return f.plus(this)/this.length},gcd:function(){var a,b=this,c=function(b){return b!==a?b%a:b},d=function(a){return a!==0};b=b.filter(function(a){return a<0?(b.push(-a),!1):a!==0});while(b.length>1)a=f.min(b),b=b.map(c).filter(d);return b[0]||a},geoMean:function(){return f.root(f.times(this),this.length)},harmonicMean:function(){return this.length/f.plus(Array.prototype.map.call(this,f.inverse))},lcm:function(){return f.times(this)/f.gcd(this)},max:function(a){return a?this.sort(f.compare)[this.length-a]:Math.max.apply("Array",this)},min:function(a){return a?this.sort(f.compare)[a-1]:Math.min.apply("Array",this)}},m={plus:function(){return i(j.apply(arguments)).reduce(function(a,b){if(typeof a=="number"&&typeof b=="number")return a+b;if(typeof a=="object")return a.plus(b);if(typeof b=="object")return b.plus(a)})},isEqual:function(){return i(j.apply(arguments)).every(function(a,b,c){return a===c[0]?!0:typeof a=="number"&&typeof c[0]=="number"?Math.abs(a-c[0])<=3e-15:typeof a=="object"?a.isEqual(c[0]):typeof c[0]=="object"?c[0].isEqual(a):!1})},times:function(){return i(j.apply(arguments)).reduce(function(a,b){if(typeof a=="number"&&typeof b=="number")return a*b;if(typeof a=="object")return a.times(b);if(typeof b=="object")return b.times(a)})}},n=function(a,b){return function(c){return typeof c=="number"?a.apply("",arguments):typeof c=="function"?function(b){return a(c(b))}:c.type==="set"?f.set(c.map(a)):c.type==="complex"?c[b].apply(c,Array.prototype.slice.call(arguments,1)):Array.isArray(c)?c.map(a):c[b]()}},o=function(a,b){return function(){var b=Array.prototype.slice.call(arguments),c=b.shift();return a.apply(c,b)}},p=function(a,b){return function(){return arguments.length>1?a(Array.prototype.slice.apply(arguments)):a(arguments[0])}},q,r;for(q in k)k.hasOwnProperty(q)&&(r=k[q],Object.defineProperty(f,q,{value:n(k[q],q)}));h.set=[];for(q in l)l.hasOwnProperty(q)&&(r=l[q],Object.defineProperty(f,q,{value:o(l[q],q)}),f.extendPrototype("set",q,function(a){return function(b){return f[a](this,b)}}(q)));for(q in m)m.hasOwnProperty(q)&&(r=m[q],Object.defineProperty(f,q,{value:p(m[q],q)}));h.screen={},f.screen=function(b,c){if(arguments.length===0)return Object.create(h.screen,{});var d=a.getElementById(b),e=Object.create(h.screen),f={axisType:"in",axisColor:"black",axisLineWidth:.05,background:"white",down:-5,drag:!1,fillColor:"rgba(0,255,0,0.1)",fillLeft:-5,fillRight:5,fontSize:10,gridAngle:30,gridColor:"#cccccc",gridLineWidth:.05,gridType:"cartesian",height:d.height.baseVal?d.height.baseVal.value:d.height,label:!0,left:-5,pan:!0,plotColor:"blue",plotLineWidth:.05,right:5,stepSizeX:1,stepSizeY:1,state:"",up:5,width:d.width.baseVal?d.width.baseVal.value:d.width,zoom:!0,zoomScale:.2};f.center=[f.width/2,f.height/2],f.translateX=0,f.translateY=0;for(var g in c)c.hasOwnProperty(g)&&(f[g]=c[g]);f.id=b,f.element=d,f.type=d.localName,f.zoomX=f.width/((-f.left+f.right)*f.stepSizeX),f.zoomY=f.height/((f.up-f.down)*f.stepSizeY),f.contextmenuWrapper=a.createElement("div"),f.contextmenuWrapper.className="MathLib contextmenuWrapper",f.contextmenu=a.createElement("ul"),f.contextmenu.className="MathLib contextmenu";var i=a.createElement("li");i.className="MathLib menuitem",i.innerHTML="Reset View",i.onclick=function(){e.resetView(),f.contextmenu.style.setProperty("display","none")},f.contextmenu.appendChild(i),f.contextmenuWrapper.appendChild(f.contextmenu),a.documentElement.appendChild(f.contextmenuWrapper);for(var j in f)f.hasOwnProperty(j)&&Object.defineProperty(e,j,{value:f[j],enumerable:!0,writable:!0});return e},f.extendPrototype("screen","axis",function(a,b){var c={stroke:this.axisColor,stroke_width:this.axisLineWidth,layer:"back"},d;b=b||{};if(a==="in"){var e=10/this.zoomX,f=10/this.zoomY,g={stroke:"black",stroke_width:.03,layer:"back"},h={stroke:"black",layer:"back",scale:.3,translateX:-1};this.line([[-50,0],[50,0]],c),this.line([[0,-50],[0,50]],c);for(d=this.stepSizeX;d<=50*this.stepSizeX;d+=this.stepSizeX)this.line([[d,-f],[d,f]],g);for(d=-this.stepSizeX;d>=-50*this.stepSizeX;d-=this.stepSizeX)this.line([[d,-f],[d,f]],g);for(d=this.stepSizeY;d<=50*this.stepSizeY;d+=this.stepSizeY)this.line([[-e,d],[e,d]],g);for(d=-this.stepSizeY;d>=-50*this.stepSizeY;d-=this.stepSizeY)this.line([[-e,d],[e,d]],g);if(this.label){for(d=this.stepSizeX;d<=50*this.stepSizeX;d+=this.stepSizeX)this.text(d+"",d-e/2,-2.5*f,h);for(d=-this.stepSizeX;d>=-50*this.stepSizeX;d-=this.stepSizeX)this.text(d+"",d-e/2,-2.5*f,h);for(d=this.stepSizeY;d<=50*this.stepSizeY;d+=this.stepSizeY)this.text(d+"",-2.5*e,d-f/2,h);for(d=-this.stepSizeY;d>=-50*this.stepSizeY;d-=this.stepSizeY)this.text(d+"",-2.5*e,d-f/2,h)}}return this}),f.extendPrototype("screen","getX",function(a){var b;return a.offsetX?b=a.offsetX:b=a.layerX-this.element.offsetTop,this.left+b/this.zoomX}),f.extendPrototype("screen","getY",function(a){var b;return a.offsetY?b=a.offsetY:b=a.layerY-this.element.offsetLeft,this.up-b/this.zoomY}),f.extendPrototype("screen","grid",function(a,b){b=b||{},a===!0?a=this.gridType:this.gridType=a;var c=this.gridColor=b.color||"#cccccc",d=this.gridAngle=b.angle||Math.PI/6,e=this.gridLineWidth=b.stroke_width||.05,g,h;h={stroke:c,stroke_width:e,layer:"back",fill:"transparent"};if(a){if(a==="cartesian"){for(g=-50;g<=50;g+=this.stepSizeX)this.line([[g,-50],[g,50]],h);for(g=-50;g<=50;g+=this.stepSizeY)this.line([[-50,g],[50,g]],h)}if(a==="polar"){for(g=0;g<2*Math.PI;g+=d)this.line([[0,0],[50*Math.cos(g),50*Math.sin(g)]],h);for(g=1;g<60;g+=1)this.circle(f.circle([0,0,1],g),h)}}return this}),f.extendPrototype("screen","lineEndPoints",function(a){if(a.type==="line"){var b=-(a[2]+a[0]*50)/a[1],c=-(a[2]+a[1]*50)/a[0],d=-(a[2]+a[0]*-50)/a[1],e=-(a[2]+a[1]*-50)/a[0],f=[];return b<50&&b>-50&&f.push([50,b]),d<50&&d>-50&&f.push([-50,d]),c<50&&c>-50&&f.push([c,50]),e<50&&e>-50&&f.push([e,-50]),f}return a}),h.canvas=f.screen(),f.canvas=function(b){var c=f.screen(b);c[g]=h.canvas;var d=a.createElement("div");d.style.setProperty("width",c.width+"px"),d.style.setProperty("height",c.height+"px"),d.style.setProperty("position","relative"),c.element.parentNode.insertBefore(d,c.element.wrapperDiv);var e=a.createElement("canvas");e.setAttribute("width",c.width),e.setAttribute("height",c.height),e.classList.add("MathLib-backLayer"),e.classList.add("MathLib-canvas"),c.backLayer={ctx:e.getContext("2d"),element:e},d.appendChild(e),c.mainLayer={ctx:a.getElementById(b).getContext("2d"),element:a.getElementById(b)},d.appendChild(c.mainLayer.element);var i=a.createElement("canvas");i.setAttribute("width",c.width),i.setAttribute("height",c.height),i.classList.add("MathLib-frontLayer"),i.classList.add("MathLib-canvas"),c.frontLayer={ctx:i.getContext("2d"),element:i},d.appendChild(i);var j=[c.mainLayer,c.backLayer,c.frontLayer];return j.forEach(function(a){a.ctx.save(),a.ctx.transform(c.zoomX,0,0,-c.zoomY,-c.left*c.stepSizeX*c.zoomX,c.up*c.stepSizeY*c.zoomY),a.element.style.setProperty("position","absolute"),a.element.style.setProperty("left","0px"),a.element.style.setProperty("top","0px")}),c.frontLayer.element.onselectstart=function(){return!1},c},f.extendPrototype("canvas","circle",function(a,b){var c;b=b||{},b.layer?c=this[b.layer+"Layer"].ctx:c=this.mainLayer.ctx,c.beginPath(),c.arc(a.center[0],a.center[1],a.radius,0,2*Math.PI),c.strokeStyle="blue",c.fillStyle="rgba(0, 0, 255, 0.05)",c.lineWidth="0.05","color"in b&&(c.strokeStyle=b.color),"stroke"in b&&(c.strokeStyle=b.stroke),"stroke_width"in b&&(c.lineWidth=b.stroke_width),c.closePath(),c.fill(),c.stroke()}),f.extendPrototype("canvas","clearLayer",function(a){this[a+"Layer"].ctx.clearRect(-5,-5,10,10)}),f.extendPrototype("canvas","line",function(a,b){b=b||{};var c,d=this.lineEndPoints(a);b.layer?c=this[b.layer+"Layer"].ctx:c=this.mainLayer.ctx,c.strokeStyle="black",c.lineWidth="0.05",c.beginPath(),c.moveTo(d[0][0],d[0][1]),c.lineTo(d[1][0],d[1][1]),"color"in b&&(c.strokeStyle=b.color),"stroke"in b&&(c.strokeStyle=b.stroke),"stroke_width"in b&&(c.lineWidth=b.stroke_width),"stroke_dasharray"in b&&"mozDash"in c&&(c.mozDash=b.stroke_dasharray.split(",").map(parseFloat),c.mozDashOffset=parseFloat(b.stroke_dashoffset)),c.closePath(),c.stroke(),c.mozDash=null}),f.extendPrototype("canvas","path",function(a,b){b=b||{};var c;b.layer?c=this[b.layer+"Layer"].ctx:c=this.mainLayer.ctx,c.beginPath(),c.moveTo(a[0][0],a[0][1]),a.forEach(function(a){c.lineTo(a[0],a[1])}),"color"in b&&(c.strokeStyle=b.color),"stroke"in b&&(c.strokeStyle=b.stroke),"stroke_width"in b&&(c.lineWidth=b.stroke_width),"stroke_dasharray"in b&&"mozDash"in c&&(c.mozDash=b.stroke_dasharray.split(",").map(parseFloat),c.mozDashOffset=parseFloat(b.stroke_dashoffset)),c.stroke(),c.closePath(),c.mozDash=null}),f.extendPrototype("canvas","point",function(a,b){b=b||{};var c;b.layer?c=this[b.layer+"Layer"].ctx:c=this.mainLayer.ctx,c.beginPath(),c.strokeStyle="black",c.fillStyle="black",c.lineWidth="0.05",b.stroke&&(c.strokeStyle=b.stroke),b.stroke_width&&(c.lineWidth=b.stroke_width),b.color&&(c.fillStyle=b.color,c.strokeStyle=b.color),b.fill&&(c.fillStyle=b.fill),c.arc(a[0]/a[2],a[1]/a[2],.05,0,2*Math.PI),c.closePath(),c.stroke(),c.fill()}),f.extendPrototype("canvas","text",function(a,b,c,d){d=d||{};var e=d.scale||.4,f;"layer"in d?f=this[d.layer+"Layer"]:f=this.mainLayer,f.ctx.save(),f.ctx.transform(1/this.zoomX,0,0,-1/this.zoomY,-this.left*this.stepSizeX/this.zoomX,this.up*this.stepSizeY/this.zoomY),f.ctx.font="20px Arial",f.ctx.fillText(a,b*this.zoomX,-c*this.zoomY),f.ctx.restore()}),h.svg=f.screen(),f.svg=function(b){var c=a.getElementById(b),d=f.screen(b);d[g]=h.svg,Object.defineProperties(d,{sadf:{value:"foo"}});var e=a.createElementNS("http://www.w3.org/2000/svg","g");e.setAttributeNS(null,"transform","matrix("+d.zoomX+",0, 0,"+ -d.zoomY+", "+d.width/2+", "+d.height/2+")"),c.appendChild(e),d.ctx=e;var i=a.createElementNS("http://www.w3.org/2000/svg","g");i.className.baseVal+=" MathLib-backLayer ",e.appendChild(i),d.backLayer={element:i};var j=a.createElementNS("http://www.w3.org/2000/svg","g");j.className.baseVal+=" MathLib-mainLayer ",e.appendChild(j),d.mainLayer={element:j};var k=a.createElementNS("http://www.w3.org/2000/svg","g");return k.className.baseVal+=" MathLib-frontLayer ",e.appendChild(k),d.frontLayer={element:k},c.onselectstart=function(){return!1},c.onmousedown=function(a){d.onmousedown(a)},c.oncontextmenu=function(a){d.oncontextmenu(a)},c.onmousemove=function(a){d.onmousemove(a)},c.onmouseup=function(a){d.onmouseup(a)},"onmousewheel"in c?c.onmousewheel=function(a){d.onmousewheel(a)}:c.DOMMouseScroll=function(a){d.onmousewheel(a)},d},f.extendPrototype("svg","circle",function(b,c){var d=a.createElementNS("http://www.w3.org/2000/svg","circle"),e={center:"rgba(255, 0, 0, 1)",fill:"rgba(0, 0, 255, 0.05)",stroke:"rgba(0, 0, 255, 1)",stroke_width:"0.05",moveable:!0},f;c=c||{},"layer"in c?f=this[c.layer+"Layer"]:f=this.mainLayer;for(var g in c)c.hasOwnProperty(g)&&(e[g]=c[g]);d.setAttributeNS(null,"cx",b.center[0]/b.center[2]),d.setAttributeNS(null,"cy",b.center[1]/b.center[2]),d.setAttributeNS(null,"r",b.radius),d.setAttributeNS(null,"contextmenu","fullscreenmenu"),d.circle=b;var h;for(h in e)e.hasOwnProperty(h)&&d.setAttributeNS(null,h.replace("_","-"),e[h]);f.element.appendChild(d)}),f.extendPrototype("svg","clearLayer",function(a){a=this[a+"Layer"].element;while(a.hasChildNodes())a.removeChild(a.firstChild)}),f.extendPrototype("svg","line",function(b,c){var d=a.createElementNS("http://www.w3.org/2000/svg","line"),e=this.lineEndPoints(b),f;c=c||{},"layer"in c?f=this[c.layer+"Layer"]:f=this.mainLayer,d.setAttributeNS(null,"x1",e[0][0]),d.setAttributeNS(null,"y1",e[0][1]),d.setAttributeNS(null,"x2",e[1][0]),d.setAttributeNS(null,"y2",e[1][1]),d.setAttributeNS(null,"stroke-width",.05),d.setAttributeNS(null,"stroke","black"),d.line=b,b.svg=d,f.element.appendChild(d),c.hasOwnProperty("color")&&(d.setAttributeNS(null,"fill",c.color),d.setAttributeNS(null,"stroke",c.color));for(var g in c)c.hasOwnProperty(g)&&g!=="layer"&&d.setAttributeNS(null,g.replace("_","-"),c[g])}),f.extendPrototype("svg","getEventPoint",function(a){var b=this.element.createSVGPoint();return b.x=a.clientX,b.y=a.clientY,b}),f.extendPrototype("svg","oncontextmenu",function(a){a.preventDefault&&a.preventDefault(),a.returnValue=!1;var b=this.contextmenu;b.style.setProperty("display","block"),b.style.setProperty("top",a.clientY-20+"px"),b.style.setProperty("left",a.clientX+"px");var c=this.contextmenuWrapper;c.style.setProperty("width","100%"),c.style.setProperty("height","100%");var d=this,e=function(){d.contextmenu.style.setProperty("display","none"),c.style.setProperty("width","0px"),c.style.setProperty("height","0px"),d.contextmenuWrapper.removeEventListener("click",e)};this.contextmenuWrapper.addEventListener("click",e)}),f.extendPrototype("svg","onmousedown",function(a){if(a.button!==0)return;a.preventDefault&&a.preventDefault(),a.returnValue=!1;var b=a.target.ownerDocument,c=this.ctx;a.target.tagName==="svg"||!this.drag?(this.state="pan",this.stateTf=c.getCTM().inverse(),this.stateOrigin=this.getEventPoint(a).matrixTransform(this.stateTf)):(this.state="drag",this.stateTarget=a.target,this.stateTf=c.getCTM().inverse(),this.stateOrigin=this.getEventPoint(a).matrixTransform(this.stateTf))}),f.extendPrototype("svg","onmousemove",function(a){a.preventDefault&&a.preventDefault(),a.returnValue=!1;var b=a.target.ownerDocument,c=this.ctx,d;this.state==="pan"&&this.pan?(d=this.getEventPoint(a).matrixTransform(this.stateTf),this.setCTM(c,this.stateTf.inverse().translate(d.x-this.stateOrigin.x,d.y-this.stateOrigin.y))):this.state==="drag"&&this.drag&&(d=this.getEventPoint(a).matrixTransform(c.getCTM().inverse()),this.setCTM(this.stateTarget,this.element.createSVGMatrix().translate(d.x-this.stateOrigin.x,d.y-this.stateOrigin.y).multiply(c.getCTM().inverse()).multiply(this.stateTarget.getCTM())),this.stateOrigin=d)}),f.extendPrototype("svg","onmouseup",function(a){a.preventDefault&&a.preventDefault(),a.returnValue=!1;var b=a.target.ownerDocument;if(this.state==="pan"||this.state==="drag")this.state=""}),f.extendPrototype("svg","onmousewheel",function(a){if(!this.zoom)return;a.preventDefault&&a.preventDefault(),a.returnValue=!1;var b=a.target.ownerDocument,c,d,e,f,g;a.wheelDelta?c=a.wheelDelta/360:c=a.detail/-9,g=Math.pow(1+this.zoomScale,c),d=this.ctx,f=this.getEventPoint(a),f=f.matrixTransform(d.getCTM().inverse()),e=this.element.createSVGMatrix().translate(f.x,f.y).scale(g).translate(-f.x,-f.y),this.setCTM(d,d.getCTM().multiply(e)),typeof this.stateTf=="undefined"&&(this.stateTf=d.getCTM().inverse()),this.stateTf=this.stateTf.multiply(e.inverse())}),f.extendPrototype("svg","resetView",function(){this.ctx.setAttribute("transform","matrix(50, 0, 0, -50, 250, 250)")}),f.extendPrototype("svg","path",function(b,c){var d=a.createElementNS("http://www.w3.org/2000/svg","path"),e="M"+b.reduce(function(a,b){return a+" L"+b.join(" ")}).slice(1,-1);c=c||{},d.setAttributeNS(null,"d",e),d.setAttributeNS(null,"fill","transparent"),d.setAttributeNS(null,"stroke-width",.05),c.hasOwnProperty("color")&&(d.setAttributeNS(null,"fill",c.color),d.setAttributeNS(null,"stroke",c.color));for(var f in c)c.hasOwnProperty(f)&&d.setAttributeNS(null,f.replace("_","-"),c[f]);this.mainLayer.element.appendChild(d)}),f.extendPrototype("svg","point",function(b,c){var d=a.createElementNS("http://www.w3.org/2000/svg","circle");c=c||{},d.setAttributeNS(null,"cx",b[0]/b[2]),d.setAttributeNS(null,"cy",b[1]/b[2]),d.setAttributeNS(null,"r",.1),d.setAttributeNS(null,"stroke-width",.05),d.point=b,c.hasOwnProperty("color")&&(d.setAttributeNS(null,"fill",c.color),d.setAttributeNS(null,"stroke",c.color));for(var e in c)c.hasOwnProperty(e)&&d.setAttributeNS(null,e.replace("_","-"),c[e]);this.mainLayer.element.appendChild(d),b.svg=d}),f.extendPrototype("svg","setCTM",function(a,b){var c="matrix("+b.a+","+b.b+","+b.c+","+b.d+","+b.e+","+b.f+")";a.setAttribute("transform",c)}),f.extendPrototype("svg","text",function(b,c,d,e){e=e||{};var f=a.createElementNS("http://www.w3.org/2000/svg","text"),g=e.scale||.4,h;"layer"in e?h=this[e.layer+"Layer"]:h=this.mainLayer,f.textContent=b,f.setAttributeNS(null,"x",1/g*c),f.setAttributeNS(null,"y",-1/g*d),f.setAttributeNS(null,"font-size","1"),f.setAttributeNS(null,"stroke-width",.05),f.setAttributeNS(null,"transform","scale("+g+", -"+g+")"),e.hasOwnProperty("color")&&(f.setAttributeNS(null,"fill",e.color),f.setAttributeNS(null,"stroke",e.color));for(var i in e)e.hasOwnProperty(i)&&f.setAttributeNS(null,i.replace("_","-"),e[i]);h.element.appendChild(f)}),h.vector=[],f.vector=function(a){var b,c,d;if(typeof a=="string"){b=a.split(":").map(parseFloat),b.length===2&&(b=b.splice(1,0,1)),a=[];for(d=b[0];d<=b[2];d+=b[1])a.push(d)}return a[g]=h.vector,Object.defineProperties(a,{dim:{value:a.length}}),a},f.extendPrototype("vector","constructor",f.vector),f.extendPrototype("vector","type","vector"),f.extendPrototype("vector","conjugate",function(){return f.vector(this.map(f.conjugate))}),f.extendPrototype("vector","dyadicProduct",function(a){return f.matrix(this.map(function(b){return a.map(function(a){return f.times(b,a)})}))}),f.extendPrototype("vector","isEqual",function(a){return this.dim!==a.dim?!1:this.every(function(b,c){return f.isEqual(b,a[c])})}),f.extendPrototype("vector","isZero",function(a){return this.every(f.isZero)}),f.extendPrototype("vector","map",function(a){return this.constructor(Array.prototype.map.call(this,a))}),f.extendPrototype("vector","negative",function(){return this.map(f.negative)}),f.extendPrototype("vector","normalize",function(){return this.times(1/this.size)}),f.extendPrototype("vector","scalarproduct",function(a){var b=0,c,d;for(c=0,d=this.length;c<d;c++)b=f.plus(b,f.times(this[c],a[c]));return b}),f.extendPrototype("vector","size",function(){return Math.sqrt(this.conjugate().scalarproduct(this))}),f.extendPrototype("vector","times",function(a){var b=[],c,d;if(typeof a=="number"||a.type==="complex")return this.map(function(b){return f.times(b,a)});if(a.type==="matrix"){b=a.toColVectors();for(c=0,d=b.length;c<d;c++)b[c]=this.scalarproduct(b[c]);return f.vector(b)}}),f.extendPrototype("vector","toArray",function(){return this.slice()}),f.extendPrototype("vector","toContentMathML",function(){return this.reduce(function(a,b){return a+f.toContentMathML(b)},"<vector>")+"</vector>"}),f.extendPrototype("vector","toLaTeX",function(){return"\\begin{pmatrix}\n\t"+this.reduce(function(a,b){return a+"\\\\\n\t"+f.toLaTeX(b)})+"\n\\end{pmatrix}"}),f.extendPrototype("vector","toMathML",function(){return this.reduce(function(a,b){return a+"<mtr><mtd>"+f.toMathML(b)+"</mtd></mtr>"},"<mrow><mo>(</mo><mtable>")+"</mtable><mo>)</mo></mrow>"}),f.extendPrototype("vector","toString",function(){return"("+this.reduce(function(a,b){return a+", "+f.toLaTeX(b)})+")"}),f.extendPrototype("vector","vectorproduct",function(a){var b=[];return this.dim===3&&a.dim===3&&(b.push(f.minus(f.times(this[1],a[2]),f.times(this[2],a[1]))),b.push(f.minus(f.times(this[2],a[0]),f.times(this[0],a[2]))),b.push(f.minus(f.times(this[0],a[1]),f.times(this[1],a[0])))),f.vector(b)}),f.extend("vector","zero",function(a){var b=[],c;for(c=0;c<a;c++)b.push(0);return f.vector(b)}),h.circle={},f.circle=function(a,b){return a.type===undefined&&(a=f.point(a.concat(1))),Object.create(h.circle,{radius:{value:b,writable:!0},center:{value:a,writable:!0}})},f.extendPrototype("circle","constructor",f.circle),f.extendPrototype("circle","type","circle"),f.extendPrototype("circle","area",function(){return this.radius*this.radius*f.pi}),f.extendPrototype("circle","circumference",function(){return 2*this.radius*f.pi}),f.extendPrototype("circle","draw",function(a,b){if(Array.isArray(a)){var c=this;a.forEach(function(a){a.circle(c,b)})}else a.circle(this,b);return this}),f.extendPrototype("circle","isContaining",function(a){if(a.type==="point"&&a.dim===2)return a.distanceTo(this.center)<this.radius}),f.extendPrototype("circle","isEqual",function(a){return f.isEqual(this.radius,a.radius)&&this.center.isEqual(a.center)}),f.extendPrototype("circle","reflectAt",function(a){return f.circle(this.center.reflectAt(a),this.radius)}),f.extendPrototype("circle","toMatrix",function(){var a=this.center.get(0),b=this.center.get(1),c=this.radius;return f.matrix([[1,0,-a],[0,1,-b],[-a,-b,a*a+b*b-c*c]])}),h.complex={},f.complex=function(){var a,b,c;return arguments.length===1&&Array.isArray(arguments[0])&&arguments[0].length===2?(a=arguments[0],b=arguments[0][0],c=arguments[0][1]):arguments.length===2&&(b=arguments[0]*Math.cos(arguments[1]),c=arguments[0]*Math.sin(arguments[1]),a=[b,c]),Object.create(h.complex,{re:{value:b,enumerable:!0},im:{value:c,enumerable:!0},z:{value:a,enumerable:!0}})},f.extendPrototype("complex","constructor",f.complex),f.extendPrototype("complex","type","complex"),f.extendPrototype("complex","argument",function(a){return(Math.atan2(this.im,this.re)+2*Math.PI)%(2*Math.PI)}),f.extendPrototype("complex","abs",function(a){return f.hypot(this.re,this.im)}),f.extendPrototype("complex","arccos",function(){return f.minus(Math.PI/2,this.arcsin())}),f.extendPrototype("complex","arccot",function(){return f.minus(Math.PI/2,this.arctan())}),f.extendPrototype("complex","arccsc",function(){return f.times(f.complex([0,1]),f.ln(f.plus(f.sqrt(f.minus(1,f.divide(1,f.times(this,this)))),f.divide(f.complex([0,1]),this))))}),f.extendPrototype("complex","arcsin",function(){var a=this.re,b=this.im;return f.complex([f.sgn(a)/2*f.arccos(Math.sqrt(Math.pow(a*a+b*b-1,2)+4*b*b)-(a*a+b*b)),f.sgn(b)/2*f.arcosh(Math.sqrt(Math.pow(a*a+b*b-1,2)+4*b*b)+(a*a+b*b))])}),f.extendPrototype("complex","arctan",function(){var a=f.complex(-this.im,this.re);return f.times(f.complex([0,.5]),f.ln(f.divide(f.plus(1,a),f.minus(1,a))))}),f.extendPrototype("complex","artanh",function(){return f.times(.5,f.minus(f.ln(f.plus(1,this)),f.ln(f.minus(1,this))))}),f.extendPrototype("complex","compare",function(a){var b=f.sgn(this.abs()-a.abs());return b?b:f.sgn(this.argument()-a.argument())}),f.extendPrototype("complex","conjugate",function(){return f.complex([this.re,f.negative(this.im)])}),f.extendPrototype("complex","copy",function(){return f.complex([f.copy(this.re),f.copy(this.im)])}),f.extendPrototype("complex","cos",function(){return f.complex([f.cos(this.re)*f.cosh(this.im),-f.sin(this.re)*f.sinh(this.im)])}),f.extendPrototype("complex","cosh",function(){return f.complex([f.cos(this.im)*f.cosh(this.re),f.sin(this.im)*f.sinh(this.re)])}),f.extendPrototype("complex","divide",function(a){return this.times(f.inverse(a))}),f.extendPrototype("complex","exp",function(){return f.complex([f.exp(this.re)*f.cos(this.im),f.exp(this.re)*f.sin(this.im)])}),f.extendPrototype("complex","inverse",function(){return f.complex([f.divide(this.re,f.plus(f.pow(this.re,2),f.pow(this.im,2))),f.divide(f.negative(this.im),f.plus(f.pow(this.re,2),f.pow(this.im,2)))])}),f.extendPrototype("complex","isEqual",function(a){return typeof a=="number"?f.isEqual(this.re,a)&&f.isZero(this.im):a.type==="complex"?f.isEqual(this.re,a.re)&&f.isEqual(this.im,a.im):!1}),f.extendPrototype("complex","isFinite",function(){return f.isFinite(this.re)&&f.isFinite(this.im)}),f.extendPrototype("complex","isOne",function(){return f.isOne(this.re)&&f.isZero(this.im)}),f.extendPrototype("complex","isReal",function(){return f.isZero(this.im)}),f.extendPrototype("complex","isZero",function(){return f.isZero(this.re)&&f.isZero(this.im)}),f.extendPrototype("complex","ln"
,function(){return f.complex([f.ln(this.abs()),this.argument()])}),f.extendPrototype("complex","minus",function(a){return this.plus(f.negative(a))}),f.extendPrototype("complex","mod",function(a){return f.complex([f.mod(this.re,a),f.mod(this.im,a)])}),f.extendPrototype("complex","negative",function(){return f.complex([f.negative(this.re),f.negative(this.im)])}),f.extendPrototype("complex","plus",function(a){if(a.type==="complex")return f.complex([f.plus(this.re,a.re),f.plus(this.im,a.im)]);if(typeof a=="number")return f.complex([f.plus(this.re,a),this.im])}),f.extendPrototype("complex","pow",function(a){return f.complex(Math.pow(this.abs(),a),a*this.argument())}),f.extendPrototype("complex","sin",function(){return f.complex([f.sin(this.re)*f.cosh(this.im),f.cos(this.re)*f.sinh(this.im)])}),f.extendPrototype("complex","sinh",function(){return f.complex([f.cos(this.im)*f.sinh(this.re),f.sin(this.im)*f.cosh(this.re)])}),f.extendPrototype("complex","sgn",function(){return f.complex(1,this.argument())}),f.extendPrototype("complex","times",function(a){if(a.type==="complex")return f.complex([f.minus(f.times(this.re,a.re),f.times(this.im,a.im)),f.plus(f.times(this.re,a.im),f.times(this.im,a.re))]);if(typeof a=="number")return f.complex([f.times(this.re,a),f.times(this.im,a)])}),f.extendPrototype("complex","toContentMathML",function(){return'<cn type="complex-cartesian">'+this.re+"<sep/>"+this.im+"</cn>"}),f.extendPrototype("complex","toLaTeX",function(){var a="",b=!1;return f.isZero(this.re)||(a=f.toLaTeX(this.re),b=!0),f.isZero(this.im)||(a+=f.toLaTeX(this.im,b)+"i"),a.length===0&&(a="0"),a}),f.extendPrototype("complex","toMathML",function(){var a="",b=!1;return f.isZero(this.re)||(a=f.toMathML(this.re),b=!0),f.isZero(this.im)||(a+=f.toMathML(this.im,b)+"<mo>&#x2062;</mo><mi>i</mi>"),a.length===0&&(a="<mn>0</mn>"),a}),f.extendPrototype("complex","toMatrix",function(){return f.matrix([[this.re,f.negative(this.im)],[this.im,this.re]])}),f.extendPrototype("complex","toPoint",function(){return f.point(this.z.concat(1))}),f.extendPrototype("complex","toString",function(){var a="";return f.isZero(this.re)||(a=f.toString(this.re)),f.isZero(this.im)||(a+=(this.im>0?a.length?"+":"":"-")+f.toString(Math.abs(this.im))+"i"),a.length===0&&(a="0"),a}),f.extend("complex","one",f.complex([1,0])),f.extend("complex","zero",f.complex([0,0])),h.line=f.vector([]),f.line=function(a){return a[g]=h.line,Object.defineProperties(a,{dim:{value:a.length-1}}),a},f.extendPrototype("line","constructor",f.line),f.extendPrototype("line","type","line"),f.extendPrototype("line","draw",function(a,b){if(Array.isArray(a)){var c=this;a.forEach(function(a){a.line(c,b)})}else a.line(this,b);return this}),f.extendPrototype("line","isEqual",function(a){var b=this.normalize();return a=a.normalize(),this.dim!==a.dim?!1:b.every(function(b,c){return f.isEqual(b,a[c])})}),f.extendPrototype("line","isFinite",function(a){return!f.isZero(this[this.length-1])}),f.extendPrototype("line","isOrthogonalTo",function(a){return f.isEqual(f.point([0,0,1]).crossRatio(this.meet(f.line.infinteLine),a.meet(f.line.infinteLine),f.point.I,f.point.J),-1)}),f.extendPrototype("line","isParallelTo",function(a){return this.every(function(b,c){return f.isEqual(b,a[c])||c===a.length-1})}),f.extendPrototype("line","meet",function(a){return f.point([this[1]*a[2]-this[2]*a[1],a[0]*this[2]-this[0]*a[2],this[0]*a[1]-this[1]*a[0]])}),f.extendPrototype("line","normalize",function(a){var b=this[this.dim];return this.map(function(a){return a/b})}),f.extend("line","infiniteLine",f.line([0,0,1])),h.MathML={},f.MathML=function(a){var b=new DOMParser,c;return a=a.replace(/\n/g,""),a=a.replace(/>\s*<(\w)/g,"><$1"),a=a.replace(/<\/(\w+)>\s*<\/(\w)/g,"</$1></$2"),c=b.parseFromString(a,"application/xml"),c[g]=h.MathML,Object.defineProperties(c,{constructor:{value:f.MathML}}),c},f.extendPrototype("MathML","type","MathML"),f.extendPrototype("MathML","parse",function(b){var c,d,e,g,h,i,j,k;return c=function(b){return a.createTreeWalker(b,NodeFilter.SHOW_ELEMENT,{acceptNode:function(a){return NodeFilter.FILTER_ACCEPT}},!1)},i=function(a){var b=c(a);do{var e=b.currentNode,f=e.nodeName;if(f==="cn")return h(e);if(f==="apply")return d(e);if(f==="cs")return e.textContent;if(f==="matrix")return g(e);if(f==="set")return j(e);if(f==="vector")return k(e);if(f==="#document")return e.childNodes.length===1?i(e.childNodes[0]):Array.prototype.slice.call(e.childNodes).map(i)}while(b.nextNode()!==null)},d=function(a){var b=Array.prototype.slice.call(a.childNodes),c=b.shift().nodeName,d={power:"pow",rem:"mod",union:"or",intersection:"and",setdifference:"without"};c in d&&(c=d[c]);if(c in f)return b.length===1?f[c](i(b[0])):f[c](b.map(i));var e=i(b.shift());return b.length===1?e[c](i(b[0])):e[c](b.map(i))},g=function(a){return f.matrix(Array.prototype.slice.call(a.childNodes).map(e))},e=function(a){return Array.prototype.slice.call(a.childNodes).map(i)},h=function(a){var b=a.getAttribute("type")!==null?a.getAttribute("type"):"number";if(b==="number")return+a.textContent;if(b==="complex-cartesian")return f.complex([+a.childNodes[0].textContent,+a.childNodes[2].textContent]);if(b==="complex-polar")return f.complex(+a.childNodes[0].textContent,+a.childNodes[2].textContent)},j=function(a){var b=a.getAttribute("type")!==null&&a.getAttribute("type")==="multiset"?!0:!1;return f.set(Array.prototype.slice.call(a.childNodes).map(i),b)},k=function(a){return f.vector(Array.prototype.slice.apply(a.childNodes).map(i))},i(this)}),f.extend("MathML","isSupported",function(){var b=!1,c,d,e;return a.createElementNS&&(c="http://www.w3.org/1998/Math/MathML",d=a.createElement("div"),d.style.position="absolute",e=d.appendChild(a.createElementNS(c,"math")).appendChild(a.createElementNS(c,"mfrac")),e.appendChild(a.createElementNS(c,"mi")).appendChild(a.createTextNode("xx")),e.appendChild(a.createElementNS(c,"mi")).appendChild(a.createTextNode("yy")),a.body.appendChild(d),b=d.offsetHeight>d.offsetWidth,a.body.removeChild(d)),b}),f.extend("MathML","loadMathJax",function(b){var c=a.createElement("script");c.type="text/javascript",c.src="http://cdn.mathjax.org/mathjax/latest/MathJax.js",b=b||'MathJax.Hub.Config({config: ["MMLorHTML.js"],jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML"],extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js"],TeX: {extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]}});',window.opera?c.innerHTML=b:c.text=b,a.getElementsByTagName("head")[0].appendChild(c)}),f.extend("MathML","write",function(b,c){var d;a.getElementById(b).innerHTML="<math>"+c+"</math>",typeof MathJax!="undefined"&&(d=MathJax.Hub.getAllJax(b)[0],MathJax.Hub.Queue(["Typeset",MathJax.Hub,b]))}),h.matrix=[],f.matrix=function(a){if(typeof a=="string"){if(a.indexOf("<")>-1)return f.MathML(a).parse();a=a.trim().replace(/;?\n/g,"],["),a=JSON.parse("[["+a+"]]")}return a[g]=h.matrix,Object.defineProperties(a,{cols:{value:a[0].length},rows:{value:a.length}}),a},f.extendPrototype("matrix","constructor",f.matrix),f.extendPrototype("matrix","type","matrix"),f.extendPrototype("matrix","adjugate",function(a){return this.map(function(a,b,c,d){return f.times(d.remove(c,b).determinant(),1-(b+c)%2*2)})}),f.extendPrototype("matrix","adjoint",function(a){return this.map(f.conjugate).transpose()}),f.extendPrototype("matrix","cholesky",function(){var a,b,c=[],d,e,g,h;for(a=0,b=this.rows;a<b;a++)c.push([]);for(a=0,b=this.rows;a<b;a++){for(h=0;h<a;h++){g=0;for(d=0,e=h;d<e;d++)g=f.plus(g,f.times(c[a][d],c[h][d]));c[a][h]=(this[a][h]-g)/c[h][h]}g=0;for(d=0,e=h;d<e;d++)g=f.plus(g,f.times(c[a][d],c[a][d]));c[a][h]=Math.sqrt(this[h][h]-g);for(h++;h<this.cols;h++)c[a][h]=0}return c=f.matrix(c),this.cholesky=function(){return c},c}),f.extendPrototype("matrix","determinant",function(){if(this.isSquare()){var a,b;return this.rank()<this.rows?b=0:(a=this.LU(),b=f.times(this.LUpermutation.sgn(),f.times(a.diag()))),this.determinant=function(){return b},b}}),f.extendPrototype("matrix","diag",function(){var a=[],b,c;for(b=0,c=Math.min(this.rows,this.cols);b<c;b++)a.push(this[b][b]);return a}),f.extendPrototype("matrix","divide",function(a){return this.multiply(f.inverse(a))}),f.extendPrototype("matrix","every",function(a){return Array.prototype.every.call(this,function(b,c){return Array.prototype.every.call(b,function(b,d){return a(b,c,d,this)})})}),f.extendPrototype("matrix","forEach",function(a){Array.prototype.forEach.call(this,function(b,c){return Array.prototype.forEach.call(b,function(b,d){return a(b,c,d,this)})})}),f.extendPrototype("matrix","inverse",function(){if(!this.isSquare()&&this.determinant())return;return this.adjugate().divide(this.determinant())}),f.extendPrototype("matrix","isDiag",function(){var a,b,c,d;if((this.hasOwnProperty("isUpper")&&this.isUpper())+ +(this.hasOwnProperty("isLower")&&this.isLower())+ +(this.hasOwnProperty("isLower")&&this.isLower())>1)return!0;for(a=0,c=this.rows;a<c;a++)for(b=0,d=this.cols;b<d;b++)if(a!==b&&this[a][b]!==0)return!1;return!0}),f.extendPrototype("matrix","isEqual",function(a){var b,c,d,e;if(this===a)return!0;if(this.rows===a.rows&&this.cols===a.cols){for(b=0,d=this.rows;b<d;b++)for(c=0,e=this.cols;c<e;c++)if(!f.isEqual(this[b][c],a[b][c]))return!1;return!0}return!1}),f.extendPrototype("matrix","isIdentity",function(){if(!this.isSquare())return!1;var a=this.every(function(a,b,c){return b===c?f.isOne(a):f.isZero(a)});return this.isIdentity=function(){return a},a}),f.extendPrototype("matrix","isInvertible",function(){return this.isSquare()&&this.rank()===this.rows}),f.extendPrototype("matrix","isLower",function(){return this.slice(0,-1).every(function(a,b){return a.slice(b+1).every(f.isZero)})}),f.extendPrototype("matrix","isNegDefinite",function(){if(!this.isSquare())return;return this.rows===1?this[0][0]<0:this.rows%2===0?this.determinant()>0&&this.remove(this.rows-1,this.cols-1).isNegDefinite():this.determinant()<0&&this.remove(this.rows-1,this.cols-1).isNegDefinite()}),f.extendPrototype("matrix","isOrthogonal",function(){return this.transpose().times(this).isIdentity()}),f.extendPrototype("matrix","isPermutation",function(){var a=[],b=[];return this.every(function(c,d,e){return f.isOne(c)?a[d]||b[e]?!1:(a[d]=!0,b[e]=!0,!0):f.isZero(c)?!0:!1})&&a.length===this.rows&&b.length===this.cols}),f.extendPrototype("matrix","isPosDefinite",function(){if(!this.isSquare())return;return this.rows===1?this[0][0]>0:this.determinant()>0&&this.remove(this.rows-1,this.cols-1).isPosDefinite()}),f.extendPrototype("matrix","isReal",function(){return this.every(f.isReal)}),f.extendPrototype("matrix","isScalar",function(){var a=this.rows,b=this.diag,c;if(this.hasOwnProperty("isIdentity")&&this.hasOwnProperty("isZero"))return this.isIdentity()||this.isZero()?!0:!1;if(this.isDiag()){for(c=1;c<a;c++)if(!f.isEqual(b[0],b[c]))return!1;return!0}return!1}),f.extendPrototype("matrix","isSquare",function(){return this.cols===this.rows}),f.extendPrototype("matrix","isSymmetric",function(){var a,b,c=!0;if(!this.isSquare())c=!1;else a:for(a=0;a<this.rows;a++)for(b=a+1;b<this.cols;b++)if(!f.isEqual(this[a][b],this[b][a])){c=!1;break a}return this.isSymmetric=function(){return c},c}),f.extendPrototype("matrix","isUpper",function(){return this.slice(1).every(function(a,b){return a.slice(0,b+1).every(f.isZero)})}),f.extendPrototype("matrix","isVector",function(){return this.rows===1||this.cols===1}),f.extendPrototype("matrix","isZero",function(){var a=this.every(f.isZero);return this.isZero=function(){return a},a}),f.extendPrototype("matrix","LU",function(a){var b,c,d,e,g,h=this.toArray(),i=this.rows,j=this.cols,k=[];for(d=0;d<j;d++){if(!a){g=d;for(b=d+1;b<i;b++)Math.abs(h[b][d])>Math.abs(h[g][d])&&(g=b);g!==d&&(k.unshift([g,d]),e=h[g],h[g]=h[d],h[d]=e)}if(h[d][d]!==0)for(b=d+1;b<i;b++){h[b][d]=f.divide(h[b][d],h[d][d]);for(c=d+1;c<j;c++)h[b][c]=f.minus(h[b][c],f.times(h[b][d],h[d][c]))}}return h=f.matrix(h),this.LU=function(){return h},this.LUpermutation=f.permutation(k),h}),f.extendPrototype("matrix","map",function(a){var b=this;return f.matrix(Array.prototype.map.call(this,function(c,d){return Array.prototype.map.call(c,function(c,e){return a(c,d,e,b)})}))}),f.extendPrototype("matrix","minor",function(a,b){return this.remove(a,b).determinant()}),f.extendPrototype("matrix","minus",function(a){return this.plus(a.negative())}),f.extendPrototype("matrix","negative",function(){var a=[],b,c;for(b=0,c=this.rows;b<c;b++)a.push(this[b].map(f.negative));return f.matrix(a)}),f.extendPrototype("matrix","plus",function(a){var b=[],c=this.rows,d=this.cols,e,g;for(e=0;e<c;e++){b[e]=[];for(g=0;g<d;g++)b[e][g]=f.plus(this[e][g],a[e][g])}return f.matrix(b)}),f.extendPrototype("matrix","rank",function(){var a=0,b,c,d,e;b=this.rref();a:for(c=Math.min(this.rows,this.cols)-1;c>=0;c--)for(e=this.cols-1;e>=c;e--)if(!f.isZero(b[c][e])){a=c+1;break a}return this.rank=function(){return a},a}),f.extendPrototype("matrix","remove",function(a,b){var c=this.toArray();if(a||a===0)typeof a=="number"&&(a=[a]),c=c.filter(function(b,c,d){return a.indexOf(c)===-1});if(b||b===0)typeof b=="number"&&(b=[b]),b=b.sort().reverse(),b.forEach(function(a){c=c.map(function(b){return b.splice(a,1),b})});return f.matrix(c)}),f.extendPrototype("matrix","rref",function(){var a=0,b=this.toArray(),c,d,e,g,h;for(e=0;e<this.rows;e++){if(this.cols<=a)return f.matrix(b);c=e;while(b[c][a]===0){c++;if(this.rows===c){c=e,a++;if(this.cols===a)return f.matrix(b)}}var i=b[c];b[c]=b[e],b[e]=i,h=b[e][a];for(d=0;d<this.cols;d++)b[e][d]/=h;for(c=0;c<this.rows;c++){if(c===e)continue;h=b[c][a];for(d=0;d<this.cols;d++)b[c][d]=f.minus(b[c][d],f.times(h,b[e][d]))}a++}return f.matrix(b)}),f.extendPrototype("matrix","solve",function(a){var b=this.LU(),c,d,e=a.length,g=[],h=[];a=this.LUpermutation.applyTo(a);for(c=0;c<e;c++){h[c]=a[c];for(d=0;d<c;d++)h[c]=f.minus(h[c],f.times(b[c][d],h[d]))}for(c=e-1;c>=0;c--){g[c]=h[c];for(d=c+1;d<e;d++)g[c]=f.minus(g[c],f.times(b[c][d],g[d]));g[c]=f.divide(g[c],b[c][c])}return a.constructor(g)}),f.extendPrototype("matrix","some",function(a){return Array.prototype.some.call(this,function(b,c){return Array.prototype.some.call(b,function(b,d){return a(b,c,d,this)})})}),f.extendPrototype("matrix","times",function(a){var b=[],c,d,e,g;if(typeof a=="number"||a.type==="complex")return this.map(function(b){return f.times(b,a)});if(a.type==="matrix"){if(this.cols===a.rows){for(d=0;d<this.rows;d++){b[d]=[];for(e=0;e<a.cols;e++){c=0;for(g=0;g<this.cols;g++)c=f.plus(c,f.times(this[d][g],a[g][e]));b[d][e]=c}}return f.matrix(b)}}else if(a.type==="point"||a.type==="vector")if(this.cols===a.length){for(e=0;e<this.rows;e++){c=0;for(g=0;g<this.cols;g++)c=f.plus(c,f.times(this[e][g],a[g]));b.push(c)}return a.constructor(b)}}),f.extendPrototype("matrix","toArray",function(){return Array.prototype.map.call(this,function(a){return Array.prototype.map.call(a,function(a){return f.copy(a)})})}),f.extendPrototype("matrix","toColVectors",function(){return this.transpose().toRowVectors()}),f.extendPrototype("matrix","toComplex",function(){if(this.rows!==2||this.cols!==2||this[0][0]!==this[1][1]||this[0][1]!==f.negative(this[1][0]))return;return f.complex([this[0][0],this[1][0]])}),f.extendPrototype("matrix","toContentMathML",function(){return this.reduce(function(a,b){return a+b.reduce(function(a,b){return a+f.toContentMathML(b)},"<matrixrow>")+"</matrixrow>"},"<matrix>")+"</matrix>"}),f.extendPrototype("matrix","toLaTeX",function(){return"\\begin{pmatrix}\n"+this.reduce(function(a,b){return a+b.reduce(function(a,b){return a+" & "+f.toLaTeX(b)})+"\\\n"},"").slice(0,-2)+"\n\\end{pmatrix}"}),f.extendPrototype("matrix","toMathML",function(){return this.reduce(function(a,b){return a+b.reduce(function(a,b){return a+"<mtd>"+f.toMathML(b)+"</mtd>"},"<mtr>")+"</mtr>"},"<mrow><mo> ( </mo><mtable>")+"</mtable><mo> ) </mo></mrow>"}),f.extendPrototype("matrix","toRowVectors",function(){return this.toArray().map(f.vector)}),f.extendPrototype("matrix","toString",function(){return this.reduce(function(a,b){return a+b.reduce(function(a,b){return a+"\t"+f.toString(b)})+"\n"},"").slice(0,-1)}),f.extendPrototype("matrix","trace",function(){var a=f.plus(this.diag());return this.trace=function(){return a},a}),f.extendPrototype("matrix","transpose",function(){var a=[],b,c,d,e,g;for(c=0,e=this.cols;c<e;c++){b=[];for(d=0,g=this.rows;d<g;d++)b.push(this[d][c]);a.push(b)}return a=f.matrix(a),this.transpose=function(){return a},a}),f.extend("matrix","identity",function(a){var b=[],c=[],d,e;a=a||1;for(d=0,e=a-1;d<e;d++)b.push(0);b.push(1),b=b.concat(b),b=b.slice(0,-1);for(d=0,e=a;d<e;d++)c.push(b.slice(a-d-1,2*a-d-1));return f.matrix(c)}),f.extend("matrix","givensMatrix",function(a,b,c,d){var e=f.matrix.identity(a);return e[c][c]=e[b][b]=Math.cos(d),e[b][c]=Math.sin(d),e[c][b]=-e[b][c],e}),f.extend("matrix","numbers",function(a,b,c){var d=[],e=[],g,h;for(g=0,h=c||b||1;g<h;g++)d.push(a);for(g=0,h=b||1;g<h;g++)e.push(d.slice());return f.matrix(e)}),f.extend("matrix","one",function(a,b){return a=a||1,b=b||1,f.matrix.numbers(1,a,b)}),f.extend("matrix","random",function(a,b){var c,d=[],e,g,h,i;for(e=0,h=a||1;e<h;e++){c=[];for(g=0,i=b||a||1;g<i;g++)c.push(Math.random());d.push(c)}return f.matrix(d)}),f.extend("matrix","zero",function(a,b){return a=a||1,b=b||1,f.matrix.numbers(0,a,b)}),h.permutation=[],f.permutation=function(a){var b,c,d;return Array.isArray(a[0])?(b=a,c=f.permutation.cycleToList(b)):(c=a,b=f.permutation.listToCycle(c)),c[g]=h.permutation,Object.defineProperties(c,{cycle:{value:b},max:{value:c.length-1}}),c},f.extendPrototype("permutation","constructor",f.permutation),f.extendPrototype("permutation","type","permutation"),f.extendPrototype("permutation","applyTo",function(a){var b,c;return typeof a=="number"?a<this.length?this[a]:a:(b=this,c=a.map(function(c,d){return a[b.applyTo(d)]}),a.type===undefined?c:a.constructor(c))}),f.extendPrototype("permutation","inverse",function(){var a=this.cycle.slice();return a.reverse().forEach(function(a){a.reverse()}),f.permutation(a)}),f.extendPrototype("permutation","map",function(a){return this.constructor(Array.prototype.map.call(this,a))}),f.extendPrototype("permutation","sgn",function(){var a=0,b;for(b=0;b<this.cycle.length;b++)a+=this.cycle[b].length;return a+=this.cycle.length,-2*(a%2)+1}),f.extendPrototype("permutation","times",function(a){var b=this;return a.map(function(a){return b[a]})}),f.extendPrototype("permutation","toMatrix",function(a){var b=[],c=[],d,e,g;a=a||this.length;for(e=0,g=a-1;e<g;e++)b.push(0);b=b.concat([1]).concat(b);for(e=0,g=a;e<g;e++)d=a-this.applyTo(e)-1,c.push(b.slice(d,d+a));return f.matrix(c)}),f.extendPrototype("permutation","toString",function(){var a="";return this.cycle.forEach(function(b){a+="("+(b+"")+")"}),a}),f.extend("permutation","cycleToList",function(a){var b,c=[],d,e,f,g,h;h=a.map(function(a){return Math.max.apply(null,a)}),h=Math.max.apply(null,h);for(d=0,e=h;d<=e;d++){r=d;for(f=0,g=a.length;f<g;f++)b=a[f].indexOf(r),++b&&(r=a[f][b%a[f].length]);c.push(r)}return c}),f.extend("permutation","id",f.permutation([[]])),f.extend("permutation","listToCycle",function(a){var b=[],c,d,e,f,g=[];for(d=0,e=a.length;d<e;d++){c=d,f=[];while(!b[c])b[c]=!0,f.push(c),c=a[c];f.length&&g.push(f)}return g}),h.point=f.vector([]),f.point=function(a){return arguments.length>1&&(a=Array.prototype.slice.call(arguments).concat(1)),a[g]=h.point,Object.defineProperties(a,{dim:{value:a.length-1}}),a},f.extendPrototype("point","constructor",f.point),f.extendPrototype("point","type","point"),f.extendPrototype("point","crossRatio",function(a,b,c,d){var e=this.toArray(),g=f.matrix([e,a,c]),h=f.matrix([e,b,d]),i=f.matrix([e,a,d]),j=f.matrix([e,b,c]);return g.det()*h.det()/(i.det()*j.det())}),f.extendPrototype("point","distanceTo",function(a){var b=0,c;if(arguments.length===0){for(c=0;c<this.dim;c++)b+=Math.pow(this[c],2);return Math.sqrt(b)}if(a.type==="point"&&this.dim===a.dim)for(c=0;c<this.dim;c++)b+=Math.pow(this[c]-a[c],2);return Math.sqrt(b)}),f.extendPrototype("point","draw",function(a,b){if(Array.isArray(a)){var c=this;a.forEach(function(a){a.point(c,b)})}else a.point(this,b);return this}),f.extendPrototype("point","isEqual",function(a){var b=this.normalize();return a=a.normalize(),this.dim!==a.dim?!1:b.every(function(b,c){return f.isEqual(b,a[c])})}),f.extendPrototype("point","isFinite",function(a){return!f.isZero(this[this.length-1])}),f.extendPrototype("point","isInside",function(a){if(a.type==="circle")return this.distanceTo(a.center)<a.radius}),f.extendPrototype("point","isOn",function(a){if(a.type==="line")return this.distanceTo(a.center)===a.radius;if(a.type==="circle")return this.distanceTo(a.center)===a.radius}),f.extendPrototype("point","isOutside",function(a){if(a.type==="circle")return this.distanceTo(a.center)>a.radius}),f.extendPrototype("point","lineTo",function(a){if(this.dim===2&&a.dim===2)return f.line(this,a)}),f.extendPrototype("point","normalize",function(a){var b=this[this.dim];return this.map(function(a){return a/b})}),f.extendPrototype("point","reflectAt",function(a){if(a.type==="point"&&this.dim===a.dim){var b=[],c,d=this.normalize();a=a.normalize();for(c=0;c<this.dim;c++)b.push(2*a[c]-d[c]);return b.push(1),f.point(b)}}),f.extendPrototype("point","toArray",function(){var a=[],b,c;for(b=0,c=this.dim;b<=c;b++)a.push(this[b]);return a}),f.extendPrototype("point","toComplex",function(){if(this.dim===2)return f.complex(this[0]/this[2],this[1]/this[2])}),f.extendPrototype("point","toLaTeX",function(a){var b=a?this:this.normalize().slice(0,-1);return"\\begin{pmatrix}\n\t"+b.reduce(function(a,b){return a+"\\\\\n\t"+f.toLaTeX(b)})+"\n\\end{pmatrix}"}),f.extendPrototype("point","toMathML",function(a){var b=a?this:this.normalize().slice(0,-1);return b.reduce(function(a,b){return a+"<mtr><mtd>"+f.toMathML(b)+"</mtd></mtr>"},"<mrow><mo>(</mo><mtable>")+"</mtable><mo>)</mo></mrow>"}),f.extendPrototype("point","toString",function(a){var b=a?this:this.normalize().slice(0,-1);return"("+b.reduce(function(a,b){return a+", "+f.toString(b)})+")"}),f.extend("point","I",function(){var a=f.complex(0,-1);return f.point([a,0,1])}()),f.extend("point","J",function(){var a=f.complex(0,1);return f.point([a,0,1])}()),h.polynomial=[],f.polynomial=function(a){var b=[];if(a===undefined||a.length===0)a=[0];else if(typeof a=="number"){while(a--)b.push(0);b.push(1),a=b}return a[g]=h.polynomial,Object.defineProperties(a,{deg:{value:a.length-1},subdeg:{value:function(a){var b=0;if(a.length>1||a[0]){while(b<a.length&&f.isZero(a[b]))b++;return b}return Infinity}(a)}}),a},f.extendPrototype("polynomial","constructor",f.polynomial),f.extendPrototype("polynomial","type","polynomial"),f.extendPrototype("polynomial","content",function(){return f.gcd(this)}),f.extendPrototype("polynomial","differentiate",function(a){if(a===0)return this;if(a<0)return this.integrate(-a);var b=[],c;a=a||1;for(c=0;c<=this.deg-a;c++)b[c]=f.times(this[c+a],f.fallingFactorial(c+a,a));return f.polynomial(b)}),f.extendPrototype("polynomial","draw",function(a,b){var c=[],d;if(this.deg<2)a.line([[-50,this.valueAt(-50)],[50,this.valueAt(50)]],b);else{for(d=-50;d<=50;d=Math.round((d+.01)*100)/100)c.push([d,Math.round(this.valueAt(d)*100)/100]);a.path(c,b)}return this}),f.extendPrototype("polynomial","integrate",function(a){var b=[],c;a=a||1;if(f.isZero(a))return this;if(a<0)return this.differentiate(-a);for(c=0;c<a;c++)b.push(0);for(c=0;c<=this.deg;c++)b[c+a]=this[c]/f.fallingFactorial(c+a,a);return f.polynomial(b)}),f.extendPrototype("polynomial","isEqual",function(a){var b,c;if(this.deg!==a.deg||this.subdeg!==a.subdeg)return!1;for(b=0,c=this.deg;b<=c;b++)if(!f.isEqual(this[b],a[b]))return!1;return!0}),f.extendPrototype("polynomial","isPrimitive",function(){return f.gcd(this)===1}),f.extendPrototype("polynomial","isReal",function(){return this.every(f.isReal)}),f.extendPrototype("polynomial","map",function(a){return f.polynomial(Array.prototype.map.call(this,a))}),f.extendPrototype("polynomial","mod",function(a){return this.map(function(b){return f.mod(b,a)})}),f.extendPrototype("polynomial","negative",function(){return f.polynomial(this.map(f.negative))}),f.extendPrototype("polynomial","plus",function(a,b){var c=[],d;if(typeof a=="number"){if(b)return this.map(function(b){return f.plus(a,b)});c=this.slice(),c[0]=f.plus(c[0],a)}else if(a.type==="polynomial"){for(d=0;d<=Math.min(this.deg,a.deg);d++)c[d]=f.plus(this[d],a[d]);c=c.concat((this.deg>a.deg?this:a).slice(d))}return f.polynomial(c)}),f.extendPrototype("polynomial","tangent",function(a){var b=this.valueat(a),c=this.differentiate().valueAt(a);return f.polynomial([b-c*a,c])}),f.extendPrototype("polynomial","times",function(a){var b=[],c,d;if(a.type==="polynomial")for(c=0;c<=this.deg;c++)for(d=0;d<=a.deg;d++)b[c+d]=f.plus(b[c+d]?b[c+d]:0,f.times(this[c],a[d]));else b=this.map(function(b){return f.times(a,b)});return f.polynomial(b)}),f.extendPrototype("polynomial","toContentMathML",function(){var a="<apply><plus/>",b,c;for(b=0,c=this.deg;b<=c;b++)f.isZero(this[b])||(b===0?a+=f.toContentMathML(this[b]):a+="<apply><times/>"+f.toContentMathML(this[b],!0),b>1?a+="<apply><power/><ci>x</ci>"+f.toContentMathML(b)+"</apply></apply>":b===1&&(a+="<ci>x</ci></apply>"));return a+"</apply>"}),f.extendPrototype("polynomial","toLaTeX",function(){var a="",b,c;for(b=0,c=this.deg;b<=c;b++)f.isZero(this[b])||(b===0?a+=f.toLaTeX(this[b]):a+=f.toLaTeX(this[b],!0),b>1?a+="x^{"+f.toLaTeX(b)+"}":b===1&&(a+="x"));return a}),f.extendPrototype("polynomial","toMathML",function(){var a="<mrow>",b,c;for(b=0,c=this.deg;b<=c;b++)f.isZero(this[b])||(b===0?a+=f.toMathML(this[b]):a+=f.toMathML(this[b],!0),b>1?a+="<mo>&#x2062;</mo><msup><mi>x</mi>"+f.toMathML(b)+"</msup>":b===1&&(a+="<mo>&#x2062;</mo><mi>x</mi>"));return a+"</mrow>"}),f.extendPrototype("polynomial","toString",function(a){var b="",c,d;for(c=0,d=this.deg;c<=d;c++)f.isZero(this[c])||(c===0?b+=f.toString(this[c]):b+=f.toString(this[c],!0),c>1?b+="*x^"+f.toString(c):c===1&&(b+="*x"));return b}),f.extendPrototype("polynomial","valueAt",function(a){var b=f.is(a,"matrix")?f.matrix.identity(a.rows,a.cols):1,c=f.is(a,"matrix")?f.matrix.zero(a.rows,a.cols):0,d,e;for(d=0,e=this.deg;d<=e;d++)c=f.plus(c,f.times(this[d],b)),b=f.times(b,a);return c}),f.extend("polynomial","regression",function(a,b){var c=a.length,d=0,e=0,g=0,h=0,i,j,k;if(arguments.length===2)for(k=0;k<c;k++)d+=a[k]*b[k],e+=a[k],g+=b[k],h+=a[k]*a[k];else for(k=0;k<c;k++)d+=a[k][0]*a[k][1],e+=a[k][0],g+=a[k][1],h+=a[k][0]*a[k][0];return i=(c*d-e*g)/(c*h-e*e),j=(g*h-d*e)/(c*h-e*e),f.polynomial([j,i])}),f.extend("polynomial","interpolation",function(a,b){var c,d=f.polynomial([0]),e=a.length,g,h,i,j;arguments.length===2&&(a=a.map(function(a,c){return[a,b[c]]}));for(g=0;g<e;g++){c=f.polynomial([1]);for(h=0;h<e;h++)g!==h&&(c=c.times(f.polynomial([-a[h][0]/(a[g][0]-a[h][0]),1/(a[g][0]-a[h][0])])));d=d.plus(c.times(a[g][1]))}return d}),f.extend("polynomial","one",f.polynomial([1])),f.extend("polynomial","roots",function(a){var b,c=[],d,e;f.type(a)==="array"&&(a=f.set(a,!0)),b=a.powerset();for(d=0,e=a.card;d<e;d++)c[d]=0;return b.slice(1).forEach(function(a,b){c[e-a.card]=f.plus(c[e-a.card],a.times())}),c=c.map(function(a,b){return(e-b)%2?f.negative(a):a}),c.push(1),f.polynomial(c)}),f.extend("polynomial","zero",f.polynomial([0])),f.set=function(a,b){return a||(a=[]),a=a.sort(f.compare),b||(a=a.filter(function(a,b,c){return a!==c[b+1]})),a[g]=h.set,Object.defineProperties(a,{card:{get:function(){return this.length}},multiset:{value:!!b}}),a},f.extendPrototype("set","constructor",f.set),f.extendPrototype("set","type","set"),f.extendPrototype("set","compare",function(a){if(this.card!==a.card)return f.sgn(this.card-a.card);var b=0,c=!1;return this.forEach(function(d,e){if(!c){var g=f.compare(d,a[e]);g!==0&&(b=g,c=!0)}}),b}),f.extendPrototype("set","filter",function(a){return f.set(Array.prototype.filter.call(this,a))}),f.extendPrototype("set","insert",function(a){var b=this.locate(a);return(this[b]!==a||this.multiset)&&this.splice(b,0,a),this}),f.extendPrototype("set","isEmpty",function(){return this.card===0}),f.extendPrototype("set","isEqual",function(a){return this.card!==a.card?!1:this.every(function(b,c){return f.isEqual(b,a[c])})}),f.extendPrototype("set","isSubsetOf",function(a){return this.every(function(b){return a.indexOf(b)!==-1})}),f.extendPrototype("set","locate",function(a){var b=0,c=this.card-1,d,e=this.indexOf(a);if(e!==-1)return e;while(b<=c){d=b+Math.floor((c-b)/2);if(this[d]<a)b=d+1;else{if(this[d]<=a)return d;c=d-1}}return b}),f.extendPrototype("set","map",function(a){return f.set(Array.prototype.map.call(this,a))}),f.extendPrototype("set","plus",function(a){var b=[];return arguments.length?Array.isArray(a)?(this.forEach(function(c){a.forEach(function(a){b.push(f.plus(c,a))})}),f.set(b)):this.map(function(b){return f.plus(b,a)}):f.plus(this)}),f.extendPrototype("set","powerset",function(a){var b=[],c,d,e,g,h,i;for(e=0,g=Math.pow(2,this.card);e<g;e++){c=e.toString(2).split("").reverse(),d=[];for(h=0,i=this.card;h<i;h++)c[h]==="1"&&d.push(this[h]);b.push(f.set(d))}return f.set(b)}),f.extendPrototype("set","remove",function(a){var b=this.indexOf(a);return b!==-1&&this.splice(b,1),this}),f.extendPrototype("set","times",function(a){return arguments.length?this.map(function(b){return f.times(b,a)}):f.times(this)}),f.extendPrototype("set","toArray",function(){return this.slice()}),f.extendPrototype("set","toLaTeX",function(){return this.isEmpty()?"\\emptyset":this.reduce(function(a,b){return a+f.toLaTeX(b)+", "},"\\{").slice(0,-2)+"\\}"}),f.extendPrototype("set","toContentMathML",function(){return this.isEmpty()?"<emptyset/>":this.reduce(function(a,b){return a+f.toContentMathML(b)},"<set>")+"</set>"}),f.extendPrototype("set","toMathML",function(){return this.isEmpty()?"<mi>&#x2205;</mi>":this.reduce(function(a,b){return a+f.toMathML(b)+"<mo>,</mo>"},"<mrow><mo>{</mo>").slice(0,-10)+"<mo>}</mo></mrow>"}),f.extendPrototype("set","toMultiset",function(){return f.set(this.toArray(),!0)}),f.extendPrototype("set","toSet",function(){return f.set(this.toArray())}),f.extendPrototype("set","toString",function(){return this.isEmpty()?"":"("+this.join(", ")+")"}),function(){var a=function(a,b,c){return function(d){var e=[],g=0,h=0,i=this.card,j=d.card;while(g<i&&h<j){if(this[g]<d[h]){a&&e.push(this[g]),g++;continue}if(this[g]>d[h]){c&&e.push(d[h]),h++;continue}if(this[g]===d[h]){b&&e.push(this[g]),g++,h++;continue}}return a&&h===j?e=e.concat(this.slice(g)):c&&g===i&&(e=e.concat(d.slice(h))),f.set(e,!0)}};f.extendPrototype("set","or",a(!0,!0,!0)),f.extendPrototype("set","and",a(!1,!0,!1)),f.extendPrototype("set","without",a(!0,!1,!1)),f.extendPrototype("set","xor",a(!0,!1,!0))}(),f.extend("set","fromTo",function(a,b,c){var d,e=[];c=c||1;if(a<=b){for(d=a;d<=b;d+=c)e.push(d);return f.set(e)}}),c.MathLib=f,f.noConflict=function(){return c.MathLib=d,f}}(document);;